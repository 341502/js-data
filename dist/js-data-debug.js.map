{"version":3,"file":"js-data-debug.js","sources":["..//home/ubuntu/workspace/js-data/src/utils.js","..//home/ubuntu/workspace/js-data/src/collection/query.js","..//home/ubuntu/workspace/js-data/lib/mindex/utils.js","..//home/ubuntu/workspace/js-data/lib/mindex/index.js","..//home/ubuntu/workspace/js-data/src/collection/collection.js","..//home/ubuntu/workspace/js-data/src/validate/index.js","..//home/ubuntu/workspace/js-data/src/decorators/configure.js","..//home/ubuntu/workspace/js-data/src/decorators/schema.js","..//home/ubuntu/workspace/js-data/src/decorators/adapter.js","..//home/ubuntu/workspace/js-data/src/decorators/belongsTo.js","..//home/ubuntu/workspace/js-data/src/decorators/hasMany.js","..//home/ubuntu/workspace/js-data/src/decorators/hasOne.js","..//home/ubuntu/workspace/js-data/src/model/index.js","..//home/ubuntu/workspace/js-data/src/datastore/index.js","..//home/ubuntu/workspace/js-data/src/index.js"],"sourcesContent":["/**\n * @module utils\n * @memberof module:js-data\n */\n\n/**\n * Return whether the provided value is an array.\n * @method\n * @param {*} [value] - The value to test.\n */\nexport const isArray = Array.isArray\n/**\n * Return whether the provided value is an object type.\n * @param {*} [value] - The value to test.\n */\nexport function isObject (value) {\n  return toString.call(value) === '[object Object]' || false\n}\nfunction isPlainObject (value) {\n  return (!!value && typeof value === 'object' && value.constructor === Object)\n}\n/**\n * Return whether the provided value is a regular expression type.\n * @param {*} [value] - The value to test.\n */\nexport function isRegExp (value) {\n  return toString.call(value) === '[object RegExp]' || false\n}\n/**\n * Return whether the provided value is a string type.\n * @param {*} [value] - The value to test.\n */\nexport function isString (value) {\n  return typeof value === 'string' || (value && typeof value === 'object' && toString.call(value) === '[object String]') || false\n}\n/**\n * Return whether the provided value is a date type.\n * @param {*} [value] - The value to test.\n */\nexport function isDate (value) {\n  return (value && typeof value === 'object' && toString.call(value) === '[object Date]') || false\n}\n/**\n * Return whether the provided value is a number type.\n * @param {*} [value] - The value to test.\n */\nexport function isNumber (value) {\n  const type = typeof value\n  return type === 'number' || (value && type === 'object' && toString.call(value) === '[object Number]') || false\n}\n/**\n * Return whether the provided value is a boolean type.\n * @param {*} [value] - The value to test.\n */\nexport function isBoolean (value) {\n  return toString.call(value) === '[object Boolean]'\n}\n/**\n * Return whether the provided value is a function.\n * @param {*} [value] - The value to test.\n */\nexport function isFunction (value) {\n  return typeof value === 'function' || (value && toString.call(value) === '[object Function]') || false\n}\n/**\n * Return whether the provided value is a string or a number.\n * @param {*} [value] - The value to test.\n */\nexport function isSorN (value) {\n  return isString(value) || isNumber(value)\n}\n/**\n * Get the value at the provided key or path.\n * @param {Object} object - The object from which to retrieve a property.\n * @param {string} prop - The key or path to the property.\n */\nexport function get (object, prop) {\n  if (!prop) {\n    return\n  }\n  const parts = prop.split('.')\n  const last = parts.pop()\n\n  while (prop = parts.shift()) {\n    object = object[prop]\n    if (object == null) return\n  }\n\n  return object[last]\n}\n/**\n * Unset the value at the provided key or path.\n * @param {Object} object - The object on which to unset a property.\n * @param {string} prop - The key or path to the property.\n */\nexport function unset (object, prop) {\n  const parts = prop.split('.')\n  const last = parts.pop()\n\n  while (prop = parts.shift()) {\n    object = object[prop]\n    if (object == null) return\n  }\n\n  delete object[last]\n}\nfunction mkdirP (object, path) {\n  if (!path) {\n    return object\n  }\n  const parts = path.split('.')\n  parts.forEach(function (key) {\n    if (!object[key]) {\n      object[key] = {}\n    }\n    object = object[key]\n  })\n  return object\n}\nconst PATH = /^(.+)\\.(.+)$/\n/**\n * Set the value at the provided key or path.\n * @param {Object} object - The object on which to set a property.\n * @param {(string|Object)} path - The key or path to the property. Can also\n * pass in an object of path/value pairs, which will all be set on the target\n * object.\n * @param {*} [value] - The value to set.\n */\nexport function set (object, path, value) {\n  if (isObject(path)) {\n    forOwn(path, function (value, _path) {\n      set(object, _path, value)\n    })\n  } else {\n    const parts = PATH.exec(path)\n    if (parts) {\n      mkdirP(object, parts[1])[parts[2]] = value\n    } else {\n      object[path] = value\n    }\n  }\n}\n/**\n * Iterate over an object's own enumerable properties.\n * @param {Object} object - The object whose properties are to be enumerated.\n * @param {Function} fn - Iteration function.\n * @param {Object} [thisArg] - Content to which to bind `fn`.\n */\nexport function forOwn (obj, fn, thisArg) {\n  const keys = Object.keys(obj)\n  const len = keys.length\n  let i\n  for (i = 0; i < len; i++) {\n    fn.call(thisArg, obj[keys[i]], keys[i], obj)\n  }\n}\n/**\n * Recursively shallow copy own enumberable properties from `source` to `dest`.\n * @param {Object} dest - The destination object.\n * @param {Object} source - The source object.\n */\nexport function deepMixIn (dest, source) {\n  if (source) {\n    forOwn(source, function (value, key) {\n      const existing = this[key]\n      if (isPlainObject(value) && isPlainObject(existing)) {\n        deepMixIn(existing, value)\n      } else {\n        this[key] = value\n      }\n    }, dest)\n  }\n  return dest\n}\n/**\n * Proxy for `Promise.resolve`.\n * @param {*} [value] - Value with which to resolve the Promise.\n * @return {Promise} Promise resolved with `value`.\n */\nexport function resolve (value) {\n  return Promise.resolve(value)\n}\n/**\n * Proxy for `Promise.reject`.\n * @param {*} [value] - Value with which to reject the Promise.\n * @return {Promise} Promise reject with `value`.\n */\nexport function reject (value) {\n  return Promise.reject(value)\n}\n/**\n * Shallow copy own enumerable non-function properties from `Model` to `opts`.\n * @param {Model} Model - The source Model.\n * @param {Object} opts - The target object.\n */\nexport function _ (Model, opts) {\n  for (var key in Model) {\n    let value = Model[key]\n    if (opts[key] === undefined && !isFunction(value)) {\n      opts[key] = value\n    }\n  }\n}\n/**\n * Return the intersection of two arrays.\n * @param {Array} array1 - First array.\n * @param {Array} array2 - Second array.\n * @return {Array} Array of elements common to both arrays.\n */\nexport function intersection (array1, array2) {\n  if (!array1 || !array2) {\n    return []\n  }\n  const result = []\n  let item\n  let i\n  const len = array1.length\n  for (i = 0; i < len; i++) {\n    item = array1[i]\n    if (result.indexOf(item) !== -1) {\n      continue\n    }\n    if (array2.indexOf(item) !== -1) {\n      result.push(item)\n    }\n  }\n  return result\n}\n/**\n * Shallow copy own enumerable properties from `src` to `dest` that are on `src`\n * but are missing from `dest.\n * @param {Object} dest - The destination object.\n * @param {Object} source - The source object.\n */\nexport function fillIn (dest, src) {\n  forOwn(src, function (value, key) {\n    if (dest[key] === undefined) {\n      dest[key] = value\n    }\n  })\n}\n/**\n * Return whether `prop` is matched by any string or regular expression in `bl`.\n * @param {string} prop - The name of a property.\n * @param {Array} bl - Array of strings and regular expressions.\n * @return {boolean} Whether `prop` was matched.\n */\nexport function isBlacklisted (prop, bl) {\n  if (!bl || !bl.length) {\n    return false\n  }\n  let matches\n  for (var i = 0; i < bl.length; i++) {\n    if ((Object.prototype.toString.call(bl[i]) === '[object RegExp]' && bl[i].test(prop)) || bl[i] === prop) {\n      matches = prop\n      return matches\n    }\n  }\n  return !!matches\n}\n/**\n * Proxy for `JSON.parse`.\n * @param {string} json - JSON to parse.\n * @return {Object} Parsed object.\n */\nexport function fromJson (json) {\n  return isString(json) ? JSON.parse(json) : json\n}\n/**\n * Proxy for `JSON.stringify`.\n * @method\n * @param {*} value - Value to serialize to JSON.\n * @return {string} JSON string.\n */\nexport const toJson = JSON.stringify\n/**\n * Deep copy a value.\n * @param {*} from - Value to deep copy.\n * @return {*} Deep copy of `from`.\n */\nexport function copy (from, to, stackFrom, stackTo, blacklist) {\n  if (!to) {\n    to = from\n    if (from) {\n      if (isArray(from)) {\n        to = copy(from, [], stackFrom, stackTo, blacklist)\n      } else if (isDate(from)) {\n        to = new Date(from.getTime())\n      } else if (isRegExp(from)) {\n        to = new RegExp(from.source, from.toString().match(/[^\\/]*$/)[0])\n        to.lastIndex = from.lastIndex\n      } else if (isObject(from)) {\n        to = copy(from, Object.create(Object.getPrototypeOf(from)), stackFrom, stackTo, blacklist)\n      }\n    }\n  } else {\n    if (from === to) {\n      throw new Error('Cannot copy! Source and destination are identical.')\n    }\n\n    stackFrom = stackFrom || []\n    stackTo = stackTo || []\n\n    if (isObject(from)) {\n      let index = stackFrom.indexOf(from)\n      if (index !== -1) {\n        return stackTo[index]\n      }\n\n      stackFrom.push(from)\n      stackTo.push(to)\n    }\n\n    let result\n    if (isArray(from)) {\n      let i\n      to.length = 0\n      for (i = 0; i < from.length; i++) {\n        result = copy(from[i], null, stackFrom, stackTo, blacklist)\n        if (isObject(from[i])) {\n          stackFrom.push(from[i])\n          stackTo.push(result)\n        }\n        to.push(result)\n      }\n    } else {\n      if (isArray(to)) {\n        to.length = 0\n      } else {\n        forOwn(to, function (value, key) {\n          delete to[key]\n        })\n      }\n      for (var key in from) {\n        if (from.hasOwnProperty(key)) {\n          if (isBlacklisted(key, blacklist)) {\n            continue\n          }\n          result = copy(from[key], null, stackFrom, stackTo, blacklist)\n          if (isObject(from[key])) {\n            stackFrom.push(from[key])\n            stackTo.push(result)\n          }\n          to[key] = result\n        }\n      }\n    }\n  }\n  return to\n}\nconst SPLIT = /\\s+/\nconst NON_ALPHA = /[^A-Za-z]/g\nconst PASCAL_CASE = /(\\w)(\\w*)/g\nfunction pascalize (g0, g1, g2) {\n  return `${g1.toUpperCase()}${g2.toLowerCase()}`\n}\nfunction mapToPascal (x) {\n  return x.replace(NON_ALPHA, '').replace(PASCAL_CASE, pascalize)\n}\n/**\n * Convert a string to pascalcase.\n * @param {string} str - String to convert.\n * @return {string} Converted string.\n */\nexport function pascalCase (str) {\n  return str\n    .split(SPLIT)\n    .map(mapToPascal)\n    .join('')\n}\n/**\n * Convert a string to camelcase.\n * @param {string} str - String to convert.\n * @return {string} Converted string.\n */\nexport function camelCase (str) {\n  str = pascalCase(str)\n  if (str) {\n    return str.charAt(0).toLowerCase() + str.slice(1)\n  }\n  return str\n}\n/**\n * Add eventing capabilities into the target object.\n * @param {Object} target - Target object.\n * @param {Function} [getter] - Custom getter for retrieving the object's event\n * listeners.\n * @param {Function} [setter] - Custom setter for setting the object's event\n * listeners.\n */\nexport function eventify (target, getter, setter) {\n  target = target || this\n  let _events = {}\n  if (!getter && !setter) {\n    getter = function () {\n      return _events\n    }\n    setter = function (value) {\n      _events = value\n    }\n  }\n  Object.defineProperties(target, {\n    on: {\n      value (type, func, ctx) {\n        if (!getter.call(this)) {\n          setter.call(this, {})\n        }\n        const events = getter.call(this)\n        events[type] = events[type] || []\n        events[type].push({\n          f: func,\n          c: ctx\n        })\n      }\n    },\n    off: {\n      value (type, func) {\n        const events = getter.call(this)\n        const listeners = events[type]\n        if (!listeners) {\n          setter.call(this, {})\n        } else if (func) {\n          for (let i = 0; i < listeners.length; i++) {\n            if (listeners[i].f === func) {\n              listeners.splice(i, 1)\n              break\n            }\n          }\n        } else {\n          listeners.splice(0, listeners.length)\n        }\n      }\n    },\n    emit: {\n      value (...args) {\n        const events = getter.call(this) || {}\n        const type = args.shift()\n        let listeners = events[type] || []\n        let i\n        for (i = 0; i < listeners.length; i++) {\n          listeners[i].f.apply(listeners[i].c, args)\n        }\n        listeners = events.all || []\n        args.unshift(type)\n        for (i = 0; i < listeners.length; i++) {\n          listeners[i].f.apply(listeners[i].c, args)\n        }\n      }\n    }\n  })\n}\n\n// RiveraGroup/node-tiny-uuid\n// DO WTF YOU WANT TO PUBLIC LICENSE\nexport function uuid (a, b) {\n  for (\n    b=a=''; // b - result , a - numeric variable\n    a++<36;\n    b+=a*51&52 // if \"a\" is not 9 or 14 or 19 or 24\n    ?  //  return a random number or 4\n    (\n      a^15 // if \"a\" is not 15\n      ? // genetate a random number from 0 to 15\n      8^Math.random()*(a^20?16:4) // unless \"a\" is 20, in which case a random number from 8 to 11\n      :\n      4 //  otherwise 4\n    ).toString(16)\n    :\n    '-' //  in other cases (if \"a\" is 9,14,19,24) insert \"-\"\n  );\n  return b\n}\n","import {\n  fillIn,\n  forOwn,\n  get,\n  intersection,\n  isArray,\n  isFunction,\n  isNumber,\n  isObject,\n  isString\n} from '../utils.js'\n\n/**\n * A class used by the @{link Collection} class to build queries to be executed\n * against the collection's data. An instance of `Query` is returned by\n * {@link Model.query} and {@link Collection.query}.\n * @class Query\n * @param {Collection} collection - The collection on which this query operates.\n */\nexport function Query (collection) {\n  /**\n   * The collection on which this query operates.\n   * @type {Collection}\n   */\n  this.collection = collection\n  /**\n   * The data result of this query.\n   * @type {Array}\n   */\n  this.data = null\n}\n\nconst reserved = {\n  skip: '',\n  offset: '',\n  where: '',\n  limit: '',\n  orderBy: '',\n  sort: ''\n}\n\nfunction compare (orderBy, index, a, b) {\n  const def = orderBy[index]\n  let cA = get(a, def[0])\n  let cB = get(b, def[0])\n  if (cA && isString(cA)) {\n    cA = cA.toUpperCase()\n  }\n  if (cB && isString(cB)) {\n    cB = cB.toUpperCase()\n  }\n  if (def[1] === 'DESC') {\n    if (cB < cA) {\n      return -1\n    } else if (cB > cA) {\n      return 1\n    } else {\n      if (index < orderBy.length - 1) {\n        return compare(orderBy, index + 1, a, b)\n      } else {\n        return 0\n      }\n    }\n  } else {\n    if (cA < cB) {\n      return -1\n    } else if (cA > cB) {\n      return 1\n    } else {\n      if (index < orderBy.length - 1) {\n        return compare(orderBy, index + 1, a, b)\n      } else {\n        return 0\n      }\n    }\n  }\n}\n\nconst escapeRegExp = /([.*+?^=!:${}()|[\\]\\/\\\\])/g\nconst percentRegExp = /%/g\nconst underscoreRegExp = /_/g\n\nfunction escape (pattern) {\n  return pattern.replace(escapeRegExp, '\\\\$1')\n}\n\nfunction like (pattern, flags) {\n  return new RegExp(`^${(escape(pattern).replace(percentRegExp, '.*').replace(underscoreRegExp, '.'))}$`, flags)\n}\n\nfunction evaluate (value, op, predicate) {\n  switch (op) {\n    case '==':\n      return value == predicate // eslint-disable-line\n    case '===':\n      return value === predicate\n    case '!=':\n      return value != predicate // eslint-disable-line\n    case '!==':\n      return value !== predicate\n    case '>':\n      return value > predicate\n    case '>=':\n      return value >= predicate\n    case '<':\n      return value < predicate\n    case '<=':\n      return value <= predicate\n    case 'isectEmpty':\n      return !intersection((value || []), (predicate || [])).length\n    case 'isectNotEmpty':\n      return intersection((value || []), (predicate || [])).length\n    case 'in':\n      return predicate.indexOf(value) !== -1\n    case 'notIn':\n      return predicate.indexOf(value) === -1\n    case 'contains':\n      return value.indexOf(predicate) !== -1\n    case 'notContains':\n      return value.indexOf(predicate) === -1\n    default:\n      if (op.indexOf('like') === 0) {\n        return like(predicate, op.substr(4)).exec(value) !== null\n      } else if (op.indexOf('notLike') === 0) {\n        return like(predicate, op.substr(7)).exec(value) === null\n      }\n  }\n}\n\nfillIn(Query.prototype, {\n  /**\n   * Return the current data result of this query.\n   * @memberof Query\n   * @instance\n   * @return {Array} The data in this query.\n   */\n  getData () {\n    if (!this.data) {\n      this.data = this.collection.index.getAll()\n    }\n    return this.data\n  },\n\n  /**\n   * Find all entities between two boundaries.\n   *\n   * Get the users ages 18 to 30\n   * ```js\n   * const users = query.between(18, 30, { index: 'age' }).run()\n   * ```\n   * Same as above\n   * ```js\n   * const users = query.between([18], [30], { index: 'age' }).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {Array} leftKeys - Keys defining the left boundary.\n   * @param {Array} rightKeys - Keys defining the right boundary.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.index] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @param {boolean} [opts.leftInclusive=true] - Whether to include entities\n   * on the left boundary.\n   * @param {boolean} [opts.rightInclusive=false] - Whether to include entities\n   * on the left boundary.\n   * @param {boolean} [opts.limit] - Limit the result to a certain number.\n   * @param {boolean} [opts.offset] - The number of resulting entities to skip.\n   * @return {Query} A reference to itself for chaining.\n   */\n  between (leftKeys, rightKeys, opts) {\n    opts || (opts = {})\n    const collection = this.collection\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\n    if (this.data) {\n      throw new Error('Cannot access index after first operation!')\n    }\n    this.data = index.between(leftKeys, rightKeys, opts)\n    return this\n  },\n\n  /**\n   * Find the entity or entities that match the provided key.\n   *\n   * #### Example\n   *\n   * Get the entity whose primary key is 25\n   * ```js\n   * const entities = query.get(25).run()\n   * ```\n   * Same as above\n   * ```js\n   * const entities = query.get([25]).run()\n   * ```\n   * Get all users who are active and have the \"admin\" role\n   * ```js\n   * const activeAdmins = query.get(['active', 'admin'], {\n   *   index: 'activityAndRoles'\n   * }).run()\n   * ```\n   * Get all entities that match a certain weather condition\n   * ```js\n   * const niceDays = query.get(['sunny', 'humid', 'calm'], {\n   *   index: 'weatherConditions'\n   * }).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {Array} keyList - Key(s) defining the entity to retrieve. If\n   * `keyList` is not an array (i.e. for a single-value key), it will be\n   * wrapped in an array.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.string] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @return {Query} A reference to itself for chaining.\n   */\n  get (keyList = [], opts) {\n    opts || (opts = {})\n    if (this.data) {\n      throw new Error('Cannot access index after first operation!')\n    }\n    if (keyList && !isArray(keyList)) {\n      keyList = [keyList]\n    }\n    if (!keyList.length) {\n      this.getData()\n      return this\n    }\n    const collection = this.collection\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\n    this.data = index.get(keyList)\n    return this\n  },\n\n  /**\n   * Find the entity or entities that match the provided keyLists.\n   *\n   * #### Example\n   *\n   * Get the posts where \"status\" is \"draft\" or \"inReview\"\n   * ```js\n   * const posts = query.getAll('draft', 'inReview', { index: 'status' }).run()\n   * ```\n   * Same as above\n   * ```js\n   * const posts = query.getAll(['draft'], ['inReview'], { index: 'status' }).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {...Array} [keyList] - Provide one or more keyLists, and all\n   * entities matching each keyList will be retrieved. If no keyLists are\n   * provided, all entities will be returned.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.index] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @return {Query} A reference to itself for chaining.\n   */\n  getAll (...args) {\n    let opts = {}\n    if (this.data) {\n      throw new Error('Cannot access index after first operation!')\n    }\n    if (!args.length || args.length === 1 && isObject(args[0])) {\n      this.getData()\n      return this\n    } else if (args.length && isObject(args[args.length - 1])) {\n      opts = args[args.length - 1]\n      args.pop()\n    }\n    const collection = this.collection\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\n    this.data = []\n    args.forEach(keyList => {\n      this.data = this.data.concat(index.get(keyList))\n    })\n    return this\n  },\n\n  /**\n   * Find the entity or entities that match the provided query or pass the\n   * provided filter function.\n   *\n   * #### Example\n   *\n   * Get the draft posts created less than three months\n   * ```js\n   * const posts = query.filter({\n   *   where: {\n   *     status: {\n   *       '==': 'draft'\n   *     },\n   *     created_at_timestamp: {\n   *       '>=': (new Date().getTime() - (1000 * 60 * 60 * 24 * 30 * 3)) // 3 months ago\n   *     }\n   *   }\n   * }).run()\n   * ```\n   * Use a custom filter function\n   * ```js\n   * const posts = query.filter(function (post) {\n   *   return post.isReady()\n   * }).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {(Object|Function)} [queryOrFn={}] - Selection query or filter\n   * function.\n   * @param {Function} [thisArg] - Context to which to bind `queryOrFn` if\n   * `queryOrFn` is a function.\n   * @return {Query} A reference to itself for chaining.\n   */\n  filter (query, thisArg) {\n    query || (query = {})\n    this.getData()\n    if (isObject(query)) {\n      let where = {}\n      // Filter\n      if (isObject(query.where)) {\n        where = query.where\n      }\n      forOwn(query, function (value, key) {\n        if (!(key in reserved) && !(key in where)) {\n          where[key] = {\n            '==': value\n          }\n        }\n      })\n\n      const fields = []\n      const ops = []\n      const predicates = []\n      forOwn(where, function (clause, field) {\n        if (!isObject(clause)) {\n          clause = {\n            '==': clause\n          }\n        }\n        forOwn(clause, function (expr, op) {\n          fields.push(field)\n          ops.push(op)\n          predicates.push(expr)\n        })\n      })\n      if (fields.length) {\n        let i\n        let len = fields.length\n        this.data = this.data.filter(function (item) {\n          let first = true\n          let keep = true\n\n          for (i = 0; i < len; i++) {\n            let op = ops[i]\n            const isOr = op.charAt(0) === '|'\n            op = isOr ? op.substr(1) : op\n            const expr = evaluate(get(item, fields[i]), op, predicates[i])\n            if (expr !== undefined) {\n              keep = first ? expr : (isOr ? keep || expr : keep && expr)\n            }\n            first = false\n          }\n          return keep\n        })\n      }\n\n      // Sort\n      let orderBy = query.orderBy || query.sort\n\n      if (isString(orderBy)) {\n        orderBy = [\n          [orderBy, 'ASC']\n        ]\n      }\n      if (!isArray(orderBy)) {\n        orderBy = null\n      }\n\n      // Apply 'orderBy'\n      if (orderBy) {\n        let index = 0\n        orderBy.forEach(function (def, i) {\n          if (isString(def)) {\n            orderBy[i] = [def, 'ASC']\n          }\n        })\n        this.data.sort(function (a, b) {\n          return compare(orderBy, index, a, b)\n        })\n      }\n\n      // Skip\n      if (isNumber(query.skip)) {\n        this.skip(query.skip)\n      } else if (isNumber(query.offset)) {\n        this.skip(query.offset)\n      }\n      // Limit\n      if (isNumber(query.limit)) {\n        this.limit(query.limit)\n      }\n    } else if (isFunction(query)) {\n      this.data = this.data.filter(query, thisArg)\n    }\n    return this\n  },\n\n  /**\n   * Skip a number of results.\n   *\n   * #### Example\n   *\n   * Get all but the first 10 draft posts\n   * ```js\n   * const posts = query.get('draft', { index: 'status' }).skip(10).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {number} num - The number of entities to skip.\n   * @return {Query} A reference to itself for chaining.\n   */\n  skip (num) {\n    if (!isNumber(num)) {\n      throw new TypeError(`skip: Expected number but found ${typeof num}!`)\n    }\n    const data = this.getData()\n    if (num < data.length) {\n      this.data = data.slice(num)\n    } else {\n      this.data = []\n    }\n    return this\n  },\n\n  /**\n   * Limit the result.\n   *\n   * #### Example\n   *\n   * Get only the first 10 draft posts\n   * ```js\n   * const posts = query.get('draft', { index: 'status' }).limit(10).run()\n   * ```\n   *\n   * @memberof Query\n   * @instance\n   * @param {number} num - The maximum number of entities to keep in the result.\n   * @return {Query} A reference to itself for chaining.\n   */\n  limit (num) {\n    if (!isNumber(num)) {\n      throw new TypeError(`limit: Expected number but found ${typeof num}!`)\n    }\n    const data = this.getData()\n    this.data = data.slice(0, Math.min(data.length, num))\n    return this\n  },\n\n  /**\n   * Iterate over all entities.\n   *\n   * @memberof Query\n   * @instance\n   * @param {Function} forEachFn - Iteration function.\n   * @param {*} [thisArg] - Context to which to bind `forEachFn`.\n   * @return {Query} A reference to itself for chaining.\n   */\n  forEach (forEachFn, thisArg) {\n    this.getData().forEach(forEachFn, thisArg)\n    return this\n  },\n\n  /**\n   * Apply a mapping function to the result data.\n   *\n   * @memberof Query\n   * @instance\n   * @param {Function} mapFn - Mapping function.\n   * @param {*} [thisArg] - Context to which to bind `mapFn`.\n   * @return {Query} A reference to itself for chaining.\n   */\n  map (mapFn, thisArg) {\n    this.data = this.getData().map(mapFn, thisArg)\n    return this\n  },\n\n  /**\n   * Complete the execution of the query and return the resulting data.\n   *\n   * @memberof Query\n   * @instance\n   * @return {Array} The result of executing this query.\n   */\n  run () {\n    const data = this.data\n    this.data = null\n    return data\n  }\n})\n","export function sort (a, b, hashCode) {\n  // Short-curcuit comparison if a and b are strictly equal\n  // This is absolutely necessary for indexed objects that\n  // don't have the idAttribute field\n  if (a === b) {\n    return 0\n  }\n  if (hashCode) {\n    a = hashCode(a)\n    b = hashCode(b)\n  }\n  if (a === null && b === null) {\n    return 0\n  }\n\n  if (a === null) {\n    return -1\n  }\n\n  if (b === null) {\n    return 1\n  }\n\n  if (a < b) {\n    return -1\n  }\n\n  if (a > b) {\n    return 1\n  }\n\n  return 0\n}\n\nexport function insertAt (array, index, value) {\n  array.splice(index, 0, value)\n  return array\n}\n\nexport function removeAt (array, index) {\n  array.splice(index, 1)\n  return array\n}\n\nexport function binarySearch (array, value, field) {\n  let lo = 0\n  let hi = array.length\n  let compared\n  let mid\n\n  while (lo < hi) {\n    mid = ((lo + hi) / 2) | 0\n    compared = sort(value, array[mid], field)\n    if (compared === 0) {\n      return {\n        found: true,\n        index: mid\n      }\n    } else if (compared < 0) {\n      hi = mid\n    } else {\n      lo = mid + 1\n    }\n  }\n\n  return {\n    found: false,\n    index: hi\n  }\n}\n","// Copyright (c) 2015, InternalFX.\n\n// Permission to use, copy, modify, and/or distribute this software for any purpose with or\n// without fee is hereby granted, provided that the above copyright notice and this permission\n// notice appear in all copies.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO\n// THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT\n// SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR\n// ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION\n// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\n// USE OR PERFORMANCE OF THIS SOFTWARE.\n\n// Modifications\n// Copyright 2015 Jason Dobry\n//\n// Summary of modifications:\n// Converted to ES6 Class syntax\n// Reworked dependencies so as to re-use code already in js-data\nimport {copy, fillIn, forOwn, isArray, isFunction} from '../../src/utils'\nimport {binarySearch, insertAt, removeAt} from './utils'\n\nconst blacklist = { '>': 1, '>=': 1, '<': 1, '<=': 1 }\n\nexport function Index (fieldList, opts) {\n  fieldList || (fieldList = [])\n\n  if (!isArray(fieldList)) {\n    throw new Error('fieldList must be an array.')\n  }\n\n  opts || (opts = {})\n  this.fieldList = fieldList\n  this.fieldGetter = opts.fieldGetter\n  this.hashCode = opts.hashCode\n  this.isIndex = true\n  this.keys = []\n  this.values = []\n}\n\nfillIn(Index.prototype, {\n  set (keyList, value) {\n    if (!isArray(keyList)) {\n      keyList = [keyList]\n    }\n\n    let key = keyList.shift() || null\n    let pos = binarySearch(this.keys, key)\n\n    if (keyList.length === 0) {\n      if (pos.found) {\n        let dataLocation = binarySearch(this.values[pos.index], value, this.hashCode)\n        if (!dataLocation.found) {\n          insertAt(this.values[pos.index], dataLocation.index, value)\n        }\n      } else {\n        insertAt(this.keys, pos.index, key)\n        insertAt(this.values, pos.index, [value])\n      }\n    } else {\n      if (pos.found) {\n        this.values[pos.index].set(keyList, value)\n      } else {\n        insertAt(this.keys, pos.index, key)\n        let newIndex = new Index([], { hashCode: this.hashCode })\n        newIndex.set(keyList, value)\n        insertAt(this.values, pos.index, newIndex)\n      }\n    }\n  },\n\n  get (keyList) {\n    if (!isArray(keyList)) {\n      keyList = [keyList]\n    }\n\n    let key = keyList.shift() || null\n    let pos = binarySearch(this.keys, key)\n\n    if (keyList.length === 0) {\n      if (pos.found) {\n        if (this.values[pos.index].isIndex) {\n          return this.values[pos.index].getAll()\n        } else {\n          return this.values[pos.index]\n        }\n      } else {\n        return []\n      }\n    } else {\n      if (pos.found) {\n        return this.values[pos.index].get(keyList)\n      } else {\n        return []\n      }\n    }\n  },\n\n  getAll () {\n    let results = []\n    this.values.forEach(function (value) {\n      if (value.isIndex) {\n        results = results.concat(value.getAll())\n      } else {\n        results = results.concat(value)\n      }\n    })\n    return results\n  },\n\n  visitAll (cb, thisArg) {\n    this.values.forEach(function (value) {\n      if (value.isIndex) {\n        value.visitAll(cb, thisArg)\n      } else {\n        value.forEach(cb, thisArg)\n      }\n    })\n  },\n\n  query (query) {\n    let leftKeys\n    let rightKeys\n\n    if (query['>']) {\n      leftKeys = query['>']\n      query.leftInclusive = false\n    } else if (query['>=']) {\n      leftKeys = query['>=']\n      query.leftInclusive = true\n    }\n\n    if (query['<']) {\n      rightKeys = query['<']\n      query.rightInclusive = false\n    } else if (query['<=']) {\n      rightKeys = query['<=']\n      query.rightInclusive = true\n    }\n\n    if (leftKeys.length !== rightKeys.length) {\n      throw new Error('Key arrays must be same length')\n    }\n\n    const _opts = {}\n    forOwn(query, function (value, key) {\n      if (!blacklist[key]) {\n        _opts[key] = value\n      }\n    })\n    return this.between(leftKeys, rightKeys, _opts)\n  },\n\n  between (leftKeys, rightKeys, opts = {}) {\n    if (!isArray(leftKeys)) {\n      leftKeys = [leftKeys]\n    }\n    if (!isArray(rightKeys)) {\n      rightKeys = [rightKeys]\n    }\n    fillIn(opts, {\n      leftInclusive: true,\n      rightInclusive: false,\n      limit: undefined,\n      offset: 0\n    })\n\n    let results = this._between(leftKeys, rightKeys, opts)\n\n    if (opts.limit) {\n      return results.slice(opts.offset, opts.limit + opts.offset)\n    } else {\n      return results.slice(opts.offset)\n    }\n  },\n\n  _between (leftKeys, rightKeys, opts) {\n    let results = []\n\n    let leftKey = leftKeys.shift()\n    let rightKey = rightKeys.shift()\n\n    let pos\n\n    if (leftKey !== undefined) {\n      pos = binarySearch(this.keys, leftKey)\n    } else {\n      pos = {\n        found: false,\n        index: 0\n      }\n    }\n\n    if (leftKeys.length === 0) {\n      if (pos.found && opts.leftInclusive === false) {\n        pos.index += 1\n      }\n\n      for (let i = pos.index; i < this.keys.length; i += 1) {\n        if (rightKey !== undefined) {\n          if (opts.rightInclusive) {\n            if (this.keys[i] > rightKey) { break }\n          } else {\n            if (this.keys[i] >= rightKey) { break }\n          }\n        }\n\n        if (this.values[i].isIndex) {\n          results = results.concat(this.values[i].getAll())\n        } else {\n          results = results.concat(this.values[i])\n        }\n\n        if (opts.limit) {\n          if (results.length >= (opts.limit + opts.offset)) {\n            break\n          }\n        }\n      }\n    } else {\n      for (let i = pos.index; i < this.keys.length; i += 1) {\n        let currKey = this.keys[i]\n        if (currKey > rightKey) { break }\n\n        if (this.values[i].isIndex) {\n          if (currKey === leftKey) {\n            results = results.concat(this.values[i]._between(copy(leftKeys), rightKeys.map(function () { return undefined }), opts))\n          } else if (currKey === rightKey) {\n            results = results.concat(this.values[i]._between(leftKeys.map(function () { return undefined }), copy(rightKeys), opts))\n          } else {\n            results = results.concat(this.values[i].getAll())\n          }\n        } else {\n          results = results.concat(this.values[i])\n        }\n\n        if (opts.limit) {\n          if (results.length >= (opts.limit + opts.offset)) {\n            break\n          }\n        }\n      }\n    }\n\n    if (opts.limit) {\n      return results.slice(0, opts.limit + opts.offset)\n    } else {\n      return results\n    }\n  },\n\n  peek () {\n    if (this.values.length) {\n      if (this.values[0].isIndex) {\n        return this.values[0].peek()\n      } else {\n        return this.values[0]\n      }\n    }\n    return []\n  },\n\n  remove (keyList, value) {\n    if (!isArray(keyList)) {\n      keyList = [keyList]\n    }\n\n    let key = keyList.shift()\n    let pos = binarySearch(this.keys, key)\n\n    if (keyList.length === 0) {\n      if (pos.found) {\n        let dataLocation = binarySearch(this.values[pos.index], value, this.hashCode)\n        if (dataLocation.found) {\n          removeAt(this.values[pos.index], dataLocation.index)\n          if (this.values[pos.index].length === 0) {\n            removeAt(this.keys, pos.index)\n            removeAt(this.values, pos.index)\n          }\n        }\n      }\n    } else {\n      if (pos.found) {\n        this.values[pos.index].delete(keyList, value)\n      }\n    }\n  },\n\n  clear () {\n    this.keys = []\n    this.values = []\n  },\n\n  insertRecord (data) {\n    let keyList = this.fieldList.map(function (field) {\n      if (isFunction(field)) {\n        return field(data) || null\n      } else {\n        return data[field] || null\n      }\n    })\n\n    this.set(keyList, data)\n  },\n\n  removeRecord (data) {\n    let removed\n    this.values.forEach((value, i) => {\n      if (value.isIndex) {\n        if (value.removeRecord(data)) {\n          if (value.keys.length === 0) {\n            removeAt(this.keys, i)\n            removeAt(this.values, i)\n          }\n          removed = true\n          return false\n        }\n      } else {\n        const dataLocation = binarySearch(value, data, this.hashCode)\n        if (dataLocation.found) {\n          removeAt(value, dataLocation.index)\n          if (value.length === 0) {\n            removeAt(this.keys, i)\n            removeAt(this.values, i)\n          }\n          removed = true\n          return false\n        }\n      }\n    })\n    return removed ? data : undefined\n  },\n\n  updateRecord (data) {\n    this.removeRecord(data)\n    this.insertRecord(data)\n  }\n})\n","import {Query} from './query.js'\nimport {eventify, fillIn, forOwn, get, isArray, isFunction, isString} from '../utils.js'\nimport {Index} from '../../lib/mindex/index.js'\n\n/**\n * @class Collection\n * @param {Array} [data=[]] - Initial set of entities to insert into the\n * collection.\n * @param {string} [idAttribute='id'] - Field to use as the unique identifier\n * of each entity in the collection.\n */\nexport function Collection (data = [], idAttribute = 'id') {\n  if (!isArray(data)) {\n    throw new TypeError(`new Collection([data]): data: Expected array. Found ${typeof data}`)\n  }\n  /**\n   * Field to use as the unique identifier for each entity in this collection.\n   * @type {string}\n   */\n  this.idAttribute = idAttribute\n\n  /**\n   * The main index, which uses @{link Collection#idAttribute} as the key.\n   * @type {Index}\n   */\n  this.index = new Index([idAttribute], {\n    hashCode (obj) {\n      return get(obj, idAttribute)\n    }\n  })\n  /**\n   * Object that holds the other secondary indexes of this collection.\n   * @type {Object.<string, Index>}\n   */\n  this.indexes = {}\n  data.forEach(record => {\n    this.index.insertRecord(record)\n    if (record && isFunction(record.on)) {\n      record.on('all', this._onModelEvent, this)\n    }\n  })\n}\n\nfillIn(Collection.prototype, {\n  _onModelEvent (...args) {\n    this.emit(...args)\n  },\n\n  /**\n   * Create a new secondary index on the contents of the collection.\n   *\n   * #### Example\n   *\n   * Index users by age\n   * ```js\n   * collection.createIndex('age')\n   * ```\n   * Index users by status and role\n   * ```js\n   * collection.createIndex('statusAndRole', ['status', 'role'])\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {string} name - The name of the new secondary index.\n   * @param {string[]} [keyList] - Array of field names to use as the key or\n   * compound key of the new secondary index. If no keyList is provided, then\n   * the name will also be the field that is used to index the collection.\n   * @return {Collection} A reference to itself for chaining.\n   */\n  createIndex (name, keyList) {\n    if (isString(name) && keyList === undefined) {\n      keyList = [name]\n    }\n    const idAttribute = this.idAttribute\n    const index = this.indexes[name] = new Index(keyList, {\n      hashCode (obj) {\n        return get(obj, idAttribute)\n      }\n    })\n    this.index.visitAll(index.insertRecord, index)\n    return this\n  },\n\n  /**\n   * Create a new query to be executed against the contents of the collection.\n   * The result will be all or a subset of the contents of the collection.\n   *\n   * #### Example\n   *\n   * Grab page 2 of users between ages 18 and 30\n   * ```js\n   * collection.query()\n   *   .between(18, 30, { index: 'age' }) // between ages 18 and 30\n   *   .skip(10) // second page\n   *   .limit(10) // page size\n   *   .run()\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @return {Query} New query object.\n   */\n  query () {\n    return new Query(this)\n  },\n\n  /**\n   * Find all entities between two boundaries.\n   *\n   * Shortcut for `collection.query().between(18, 30, { index: 'age' }).run()`\n   *\n   * Get all users ages 18 to 30\n   * ```js\n   * const users = collection.between(18, 30, { index: 'age' })\n   * ```\n   * Same as above\n   * ```js\n   * const users = collection.between([18], [30], { index: 'age' })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {Array} leftKeys - Keys defining the left boundary.\n   * @param {Array} rightKeys - Keys defining the right boundary.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.index] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @param {boolean} [opts.leftInclusive=true] - Whether to include entities\n   * on the left boundary.\n   * @param {boolean} [opts.rightInclusive=false] - Whether to include entities\n   * on the left boundary.\n   * @param {boolean} [opts.limit] - Limit the result to a certain number.\n   * @param {boolean} [opts.offset] - The number of resulting entities to skip.\n   * @return {Array} The result.\n   */\n  between (leftKeys, rightKeys, opts) {\n    return this.query().between(leftKeys, rightKeys, opts).run()\n  },\n\n  /**\n   * Find the entity or entities that match the provided key.\n   *\n   * Shortcut for `collection.query().get(keyList).run()`\n   *\n   * #### Example\n   *\n   * Get the entity whose primary key is 25\n   * ```js\n   * const entities = collection.get(25)\n   * ```\n   * Same as above\n   * ```js\n   * const entities = collection.get([25])\n   * ```\n   * Get all users who are active and have the \"admin\" role\n   * ```js\n   * const activeAdmins = collection.get(['active', 'admin'], {\n   *   index: 'activityAndRoles'\n   * })\n   * ```\n   * Get all entities that match a certain weather condition\n   * ```js\n   * const niceDays = collection.get(['sunny', 'humid', 'calm'], {\n   *   index: 'weatherConditions'\n   * })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {Array} keyList - Key(s) defining the entity to retrieve. If\n   * `keyList` is not an array (i.e. for a single-value key), it will be\n   * wrapped in an array.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.string] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @return {Array} The result.\n   */\n  get (keyList, opts) {\n    return this.query().get(keyList, opts).run()\n  },\n\n  /**\n   * Find the entity or entities that match the provided keyLists.\n   *\n   * Shortcut for `collection.query().getAll(keyList1, keyList2).run()`\n   *\n   * #### Example\n   *\n   * Get the posts where \"status\" is \"draft\" or \"inReview\"\n   * ```js\n   * const posts = collection.getAll('draft', 'inReview', { index: 'status' })\n   * ```\n   * Same as above\n   * ```js\n   * const posts = collection.getAll(['draft'], ['inReview'], { index: 'status' })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {...Array} [keyList] - Provide one or more keyLists, and all\n   * entities matching each keyList will be retrieved. If no keyLists are\n   * provided, all entities will be returned.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.index] - Name of the secondary index to use in the\n   * query. If no index is specified, the main index is used.\n   * @return {Array} The result.\n   */\n  getAll (...args) {\n    return this.query().getAll(...args).run()\n  },\n\n  /**\n   * Find the entity or entities that match the provided query or pass the\n   * provided filter function.\n   *\n   * Shortcut for `collection.query().filter(queryOrFn[, thisArg]).run()`\n   *\n   * #### Example\n   *\n   * Get the draft posts created less than three months\n   * ```js\n   * const posts = collection.filter({\n   *   where: {\n   *     status: {\n   *       '==': 'draft'\n   *     },\n   *     created_at_timestamp: {\n   *       '>=': (new Date().getTime() - (1000 * 60 * 60 * 24 * 30 * 3)) // 3 months ago\n   *     }\n   *   }\n   * })\n   * ```\n   * Use a custom filter function\n   * ```js\n   * const posts = collection.filter(function (post) {\n   *   return post.isReady()\n   * })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {(Object|Function)} [queryOrFn={}] - Selection query or filter\n   * function.\n   * @param {Object} [thisArg] - Context to which to bind `queryOrFn` if\n   * `queryOrFn` is a function.\n   * @return {Array} The result.\n   */\n  filter (query, thisArg) {\n    return this.query().filter(query, thisArg).run()\n  },\n\n  /**\n   * Skip a number of results.\n   *\n   * Shortcut for `collection.query().skip(numberToSkip).run()`\n   *\n   * #### Example\n   *\n   * ```js\n   * const posts = collection.skip(10)\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {number} num - The number of entities to skip.\n   * @return {Array} The result.\n   */\n  skip (num) {\n    return this.query().skip(num).run()\n  },\n\n  /**\n   * Limit the result.\n   *\n   * Shortcut for `collection.query().limit(maximumNumber).run()`\n   *\n   * #### Example\n   *\n   * ```js\n   * const posts = collection.limit(10)\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {number} num - The maximum number of entities to keep in the result.\n   * @return {Array} The result.\n   */\n  limit (num) {\n    return this.query().limit(num).run()\n  },\n\n  /**\n   * Iterate over all entities.\n   *\n   * #### Example\n   *\n   * ```js\n   * collection.forEach(function (entity) {\n   *   // do something\n   * })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {Function} forEachFn - Iteration function.\n   * @param {*} [thisArg] - Context to which to bind `forEachFn`.\n   * @return {Array} The result.\n   */\n  forEach (cb, thisArg) {\n    this.index.visitAll(cb, thisArg)\n  },\n\n  /**\n   * Reduce the data in the collection to a single value and return the result.\n   *\n   * #### Example\n   *\n   * ```js\n   * const totalVotes = collection.reduce(function (prev, entity) {\n   *   return prev + entity.upVotes + entity.downVotes\n   * }, 0)\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {Function} callback - Reduction callback.\n   * @param {*} initialValue - Initial value of the reduction.\n   * @return {*} The result.\n   */\n  reduce (callback, initialValue) {\n    const data = this.getAll()\n    return data.reduce(callback, initialValue)\n  },\n\n  /**\n   * Apply a mapping function to all entities.\n   *\n   * #### Example\n   *\n   * ```js\n   * const names = collection.map(function (user) {\n   *   return user.name\n   * })\n   * ```\n   *\n   * @memberof Collection\n   * @instance\n   * @param {Function} mapFn - Mapping function.\n   * @param {*} [thisArg] - Context to which to bind `mapFn`.\n   * @return {Array} The result of the mapping.\n   */\n  map (cb, thisArg) {\n    const data = []\n    this.index.visitAll(function (value) {\n      data.push(cb.call(thisArg, value))\n    })\n    return data\n  },\n\n  /**\n   * Instead a record into this collection, updating all indexes with the new\n   * record.\n   * one index.\n   * @memberof Collection\n   * @instance\n   * @param {Object} record - The record to insert.\n   */\n  insert (record) {\n    this.index.insertRecord(record)\n    forOwn(this.indexes, function (index, name) {\n      index.insertRecord(record)\n    })\n    if (record && isFunction(record.on)) {\n      record.on('all', this._onModelEvent, this)\n    }\n  },\n\n  /**\n   * Update the given record's position in all indexes of this collection. See\n   * {@link Collection#updateRecord} to update a record's in only one of the\n   * indexes.\n   * @memberof Collection\n   * @instance\n   * @param {Object} record - The record to update.\n   */\n  update (record) {\n    this.index.updateRecord(record)\n    forOwn(this.indexes, function (index, name) {\n      index.updateRecord(record)\n    })\n  },\n\n  /**\n   * Remove the given record from all indexes in this collection.\n   * @memberof Collection\n   * @instance\n   * @param {Object} record - The record to be removed.\n   */\n  remove (record) {\n    this.index.removeRecord(record)\n    forOwn(this.indexes, function (index, name) {\n      index.removeRecord(record)\n    })\n    if (record && isFunction(record.off)) {\n      record.off('all', this._onModelEvent, this)\n    }\n  },\n\n  /**\n   * Update a record's position in a single index of this collection. See\n   * {@link Collection#update} to update a record's position in all indexes at\n   * once.\n   * @memberof Collection\n   * @instance\n   * @param {Object} record - The record to update.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.index] The index in which to update the record's\n   * position. If you don't specify an index then the record will be updated\n   * in the main index.\n   */\n  updateRecord (record, opts) {\n    opts || (opts = {})\n    const index = opts.index ? this.indexes[opts.index] : this.index\n    index.updateRecord(record)\n  }\n})\n\neventify(\n  Collection.prototype,\n  function () {\n    return this._events\n  },\n  function (value) {\n    this._events = value\n  }\n)\n","import {\n  forOwn,\n  isArray,\n  isBoolean,\n  isNumber,\n  isObject,\n  isString\n} from '../utils'\n\nconst types = {\n  array: isArray,\n  boolean: isBoolean,\n  integer: isNumber,\n  number: isNumber,\n  'null': function (value) {\n    return value === null\n  },\n  object: isObject,\n  string: isString\n}\n\nexport const rules = {\n  type (predicate, value) {\n    if (value === undefined) {\n      return\n    }\n    if (isString(predicate)) {\n      predicate = [predicate]\n    }\n    const errors = predicate.map(function (type) {\n      const validator = types[type]\n      if (!validator) {\n        return `type: Unknown type ${predicate}`\n      }\n      return validator(value) ? undefined : 1\n    })\n    return errors.indexOf(undefined) !== -1 ? undefined : `type: Expected: ${predicate.join(' or ')}. Actual: ${typeof value}`\n  },\n\n  anyOf (schemas, value) {\n    let validated = false\n    let allErrors = []\n    schemas.forEach(function (schema) {\n      const errors = validate(schema, value)\n      if (errors) {\n        allErrors = allErrors.concat(errors)\n      } else {\n        validated = true\n      }\n    })\n    return validated ? undefined : allErrors\n  },\n\n  allOf (schemas, value) {\n    let allErrors = []\n    schemas.forEach(function (schema) {\n      allErrors = allErrors.concat(validate(schema, value) || [])\n    })\n    return allErrors.length ? undefined : allErrors\n  },\n\n  oneOf (schemas, value) {\n    let validated = false\n    let allErrors = []\n    schemas.forEach(function (schema) {\n      const errors = validate(schema, value)\n      if (errors) {\n        allErrors = allErrors.concat(errors)\n      } else if (validated) {\n        allErrors = ['more than one schema validated']\n        validated = false\n        return false\n      } else {\n        validated = true\n      }\n    })\n    return validated ? undefined : allErrors\n  }\n}\n\nexport function validate (schema, value) {\n  const errors = []\n  forOwn(schema, function (predicate, rule) {\n    const validator = rules[rule]\n    if (validator) {\n      const err = validator(predicate, value)\n      if (err) {\n        errors.push(err)\n      }\n    }\n  })\n  return errors.length ? errors : undefined\n}\n","import {copy, forOwn} from '../utils'\n\n/**\n * @memberof! module:js-data\n * @example\n * // ES6\n * import {configure, Model} from 'js-data'\n *\n * // @configure(opts) (ES7)\n * class User extends JSData.Model {}\n * configure(opts)(User)\n *\n * // ES5\n * var JSData = require('js-data')\n * var User = JSData.Model.extend()\n * User.configure(opts)\n *\n * @param {Object} opts - Properties to apply to the target.\n * @param {boolean} [overwrite=true] - Whether to overwrite properties that\n * already exist on the target.\n */\nexport function configure (opts, overwrite = true) {\n  opts = opts || {}\n  return function (target) {\n    forOwn(opts, function (value, key) {\n      if (target[key] === undefined || overwrite) {\n        target[key] = copy(value)\n      }\n    })\n    return target\n  }\n}\n","import {\n  forOwn,\n  get\n} from '../utils.js'\nimport {validate} from '../validate/index.js'\nimport {configure} from './configure.js'\n\nconst op = 'setSchema'\n\n/**\n * @param {Model} target - Target Model.\n * @param {string} key - Key for new property.\n * @param {Object} opts - Configuration options.\n * @ignore\n */\nfunction makeDescriptor (target, key, opts) {\n  const descriptor = {\n    enumerable: opts.enumerable !== undefined ? opts.enumerable : true,\n    configurable: opts.configurable !== undefined ? opts.configurable : true\n  }\n  descriptor.get = function () {\n    return this._get(`props.${key}`)\n  }\n  descriptor.set = function (value) {\n    // TODO: rework this\n    // if (isFunction(opts.validate) && !opts.validate(value)) {\n    //   return false\n    // }\n    const _get = this._get\n    const _set = this._set\n    const _unset = this._unset\n    if (!_get('noValidate')) {\n      const errors = validate(opts, value)\n      if (errors) {\n        throw new Error(errors.join(', '))\n      }\n    }\n    if (opts.track && !_get('creating')) {\n      const changing = _get('changing')\n      const previous = _get(`previous.${key}`)\n      const current = _get(`props.${key}`)\n      let changed = _get('changed')\n      if (!changing) {\n        changed = []\n      }\n      if (current !== value) {\n        changed.push(key)\n      }\n      if (previous !== value) {\n        _set(`changes.${key}`, value)\n      } else {\n        _unset(`changes.${key}`)\n      }\n      if (!changing && changed.length) {\n        _set('changed', changed)\n        _set('changing', true)\n        _set('eventId', setTimeout(() => {\n          _unset('changed')\n          _unset('eventId')\n          _unset('changing')\n          let i\n          for (i = 0; i < changed.length; i++) {\n            this.emit('change:' + changed[i], this, get(this, changed[i]))\n          }\n          this.emit('change', this, _get('changes'))\n        }, 0))\n      }\n    }\n    _set(`props.${key}`, value)\n    if (_get('$') && opts.indexed) {\n      target.collection.updateRecord(this, { index: key })\n    }\n    return value\n  }\n  if (opts.indexed) {\n    // Update index\n    // TODO: Make this configurable, ie. immediate or lazy update\n    target.createIndex(key)\n  }\n  if (opts.get) {\n    if (descriptor.get) {\n      const originalGet = descriptor.get\n      descriptor.get = function () {\n        return opts.get.call(this, originalGet)\n      }\n    } else {\n      descriptor.get = opts.get\n    }\n  }\n  if (opts.set) {\n    if (descriptor.set) {\n      const originalSet = descriptor.set\n      descriptor.set = function (value) {\n        return opts.set.call(this, value, originalSet)\n      }\n    } else {\n      descriptor.set = opts.set\n    }\n  }\n  return descriptor\n}\n\n/**\n * @memberof! module:js-data\n * @example\n * // ES6\n * import {setSchema, Model} from 'js-data'\n * const properties = {\n *   first: {},\n *   last: {},\n *   role: {\n *     value: 'dev'\n *   },\n *   // computed property\n *   name: {\n *     get() { return `${this.first} ${this.last}` },\n *     set(value) {\n *       let parts = value.split(' ')\n *       this.first = parts[0]\n *       this.last = parts[1]\n *       return this\n *     }\n *   }\n * }\n *\n * // @setSchema(properties) (ES7)\n * class User extends Model {}\n * User.setSchema(properties)\n *\n * // ES5\n * var JSData = require('js-data')\n * var User = JSData.Model.extend({}, { name: 'User' })\n * User.setSchema(properties)\n *\n * @param {Object.<string, Object>} opts - Property configurations.\n * @return {Function} Invocation function, which accepts the target as the only\n * parameter.\n */\nexport function setSchema (opts) {\n  opts || (opts = {})\n\n  return function (target) {\n    target.dbg(op, 'opts:', opts)\n\n    target.schema || (target.schema = {})\n    configure(target.schema, opts)\n\n    forOwn(opts, function (prop, key) {\n      const descriptor = makeDescriptor(target, key, prop)\n      // TODO: This won't work for properties of Object type, because all\n      // instances will share the prototype value\n      if (!descriptor.writable) {\n        Object.defineProperty(target.prototype, key, descriptor)\n      }\n    })\n    return target\n  }\n}\n","const op = 'registerAdapter'\n\n/**\n * Add the provided adapter to the target's \"adapters\" property, registering it\n * with the specified.\n * @memberof! module:js-data\n * @param {string} name - The name under which to register the adapter.\n * @param {Adapter} adapter - The adapter to register.\n * @param {Object} opts - Configuration options.\n * @param {boolean} [opts.default=false] - Whether to make the adapter the\n * default adapter for the target.\n * @return {Function} Invocation function, which accepts the target as the only\n * parameter.\n */\nexport function registerAdapter (name, adapter, opts) {\n  opts || (opts = {})\n  opts.op = op\n  return function (target) {\n    target.dbg(op, 'name:', name, 'adapter:', adapter, 'opts:', opts)\n    // Register the adapter\n    target.adapters[name] = adapter\n    // Optionally make it the default adapter for the target.\n    if (opts === true || opts.default) {\n      target.defaultAdapter = name\n    }\n  }\n}\n","import {get, set} from '../utils.js'\n\nconst op = 'belongsTo'\n\n/**\n * Steps to apply a \"belongsTo\" relationship\n * 1. Choose the localField and localKey\n * 2. Configure property descriptor, possibly including custom getter/setter\n * 3. Add property to prototype of target Model\n *\n * The added property is where an instance of the related Model will be\n * attached to an instance of the target Model, e.g. if Comment belongsTo\n * User and \"localField\" is set to \"user\", \"comment.user\" will be a reference to\n * the user.\n *\n * @ignore\n */\nfunction applyBelongsTo (Model, Relation, opts) {\n  opts || (opts = {})\n  // Choose field where the relation will be attached\n  const localField = opts.localField = opts.localField || Relation.name.toLowerCase()\n  // Choose field that holds the primary key of the relation\n  const localKey = opts.localKey = opts.localKey || Relation.name.toLowerCase() + '_id'\n\n  // Setup configuration of the property\n  const descriptor = {\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\n    // Set default method for retrieving the linked relation\n    get () {\n      if (!this._get('$')) {\n        return this._get(`links.${localField}`)\n      }\n      const key = get(this, localKey)\n      const item = key !== undefined ? Relation.get(key) : undefined\n      this._set(`links.${localField}`, item)\n      return item\n    },\n    // Set default method for setting the linked relation\n    set (parent) {\n      this._set(`links.${localField}`, parent)\n      set(this, localKey, parent[Relation.idAttribute])\n      return get(this, localField)\n    }\n  }\n\n  const originalGet = descriptor.get\n  const originalSet = descriptor.set\n\n  // Check whether the relation shouldn't actually be linked via a getter\n  if (opts.link === false || (opts.link === undefined && !Model.linkRelations)) {\n    delete descriptor.get\n    delete descriptor.set\n    descriptor.writable = true\n  }\n\n  // Check for user-defined getter\n  if (opts.get) {\n    // Set user-defined getter\n    descriptor.get = function () {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - the original getter function, in case the user wants to use it\n      return opts.get(Model, Relation, this, originalGet ? (...args) => originalGet.apply(this, args) : undefined)\n    }\n    delete descriptor.writable\n  }\n\n  // Check for user-defined setter\n  if (opts.set) {\n    // Set user-defined setter\n    descriptor.set = function (parent) {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - instance of related Model\n      //  - the original setter function, in case the user wants to use it\n      return opts.set(Model, Relation, this, parent, originalSet ? (...args) => originalSet.apply(this, args) : undefined)\n    }\n    delete descriptor.writable\n  }\n\n  if (descriptor.get) {\n    descriptor.set || (descriptor.set = function () {})\n  }\n\n  // Finally, added property to prototype of target Model\n  Object.defineProperty(Model.prototype, localField, descriptor)\n\n  if (!Model.relationList) {\n    Model.relationList = []\n  }\n  if (!Model.relationFields) {\n    Model.relationFields = []\n  }\n  opts.type = 'belongsTo'\n  opts.name = Model.name\n  opts.relation = Relation.name\n  opts.Relation = Relation\n  Model.relationList.push(opts)\n  Model.relationFields.push(localField)\n  Model.collection.createIndex(localKey)\n\n  // Return target Model for chaining\n  return Model\n}\n\n/**\n * @memberof! module:js-data\n * @example\n * // ES6\n * import {belongsTo, Model} from 'js-data'\n * class User extends Model {}\n *\n * // @belongsTo(User) (ES7)\n * class Comment extends Model {}\n * belongsTo(User)(Comment)\n *\n * // ES5\n * var JSData = require('js-data')\n * var User = JSData.Model.extend({}, { name: 'User' })\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\n * JSData.belongsTo(User)(Comment)\n *\n * @param {Model} Model - The Model the target belongs to.\n * @param {Object} [opts] - Configuration options.\n * @param {string} [opts.localField] - The field on the target where the relation\n * will be attached.\n * @return {Function} Invocation function, which accepts the target as the only\n * parameter.\n */\nexport function belongsTo (Model, opts) {\n  return function (target) {\n    target.dbg(op, 'Model:', Model, 'opts:', opts)\n    return applyBelongsTo(target, Model, opts)\n  }\n}\n","import {camelCase, isArray, get, set} from '../utils'\n\nconst op = 'hasMany'\n\n/**\n * Steps to apply a \"hasMany\" relationship\n * 1. Choose the localField and foreignKey or localKeys\n * 2. Configure property descriptor, possibly including custom getter/setter\n * 3. Add property to prototype of target Model\n *\n * The added property is where instances of the related Model will be\n * attached to an instance of the target Model, e.g. if User hasMany Comment\n * and \"localField\" is set to \"comments\", \"user.comments\" will be a reference to\n * the array of comments.\n *\n * @ignore\n */\nfunction applyHasMany (Model, Relation, opts) {\n  opts || (opts = {})\n  // Choose field where the relation will be attached\n  const localField = opts.localField || `${camelCase(Relation.name)}Collection`\n  // Choose field on related instances that holds the primary key of instances\n  // of the target Model\n  let foreignKey = opts.foreignKey\n  const localKeys = opts.localKeys\n  const foreignKeys = opts.foreignKeys\n\n  if (!foreignKey && !localKeys && !foreignKeys) {\n    foreignKey = opts.foreignKey = `${camelCase(Model.name)}Id`\n  }\n  if (foreignKey) {\n    Relation.collection.createIndex(foreignKey)\n  }\n\n  // Setup configuration of the property\n  const descriptor = {\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\n    // Set default method for retrieving the linked relation\n    get () {\n      if (!this._get('$')) {\n        return this._get(`links.${localField}`)\n      }\n      const query = {}\n      let items\n      if (foreignKey) {\n        // Make a FAST retrieval of the relation using a secondary index\n        items = Relation.getAll(get(this, Model.idAttribute), { index: foreignKey })\n      } else if (localKeys) {\n        const keys = get(this, localKeys) || []\n        const args = isArray(keys) ? keys : Object.keys(keys)\n        // Make a slower retrieval using the ids in the \"localKeys\" array\n        items = Relation.getAll.apply(Relation, args)\n      } else if (foreignKeys) {\n        set(query, `where.${foreignKeys}.contains`, get(this, Model.idAttribute))\n        // Make a much slower retrieval\n        items = Relation.filter(query)\n      }\n      this._set(`links.${localField}`, items)\n      return items\n    },\n    // Set default method for setting the linked relation\n    set (children) {\n      this._set(`links.${localField}`, children)\n      if (children && children.length) {\n        const id = get(this, Model.idAttribute)\n        if (foreignKey) {\n          children.forEach(function (child) {\n            set(child, foreignKey, id)\n          })\n        } else if (localKeys) {\n          const keys = []\n          children.forEach(function (child) {\n            keys.push(get(child, Relation.idAttribute))\n          })\n          set(this, localKeys, keys)\n        } else if (foreignKeys) {\n          children.forEach(function (child) {\n            const keys = get(child, foreignKeys)\n            if (keys) {\n              if (keys.indexOf(id) === -1) {\n                keys.push(id)\n              }\n            } else {\n              set(child, foreignKeys, [id])\n            }\n          })\n        }\n      }\n      return get(this, localField)\n    }\n  }\n\n  // Check whether the relation shouldn't actually be linked via a getter\n  if (opts.link === false || (opts.link === undefined && !Model.linkRelations)) {\n    delete descriptor.get\n    delete descriptor.set\n    descriptor.writable = true\n  }\n\n  // Check for user-defined getter\n  if (opts.get) {\n    const originalGet = descriptor.get\n    // Set user-defined getter\n    descriptor.get = function () {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - the original getter function, in case the user wants to use it\n      return opts.get(Model, Relation, this, originalGet ? (...args) => originalGet.apply(this, args) : undefined)\n    }\n  }\n\n  // Check for user-defined setter\n  if (opts.set) {\n    const originalSet = descriptor.set\n    // Set user-defined setter\n    descriptor.set = function (children) {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - instances of related Model\n      //  - the original setter function, in case the user wants to use it\n      return opts.set(Model, Relation, this, children, originalSet ? (...args) => originalSet.apply(this, args) : undefined)\n    }\n  }\n\n  // Finally, added property to prototype of target Model\n  Object.defineProperty(Model.prototype, localField, descriptor)\n\n  if (!Model.relationList) {\n    Model.relationList = []\n  }\n  if (!Model.relationFields) {\n    Model.relationFields = []\n  }\n  opts.type = 'hasMany'\n  opts.name = Model.name\n  opts.relation = Relation.name\n  opts.Relation = Relation\n  Model.relationList.push(opts)\n  Model.relationFields.push(localField)\n\n  // Return target Model for chaining\n  return Model\n}\n\n/**\n * @memberof! module:js-data\n * @example\n * // ES6\n * import {hasMany, Model} from 'js-data'\n * class Comment extends Model {}\n *\n * // @hasMany(Comment)\n * class User extends Model {}\n * hasMany(Comment)(User)\n *\n * // ES5\n * var JSData = require('js-data')\n * var User = JSData.Model.extend({}, { name: 'User' })\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\n * JSData.hasMany(User)(Comment)\n *\n * @param {Model} Model - The Model of which the target has many.\n * @param {Object} [opts] - Configuration options.\n * @param {string} [opts.localField] - The field on the target where the relation\n * will be attached.\n * @return {Function} Invocation function, which accepts the target as the only\n * parameter.\n */\nexport function hasMany (Model, opts) {\n  return function (target) {\n    target.dbg(op, 'Model:', Model, 'opts:', opts)\n    return applyHasMany(target, Model, opts)\n  }\n}\n","import {camelCase, get, set} from '../utils'\n\nconst op = 'hasOne'\n\n/**\n * Steps to apply a \"hasOne\" relationship\n * 1. Choose the foreignKey and localKey\n * 2. Configure property descriptor, possibly including custom getter/setter\n * 3. Add property to prototype of target Model\n *\n * The added property is where an instance of the related Model will be\n * attached to an instance of the target Model, e.g. if User hasOne\n * Profile and \"localField\" is set to \"profile\", \"user.profile\" will be a\n * reference to the profile.\n *\n * @ignore\n */\nfunction applyHasOne (Model, Relation, opts) {\n  opts || (opts = {})\n  // Choose field where the relation will be attached\n  const localField = opts.localField = opts.localField || camelCase(Relation.name)\n  // Choose field that holds the primary key of the relation\n  const foreignKey = opts.foreignKey = opts.foreignKey || `${camelCase(Model.name)}Id`\n\n  // Setup configuration of the property\n  const descriptor = {\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\n    // Set default method for retrieving the linked relation\n    get () {\n      if (!this._get('$')) {\n        return this._get(`links.${localField}`)\n      }\n      const items = Relation.getAll(get(this, Model.idAttribute), { index: foreignKey })\n      const item = items && items.length ? items[0] : undefined\n      this._set(`links.${localField}`, item)\n      return item\n    },\n    // Set default method for setting the linked relation\n    set (child) {\n      this._set(`links.${localField}`, child)\n      set(child, foreignKey, get(this, Model.idAttribute))\n      return get(this, localField)\n    }\n  }\n\n  // Check whether the relation shouldn't actually be linked via a getter\n  if (opts.link === false || (opts.link === undefined && !Model.linkRelations)) {\n    delete descriptor.get\n    delete descriptor.set\n  }\n\n  // Check for user-defined getter\n  if (opts.get) {\n    const originalGet = descriptor.get\n    // Set user-defined getter\n    descriptor.get = function () {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - the original getter function, in case the user wants to use it\n      return opts.get(Model, Relation, this, originalGet ? (...args) => originalGet.apply(this, args) : undefined)\n    }\n  }\n\n  // Check for user-defined setter\n  if (opts.set) {\n    const originalSet = descriptor.set\n    // Set user-defined setter\n    descriptor.set = function (child) {\n      // Call user-defined getter, passing in:\n      //  - target Model\n      //  - related Model\n      //  - instance of target Model\n      //  - instance of related Model\n      //  - the original setter function, in case the user wants to use it\n      return opts.set(Model, Relation, this, child, originalSet ? (...args) => originalSet.apply(this, args) : undefined)\n    }\n  }\n\n  // Finally, added property to prototype of target Model\n  Object.defineProperty(Model.prototype, localField, descriptor)\n\n  if (!Model.relationList) {\n    Model.relationList = []\n  }\n  if (!Model.relationFields) {\n    Model.relationFields = []\n  }\n  opts.type = 'hasOne'\n  opts.name = Model.name\n  opts.relation = Relation.name\n  opts.Relation = Relation\n  Model.relationList.push(opts)\n  Model.relationFields.push(localField)\n  Model.collection.createIndex(foreignKey)\n\n  // Return target Model for chaining\n  return Model\n}\n\n/**\n * @memberof! module:js-data\n * @example\n * // ES6\n * import {hasOne, Model} from 'js-data'\n * class User extends Model {}\n *\n * // @hasOne(User) (ES7)\n * class Comment extends Model {}\n * hasOne(User, {...})(Comment)\n *\n * // ES5\n * var JSData = require('js-data')\n * var User = JSData.Model.extend({}, { name: 'User' })\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\n * JSData.hasOne(User, {...})(Comment)\n *\n * @param {Model} Model - The Model of which the target has one.\n * @param {Object} [opts] - Configuration options.\n * @param {string} [opts.localField] - The field on the target where the relation\n * will be attached.\n * @return {Function} Invocation function, which accepts the target as the only\n * parameter.\n */\nexport function hasOne (Model, opts) {\n  return function (target) {\n    target.dbg(op, 'Model:', Model, 'opts:', opts)\n    return applyHasOne(target, Model, opts)\n  }\n}\n","/** global babelHelpers */\nimport * as utils from '../utils.js'\nimport {\n  belongsTo,\n  configure,\n  hasMany,\n  hasOne,\n  setSchema,\n  registerAdapter\n} from '../decorators/index.js'\nimport {Collection} from '../collection/index.js'\nimport * as validate from '../validate/index.js'\n\nconst {\n  resolve\n} = utils\n\nlet isBrowser = false\n\ntry {\n  isBrowser = !!window\n} catch (e) {\n}\n\nconst handleResponse = function handleResponse (model, data, opts, adapterName) {\n  if (opts.raw) {\n    data.adapter = adapterName\n    if (opts.autoInject) {\n      data.data = model.inject(data.data)\n    }\n    return data\n  } else if (opts.autoInject) {\n    data = model.inject(data)\n  }\n  return data\n}\n\n/**\n * This is here so Babel will give us the inheritance helpers which we can\n * re-use for the \"extend\" method.\n * @ignore\n */\nclass BaseModel {}\n\n/**\n * js-data's Model class.\n * @class Model\n * @example {@lang javascript}class User extends Model {}\n *\n * @abstract\n * @param {Object} [props] The initial properties of the new instance.\n * @param {Object} [opts] Configuration options.\n * @param {boolean} [opts.noValidate=false] Whether to skip validation on the\n * initial properties.\n */\nexport class Model extends BaseModel {\n  constructor (props, opts) {\n    super()\n    props || (props = {})\n    opts || (opts = {})\n    const _props = {}\n    Object.defineProperties(this, {\n      _get: {\n        value (key) {\n          return utils.get(_props, key)\n        }\n      },\n      _set: {\n        value (key, value) {\n          return utils.set(_props, key, value)\n        }\n      },\n      _unset: {\n        value (key) {\n          return utils.unset(_props, key)\n        }\n      }\n    })\n    this._set('creating', true)\n    if (opts.noValidate) {\n      this._set('noValidate', true)\n    }\n    utils.fillIn(this, props)\n    this._unset('creating')\n    this._unset('noValidate')\n    this._set('previous', utils.copy(props))\n  }\n\n  schema (key) {\n    let _schema = this.constructor.schema\n    return key ? _schema[key] : _schema\n  }\n\n  validate (obj, value) {\n    let errors = []\n    let _schema = this.schema()\n    if (!obj) {\n      obj = this\n    } else if (utils.isString(obj)) {\n      const prop = _schema[obj]\n      if (prop) {\n        errors = validate.validate(prop, value) || []\n      }\n    } else {\n      utils.forOwn(_schema, function (prop, key) {\n        errors = errors.concat(validate.validate(prop, utils.get(obj, key)) || [])\n      })\n    }\n    return errors.length ? errors : undefined\n  }\n\n  /**\n   * @param {Object} [opts] Configuration options. @see {@link Model.create}.\n   */\n  create (opts) {\n    return this.constructor.create(this, opts)\n  }\n\n  save (opts) {\n    // TODO: move actual save logic here\n    const Ctor = this.constructor\n\n    const adapterName = Ctor.getAdapterName(opts)\n    return Ctor.getAdapter(adapterName)\n      .update(Ctor, utils.get(this, Ctor.idAttribute), this, opts)\n  }\n\n  /**\n   * @param {Object} [opts] Configuration options. @see {@link Model.destroy}.\n   */\n  destroy (opts) {\n    // TODO: move actual destroy logic here\n    const Ctor = this.constructor\n    return Ctor.destroy(utils.get(this, Ctor.idAttribute), opts)\n  }\n\n  // TODO: move logic for single-item async operations onto the instance.\n\n  /**\n   * Return the value at the given path for this instance.\n   *\n   * @param {string} key - Path of value to retrieve.\n   * @return {*} Value at path.\n   */\n  ['get'] (key) {\n    return utils.get(this, key)\n  }\n\n  /**\n   * Set the value for a given key, or the values for the given keys if \"key\" is\n   * an object.\n   *\n   * @param {(string|Object)} key - Key to set or hash of key-value pairs to set.\n   * @param {*} [value] - Value to set for the given key.\n   * @param {Object} [opts] - Optional configuration.\n   * - boolean [silent=false] - Whether to trigger change events.\n   */\n  ['set'] (key, value, opts) {\n    opts || (opts = {})\n    // TODO: implement \"silent\"\n    return utils.set(this, key, value)\n  }\n\n  hashCode () {\n    return utils.get(this, this.constructor.idAttribute)\n  }\n\n  changes (key) {\n    if (key) {\n      return this._get(`changes.${key}`)\n    }\n    return this._get('changes')\n  }\n\n  changed () {\n    return this._get('changed')\n  }\n\n  hasChanges () {\n    return !!(this._get('changed') || []).length\n  }\n\n  commit () {\n    this._unset('changed')\n    this._set('changes', {})\n    this._set('previous', utils.copy(this))\n    return this\n  }\n\n  previous (key) {\n    if (key) {\n      return this._get(`previous.${key}`)\n    }\n    return this._get('previous')\n  }\n\n  revert (opts) {\n    const previous = this._get('previous') || {}\n    opts || (opts = {})\n    opts.preserve || (opts.preserve = [])\n    utils.forOwn(this, (value, key) => {\n      if (key !== this.constructor.idAttribute && !previous.hasOwnProperty(key) && this.hasOwnProperty(key) && opts.preserve.indexOf(key) === -1) {\n        delete this[key]\n      }\n    })\n    utils.forOwn(previous, (value, key) => {\n      if (opts.preserve.indexOf(key) === -1) {\n        this[key] = value\n      }\n    })\n    this.commit()\n    return this\n  }\n\n  /**\n   * Return a plain object representation of this instance.\n   *\n   * @param {Object} [opts] - Configuration options.\n   * @param {string[]} [opts.with] - Array of relation names or relation fields\n   * to include in the representation.\n   * @return {Object} Plain object representation of instance.\n   */\n  toJSON (opts) {\n    opts || (opts = {})\n    const Ctor = this.constructor\n    let json = this\n    if (this instanceof Model) {\n      json = {}\n      utils.set(json, this)\n      if (Ctor && Ctor.relationList && opts.with) {\n        if (utils.isString(opts.with)) {\n          opts.with = [opts.with]\n        }\n        Ctor.relationList.forEach(def => {\n          let containedName\n          if (opts.with.indexOf(def.relation) !== -1) {\n            containedName = def.relation\n          } else if (opts.with.indexOf(def.localField) !== -1) {\n            containedName = def.localField\n          }\n          if (containedName) {\n            const optsCopy = { with: opts.with.slice() }\n            optsCopy.with.splice(optsCopy.with.indexOf(containedName), 1)\n            optsCopy.with.forEach((relation, i) => {\n              if (relation && relation.indexOf(containedName) === 0 && relation.length >= containedName.length && relation[containedName.length] === '.') {\n                optsCopy.with[i] = relation.substr(containedName.length + 1)\n              } else {\n                optsCopy.with[i] = ''\n              }\n            })\n            const relationData = utils.get(this, def.localField)\n            if (relationData) {\n              if (utils.isArray(relationData)) {\n                utils.set(json, def.localField, relationData.map(item => def.Relation.prototype.toJSON.call(item, optsCopy)))\n              } else {\n                utils.set(json, def.localField, def.Relation.prototype.toJSON.call(relationData, optsCopy))\n              }\n            }\n          }\n        })\n      }\n    }\n    return json\n  }\n\n  /**\n   * Static methods\n   */\n\n  /**\n   * Create a new secondary index in the Collection instance of this Model.\n   *\n   * @param {string} name - The name of the new secondary index\n   * @param {string[]} keyList - The list of keys to be used to create the index.\n   */\n  static createIndex (name, keyList) {\n    this.dbg('createIndex', 'name:', name, 'keyList:', keyList)\n    this.collection.createIndex(name, keyList)\n  }\n\n  /**\n   * Create a new instance of this Model from the provided properties.\n   *\n   * @param {Object} props - The initial properties of the new instance.\n   * @return {Model} The instance.\n   */\n  static createInstance (props) {\n    let Ctor = this\n    // Check to make sure \"props\" is not already an instance of this Model.\n    return props instanceof Ctor ? props : new Ctor(props)\n  }\n\n  /**\n   * Check whether \"instance\" is actually an instance of this Model.\n   *\n   * @param {Model} The instance to check.\n   * @return {boolean} Whether \"instance\" is an instance of this Model.\n   */\n  static is (instance) {\n    return instance instanceof this\n  }\n\n  static getAutoPkItems () {\n    return this.getAll().filter(function (item) {\n      return item._get('autoPk')\n    })\n  }\n\n  /**\n   * Insert the provided item or items into the Collection instance of this\n   * Model.\n   *\n   * If an item is already in the collection then the provided item will either\n   * merge with or replace the existing item based on the value of the\n   * \"onConflict\" option.\n   *\n   * The collection's secondary indexes will be updated as each item is visited.\n   *\n   * @param {(Object|Object[]|Model|Model[])} items - The item or items to insert.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.onConflict] - What to do when an item is already in\n   * the Collection instance. Possible values are `merge` or `replace`.\n   * @return {(Model|Model[])} The injected entity or entities.\n   */\n  static inject (items, opts) {\n    const _this = this\n    const op = 'inject'\n    _this.dbg(op, 'item(s):', items, 'opts:', opts)\n    opts || (opts = {})\n    opts.op = op\n    let singular = false\n    const collection = _this.collection\n    const idAttribute = _this.idAttribute\n    const relationList = _this.relationList || []\n    if (!utils.isArray(items)) {\n      items = [items]\n      singular = true\n    }\n    items = items.map(function (props) {\n      let id = utils.get(props, idAttribute)\n      let autoPk = false\n      if (!utils.isSorN(id)) {\n        if (opts.autoPk || (opts.autoPk === undefined && _this.autoPk)) {\n          id = utils.uuid()\n          utils.set(props, idAttribute, id)\n          autoPk = true\n        } else {\n          throw new TypeError(`User#${idAttribute}: Expected string or number, found ${typeof id}!`)\n        }\n      }\n      const existing = _this.get(id)\n      if (props === existing) {\n        return existing\n      }\n\n      relationList.forEach(function (def) {\n        const Relation = def.Relation\n        const relationIdAttribute = Relation.idAttribute\n        const foreignKey = def.foreignKey\n\n        let toInject = utils.get(props, def.localField)\n\n        if (utils.isFunction(def.inject)) {\n          def.inject(_this, def, props)\n        } else if (toInject && def.inject !== false) {\n          if (utils.isArray(toInject)) {\n            toInject = toInject.map(function (toInjectItem) {\n              if (toInjectItem !== Relation.get(utils.get(toInjectItem, relationIdAttribute))) {\n                try {\n                  if (foreignKey) {\n                    utils.set(toInjectItem, foreignKey, id)\n                  }\n                  toInjectItem = Relation.inject(toInjectItem)\n                } catch (err) {\n                  throw new Error(`Failed to inject ${def.type} relation: \"${def.relation}\"! ${err.message}`)\n                }\n              }\n              return toInjectItem\n            })\n            if (def.localKeys) {\n              utils.set(props, def.localKeys, toInject.map(function (injected) {\n                return utils.get(injected, relationIdAttribute)\n              }))\n            }\n          } else {\n            // handle injecting belongsTo and hasOne relations\n            if (toInject !== Relation.get(utils.get(toInject, relationIdAttribute))) {\n              try {\n                if (def.localKey) {\n                  utils.set(props, def.localKey, utils.get(toInject, Relation.idAttribute))\n                }\n                if (foreignKey) {\n                  utils.set(toInject, def.foreignKey, utils.get(props, idAttribute))\n                }\n                toInject = Relation.inject(toInject)\n              } catch (err) {\n                throw new Error(`Failed to inject ${def.type} relation: \"${def.relation}\"!`)\n              }\n            }\n          }\n        }\n        // remove relation properties from the item, since those relations have been injected by now\n        if (def.link || (def.link === undefined && _this.linkRelations)) {\n          utils.unset(props, def.localField)\n        } else {\n          utils.set(props, def.localField, toInject)\n        }\n      })\n\n      if (existing) {\n        const onConflict = opts.onConflict || _this.onConflict\n        if (onConflict === 'merge') {\n          utils.deepMixIn(existing, props)\n        } else if (onConflict === 'replace') {\n          utils.forOwn(existing, (value, key) => {\n            if (key !== idAttribute && !props.hasOwnProperty(key)) {\n              delete existing[key]\n            }\n          })\n          existing.set(props)\n        }\n        props = existing\n        collection.update(props)\n      } else {\n        props = _this.createInstance(props)\n        props._set('$', true)\n        if (autoPk) {\n          props._set('autoPk', autoPk)\n        }\n        collection.insert(props)\n      }\n      return props\n    })\n    return singular ? (items.length ? items[0] : undefined) : items\n  }\n\n  /**\n   * Remove the instance with the given primary key from the Collection instance\n   * of this Model.\n   *\n   * @param {(string|number)} id - The primary key of the instance to be removed.\n   * @return {Model} The removed item, if any.\n   */\n  static eject (id, opts) {\n    const op = 'eject'\n    this.dbg(op, 'id:', id, 'opts:', opts)\n    opts || (opts = {})\n    opts.op = op\n    const item = this.get(id)\n    if (item) {\n      item._unset('$')\n      this.collection.remove(item)\n    }\n    return item\n  }\n\n  /**\n   * Remove the instances selected by \"query\" from the Collection instance of\n   * this Model.\n   *\n   * @param {Object} [query] - The query used to select instances to remove.\n   * @return {Model[]} The removed instances, if any.\n   */\n  static ejectAll (params, opts) {\n    const op = 'ejectAll'\n    this.dbg(op, 'params:', params, 'opts:', opts)\n    opts || (opts = {})\n    opts.op = op\n    const items = this.filter(params)\n    const collection = this.collection\n    items.forEach(function (item) {\n      collection.remove(item)\n    })\n    return items\n  }\n\n  /**\n   * Return the instance in the Collection instance of this Model that has\n   * the given primary key, if such an instance can be found.\n   *\n   * @param {(string|number)} id - Primary key of the instance to retrieve.\n   * @return {Model} The instance or undefined.\n   */\n  static get (id) {\n    this.dbg('get', 'id:', id)\n    const instances = this.collection.get(id)\n    return instances.length ? instances[0] : undefined\n  }\n\n  /**\n   * Proxy for Collection#between\n   */\n  static between (...args) {\n    return this.collection.between(...args)\n  }\n\n  /**\n   * Proxy for Collection#getAll\n   */\n  static getAll (...args) {\n    return this.collection.getAll(...args)\n  }\n\n  /**\n   * Proxy for Collection#filter\n   */\n  static filter (query, opts) {\n    opts || (opts = {})\n    return this.collection.filter(query, opts)\n  }\n\n  /**\n  * Proxy for `Model.collection.query()`.\n   * @return {Query}\n   */\n  static query () {\n    return this.collection.query()\n  }\n\n  /**\n   * Return the registered adapter with the given name or the default adapter if\n   * no name is provided.\n   *\n   * @param {string} [name]- The name of the adapter to retrieve.\n   * @return {Adapter} The adapter, if any.\n   */\n  static getAdapter (name) {\n    this.dbg('getAdapter', 'name:', name)\n    const adapter = this.getAdapterName(name)\n    if (!adapter) {\n      throw new ReferenceError(`${adapter} not found!`)\n    }\n    return this.adapters[adapter]\n  }\n\n  /**\n   * Return the name of a registered adapter based on the given name or options,\n   * or the name of the default adapter if no name provided\n   *\n   * @param {Object} [opts] - The options, if any.\n   * @return {string} The name of the adapter.\n   */\n  static getAdapterName (opts) {\n    opts || (opts = {})\n    if (utils.isString(opts)) {\n      opts = { adapter: opts }\n    }\n    return opts.adapter || opts.defaultAdapter\n  }\n\n  /**\n   * Lifecycle hook. Called by `Model.create` after `Model.create` checks\n   * whether it can do an upsert and before `Model.create` calls the `create`\n   * method of an adapter.\n   *\n   * `Model.beforeCreate` will receive the same arguments that are passed to\n   * `Model.create`. If `Model.beforeCreate` returns a promise, `Model.create`\n   * will wait for the promise to resolve before continuing. If the promise\n   * rejects, then the promise returned by `Model.create` will reject. If\n   * `Model.beforeCreate` does not return a promise, `Model.create` will resume\n   * execution immediately.\n   *\n   * @param {Object} props - Properties object that was passed to `Model.create`.\n   * @param {Object} opts - Options object that was passed to `Model.create`.\n   */\n  static beforeCreate () {}\n\n  /**\n   * The \"C\" in \"CRUD\", `Model.create` creates a single entity using the\n   * `create` method of an adapter. If the `props` passed to `Model.create`\n   * contain a primary key as configured by `Model.idAttribute` and\n   * `opts.upsert` is `true` of `Model.upsert` is `true` and `opts.upsert` is\n   * not `false`, then `Model.update` will be called instead.\n   *\n   * 1. `Model.beforeCreate` is called and passed the same arguments passed to\n   * `Model.create`.\n   * 1. `props` and `opts` are passed to the `create` method of the adapter\n   * specified by `opts.adapter` or `Model.defaultAdapter`.\n   * 1. `Model.afterCreate` is called with the `data` argument returned by the\n   * adapter's `create` method and the `opts` argument passed to `Model.create`.\n   * 1. If `opts.raw` is `true` or `Model.raw` is `true` and `opts.raw` is not\n   * `false`, then a result object is returned that contained the created entity\n   * and some metadata about the operation and its result. Otherwise, the\n   * promise returned by `Model.create` resolves with the created entity.\n   *\n   * @param {Object} props - The properties from which to create the new entity.\n   * @param {Object} [opts] - Configuration options.\n   * @param {string} [opts.adapter] - The name of the registered adapter to use.\n   * @param {boolean} [opts.raw] - The name of the registered adapter to use.\n   * @param {boolean} [opts.upsert] - Whether to call {@link Model.update}\n   * instead if `props` has a primary key.\n   * @return {Object} The created entity, or if `raw` is `true` then a result\n   * object.\n   */\n  static create (props, opts) {\n    const op = 'create'\n    this.dbg(op, 'props:', props, 'opts:', opts)\n    let adapterName\n\n    props || (props = {})\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    if (opts.upsert && utils.get(props, this.idAttribute) && (!this.is(props) || !props._get('autoPk'))) {\n      return this.update(utils.get(props, this.idAttribute), props, opts)\n    }\n    return resolve(this.beforeCreate(props, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .create(this, this.prototype.toJSON.call(props, opts), opts)\n      })\n      .then(data => {\n        return resolve(this.afterCreate(data, opts))\n          .then(() => {\n            if (this.is(props) && props._get('$')) {\n              this.eject(utils.get(props, this.idAttribute))\n            }\n            return handleResponse(this, data, opts, adapterName)\n          })\n      })\n  }\n\n  /**\n   * Lifecycle hook. Called by `Model.create` after `Model.create` call the\n   * `create` method of an adapter.\n   *\n   * `Model.afterCreate` will receive the `data` argument returned by the\n   * adapter's `create` method and the `opts` argument passed to `Model.create`.\n   * If `Model.afterCreate` returns a promise, `Model.create` will wait for the\n   * promise to resolve before continuing. If the promise rejects, then the\n   * promise returned by `Model.create` will reject. If `Model.afterCreate` does\n   * not return a promise, `Model.create` will resume execution immediately.\n   *\n   * @param {Object} data - Data object returned by the adapter's `create` method.\n   * @param {Object} opts - Options object that was passed to `Model.create`.\n   */\n  static afterCreate () {}\n\n  static beforeCreateMany () {}\n  static createMany (items, opts) {\n    const op = 'createMany'\n    this.dbg(op, 'items:', items, 'opts:', opts)\n    let adapterName\n\n    items || (items = [])\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    if (opts.upsert) {\n      let hasId = true\n      items.forEach(item => {\n        hasId = hasId && utils.get(item, this.idAttribute) && (!utils.isFunction(item._get) || !item._get('autoPk'))\n      })\n      if (hasId) {\n        return this.updateMany(items, opts)\n      }\n    }\n\n    return resolve(this.beforeCreateMany(items, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .createMany(this, items.map(item => this.prototype.toJSON.call(item, opts)), opts)\n      })\n      .then(data => {\n        return resolve(this.afterCreateMany(data, opts))\n          .then(() => {\n            items.forEach(item => {\n              if (this.is(item) && item._get('$')) {\n                this.eject(utils.get(item, this.idAttribute))\n              }\n            })\n            return handleResponse(this, data, opts, adapterName)\n          })\n      })\n  }\n  static afterCreateMany () {}\n\n  static beforeFind () {}\n  static find (id, opts) {\n    const op = 'find'\n    this.dbg(op, 'id:', id, 'opts:', opts)\n    let adapterName\n\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeFind(id, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .find(this, id, opts)\n      })\n      .then(data => {\n        return resolve(this.afterFind(data, opts))\n          .then(() => handleResponse(this, data, opts, adapterName))\n      })\n  }\n  static afterFind () {}\n\n  static beforeFindAll () {}\n  static findAll (query, opts) {\n    const op = 'findAll'\n    this.dbg(op, 'query:', query, 'opts:', opts)\n    let adapterName\n\n    query || (query = {})\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeFindAll(query, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .findAll(this, query, opts)\n      })\n      .then(data => {\n        return resolve(this.afterFindAll(data, opts))\n          .then(() => handleResponse(this, data, opts, adapterName))\n      })\n  }\n  static afterFindAll () {}\n\n  static beforeUpdate () {}\n  static update (id, props, opts) {\n    const op = 'update'\n    this.dbg(op, 'id:', id, 'props:', props, 'opts:', opts)\n    let adapterName\n\n    props || (props = {})\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeUpdate(id, props, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .update(this, id, this.prototype.toJSON.call(props, opts), opts)\n      })\n      .then(data => {\n        return resolve(this.afterUpdate(id, data, opts))\n          .then(() => handleResponse(this, data, opts, adapterName))\n      })\n  }\n  static afterUpdate () {}\n\n  static beforeUpdateMany () {}\n  static updateMany (items, opts) {\n    const op = 'updateMany'\n    this.dbg(op, 'items:', items, 'opts:', opts)\n    let adapterName\n\n    items || (items = [])\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeUpdateMany(items, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .updateMany(this, items.map(item => this.prototype.toJSON.call(item, opts)), opts)\n      })\n      .then(data => {\n        return resolve(this.afterUpdateMany(data, opts))\n          .then(() => handleResponse(this, data, opts, adapterName))\n      })\n  }\n  static afterUpdateMany () {}\n\n  static beforeUpdateAll () {}\n  /**\n   * @param {Object} query={} - Selection query.\n   * @param {Object} props - Update to apply to selected entities.\n   * @param {Object} [opts] - Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   */\n  static updateAll (query, props, opts) {\n    const op = 'updateAll'\n    this.dbg(op, 'query:', query, 'props:', props, 'opts:', opts)\n    let adapterName\n\n    query || (query = {})\n    props || (props = {})\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeUpdateAll(query, props, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .updateAll(this, query, props, opts)\n      })\n      .then(data => {\n        return resolve(this.afterUpdateAll(query, data, opts))\n          .then(() => handleResponse(this, data, opts, adapterName))\n      })\n  }\n  static afterUpdateAll () {}\n\n  static beforeDestroy () {}\n\n  /**\n   * @param {(string|number)} id\n   * @param {Object} [opts] - Configuration options.\n   * @param {boolean} [opts.raw=false] TODO\n   */\n  static destroy (id, opts) {\n    const op = 'destroy'\n    this.dbg(op, 'id:', id, 'opts:', opts)\n    let adapterName\n\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeDestroy(id, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .destroy(this, id, opts)\n      })\n      .then(data => {\n        return resolve(this.afterDestroy(id, opts))\n          .then(() => {\n            if (opts.raw) {\n              data.adapter = adapterName\n              if (opts.autoEject) {\n                data.data = this.eject(id, opts)\n              }\n              return data\n            } else if (opts.autoEject) {\n              data = this.eject(id, opts)\n            }\n            return data\n          })\n      })\n  }\n  static afterDestroy () {}\n\n  static beforeDestroyAll () {}\n  static destroyAll (query, opts) {\n    const op = 'destroyAll'\n    this.dbg(op, 'query:', query, 'opts:', opts)\n    let adapterName\n\n    query || (query = {})\n    opts || (opts = {})\n    utils._(this, opts)\n    opts.op = op\n\n    return resolve(this.beforeDestroyAll(query, opts))\n      .then(() => {\n        adapterName = this.getAdapterName(opts)\n        return this.getAdapter(adapterName)\n          .destroyAll(this, query, opts)\n      })\n      .then(data => {\n        return resolve(this.afterDestroyAll(query, opts))\n          .then(() => {\n            if (opts.raw) {\n              data.adapter = adapterName\n              if (opts.autoEject) {\n                data.data = this.ejectAll(query, opts)\n              }\n              return data\n            } else if (opts.autoEject) {\n              data = this.ejectAll(query, opts)\n            }\n            return data\n          })\n      })\n  }\n  static afterDestroyAll () {}\n\n  static beforeLoadRelations () {}\n  static loadRelations (id, relations, opts) {\n    const _this = this\n    let instance = _this.is(id) ? id : undefined\n    id = instance ? utils.get(instance, _this.idAttribute) : id\n    const op = 'loadRelations'\n    _this.dbg(op, 'id:', id, 'relations:', relations, 'opts:', opts)\n    relations || (relations = [])\n    opts || (opts = {})\n    const relationList = _this.relationList || []\n    utils._(_this, opts)\n    opts.op = op\n    return resolve(_this.beforeLoadRelations(id, relations, opts))\n      .then(() => {\n        if (utils.isSorN(id) && !instance) {\n          instance = _this.get(instance)\n        }\n        if (!instance) {\n          throw new Error('You passed an id of an instance not found in the collection of the Model!')\n        }\n        if (utils.isString(relations)) {\n          relations = [relations]\n        }\n        return Promise.all(relationList.map(function (def) {\n          if (utils.isFunction(def.load)) {\n            return def.load(_this, def, instance, opts)\n          }\n          let task\n          if (def.foreignKey) {\n            task = def.Relation.findAll({\n              [def.foreignKey]: id\n            }, opts)\n          } else if (def.localKey) {\n            const key = utils.get(instance, def.localKey)\n            if (utils.isSorN(key)) {\n              task = def.Relation.find(key, opts)\n            }\n          } else if (def.localKeys) {\n            task = def.Relation.findAll({\n              [def.Relation.idAttribute]: {\n                'in': utils.get(instance, def.localKeys)\n              }\n            }, opts)\n          } else if (def.foreignKeys) {\n            task = def.Relation.findAll({\n              [def.Relation.idAttribute]: {\n                'contains': utils.get(instance, _this.idAttribute)\n              }\n            }, opts)\n          }\n          if (task) {\n            task = task.then(function (data) {\n              if (opts.raw) {\n                data = data.data\n              }\n              utils.set(instance, def.localField, def.type === 'hasOne' ? (data.length ? data[0] : undefined) : data)\n            })\n          }\n          return task\n        }))\n      })\n      .then(() => {\n        return resolve(this.afterLoadRelations(instance, relations, opts))\n          .then(() => instance)\n      })\n  }\n  static afterLoadRelations () {}\n\n  static log (level, ...args) {\n    if (level && !args.length) {\n      args.push(level)\n      level = 'debug'\n    }\n    if (level === 'debug' && !this.debug) {\n      return\n    }\n    const prefix = `${level.toUpperCase()}: (${this.name})`\n    if (console[level]) {\n      console[level](prefix, ...args)\n    } else {\n      console.log(prefix, ...args)\n    }\n  }\n\n  static dbg (...args) {\n    this.log('debug', ...args)\n  }\n\n  /**\n   * Usage:\n   *\n   * Post.belongsTo(User, {\n   *   localKey: 'myUserId'\n   * })\n   *\n   * Comment.belongsTo(User)\n   * Comment.belongsTo(Post, {\n   *   localField: '_post'\n   * })\n   */\n  static belongsTo (model, opts) {\n    return belongsTo(model, opts)(this)\n  }\n\n  /**\n   * Usage:\n   *\n   * User.hasMany(Post, {\n   *   localField: 'my_posts'\n   * })\n   */\n  static hasMany (model, opts) {\n    return hasMany(model, opts)(this)\n  }\n\n  /**\n   * Usage:\n   *\n   * User.hasOne(Profile, {\n   *   localField: '_profile'\n   * })\n   */\n  static hasOne (model, opts) {\n    return hasOne(model, opts)(this)\n  }\n\n  /**\n   * Invoke the {@link module:js-data.exports.setSchema setSchema} decorator on\n   * this Model.\n   * @param {Object} opts - Property configurations.\n   * @return {Model} A reference to the Model for chaining.\n   */\n  static setSchema (opts) {\n    return setSchema(opts)(this)\n  }\n\n  /**\n   * Invoke the {@link module:js-data.exports.configure configure} decorator on\n   * this Model.\n   * @param {Object} opts - Configuration\n   * @return {Model} A reference to the Model for chaining.\n   */\n  static configure (opts) {\n    return configure(opts)(this)\n  }\n\n  /**\n   * Invoke the {@link module:js-data.exports.registerAdapter registerAdapter}\n   * decorator on this Model.\n   * @param {string} name - The name of the adapter to register.\n   * @param {Adapter} adapter - The adapter to register.\n   * @param {Object} [opts] - Configuration options.\n   * @param {boolean} [opts.default=false] - Whether to make the adapter the\n   * default for this Model.\n   * @return {Model} A reference to the Model for chaining.\n   */\n  static registerAdapter (name, adapter, opts) {\n    return registerAdapter(name, adapter, opts)(this)\n  }\n\n  /**\n   * Extend this Model and return a new child Model. Static properties on this\n   * Model will be shallow copied to the child Model. The child Model's\n   * prototype will point to the parent Model.\n   *\n   * @example\n   * var User = JSData.Model.extend({}, { name: 'User' })\n   * @param {Object} props={} - Properties to add to the prototype of the class.\n   * @param {Function} [props.initialize] - Optional function to invoke during\n   * construction of instances of the class. Will receive any arguments passed\n   * to the constructor. \"this\" will refer to the instance being constructed.\n   * @param {Object} classProps - Static properties to add to the class.\n   * @param {string} classProps.name - Name of the class. Required.\n   * @param {string} [classProps.idAttribute='id'] - Field to use as the unique\n   * identifier for instances of the class.\n   * @param {Object} [classProps.schema] - Value to pass to the {@link Model.setSchema setSchema}\n   * method of the class after the class is created.\n   */\n  static extend (props, classProps) {\n    const Parent = this\n    let Child\n\n    Parent.dbg('extend', 'props:', props, 'classProps:', classProps)\n\n    props || (props = {})\n    classProps || (classProps = {})\n\n    const initialize = props.initialize\n    delete props.initialize\n\n    if (props.hasOwnProperty('constructor')) {\n      Child = props.constructor\n      delete props.constructor\n    } else {\n      if (!classProps.name) {\n        throw new TypeError(`name: Expected string, found ${typeof classProps.name}!`)\n      }\n      if (classProps.csp) {\n        Child = function (...args) {\n          babelHelpers.classCallCheck(this, Child)\n          const _this = babelHelpers.possibleConstructorReturn(this, Object.getPrototypeOf(Child).apply(this, args))\n          if (initialize) {\n            initialize.apply(this, args)\n          }\n          return _this\n        }\n      } else {\n        const name = utils.pascalCase(classProps.name)\n        const func = `return function ${name}() {\n                        __callCheck__(this, ${name})\n                        var _this = __possibleConstructorReturn__(this, Object.getPrototypeOf(${name}).apply(this, arguments));\n                        if (initialize) {\n                          initialize.apply(this, arguments)\n                        }\n                        return _this\n                      }`\n        Child = new Function('__callCheck__', '__possibleConstructorReturn__', 'Parent', 'initialize', func)(babelHelpers.classCallCheck, babelHelpers.possibleConstructorReturn, Parent, initialize) // eslint-disable-line\n      }\n    }\n\n    classProps.shortname = classProps.shortname || utils.camelCase(Child.name || classProps.name)\n    delete classProps.name\n\n    const _schema = classProps.schema\n    delete classProps.schema\n\n    babelHelpers.inherits(Child, Parent)\n\n    configure(props)(Child.prototype)\n    configure(classProps)(Child)\n    if (_schema) {\n      setSchema(_schema)(Child)\n    }\n\n    return Child\n  }\n}\n\n// Why are these static properties not up in the Model class declaration?\n// Because JSDoc doesn't parse static property initializers yet. :(\n\n/**\n * @ignore\n */\nModel.__events = {}\n\n/**\n * Create a property where a Model's registered listeners can be stored.\n * @ignore\n */\nObject.defineProperty(Model, '_events', {\n  get () {\n    // Make sure that a Model always has _its own_ set of registered listeners.\n    // This check has to be made because ES6 class inheritance shallow copies\n    // static properties, which means a child model would only have a reference\n    // to the parent model's listeners.\n    if (this.__events === Object.getPrototypeOf(this).__events) {\n      this.__events = {}\n    }\n    return this.__events\n  }\n})\n\n/**\n * @ignore\n */\nModel._adapters = {}\n\n/**\n * Hash of adapters registered with this Model.\n *\n * @name adapters\n * @memberof Model\n * @type {Object}\n */\nObject.defineProperty(Model, 'adapters', {\n  get () {\n    const parentAdapters = Object.getPrototypeOf(this)._adapters\n    // Make sure that a Model always has _its own_ set of registered adapters.\n    // This check has to be made because ES6 class inheritance shallow copies\n    // static properties, which means a child model would only have a reference\n    // to the parent model's adapters.\n    if (this._adapters === parentAdapters) {\n      this._adapters = {}\n      utils.fillIn(this._adapters, parentAdapters)\n    }\n    return this._adapters\n  }\n})\n\n/**\n * @ignore\n */\nModel._collection = new Collection([], 'id')\n\n/**\n * This Model's {@link Collection} instance. This is where instances of the\n * Model are stored if {@link Model.autoInject} is `true`.\n *\n * __You should use {@link Model.inject}, {@link Model.eject}, and\n * {@link Model.ejectAll} if you need to manually get data in and out of this\n * collection.__\n *\n * @name collection\n * @memberof Model\n * @type {Collection}\n */\nObject.defineProperty(Model, 'collection', {\n  get () {\n    // Make sure that a Model always has _its own_ collection. This check has to\n    // be made because ES6 class inheritance shallow copies static properties,\n    // which means a child Model would only have a reference to the parent\n    // Model's collection.\n    if (this._collection === Object.getPrototypeOf(this)._collection) {\n      this._collection = new Collection([], this.idAttribute)\n      this._collection.on('all', this.emit, this)\n    }\n    return this._collection\n  }\n})\n\n/**\n * Whether {@link Model.destroy} and {@link Model.destroyAll} should\n * automatically eject the specified item(s) from the Model's collection on\n * success.\n *\n * @memberof Model\n * @type {boolean}\n * @default true\n */\nModel.autoEject = true\n\n/**\n * Whether {@link Model.create}, {@link Model.createMany},\n * {@link Model.update}, {@link Model.updateAll}, and {@link Model.updateMany}\n * should automatically inject the specified item(s) returned by the adapter\n * into the the Model's collection on success.\n *\n * __Defaults to `true` in the Browser.__\n *\n * __Defaults to `false` in Node.js__\n *\n * @memberof Model\n * @type {boolean}\n */\nModel.autoInject = isBrowser\nModel.bypassCache = false\n\n/**\n * Whether to disallow the use of `new Function` in {@link Model.extend}.\n *\n * You may set this to `true` if you so desire, but the class (constructor\n * function) produced by {@link Model.extend} will not be a named function,\n * which makes for slightly less debuggability.\n *\n * @memberof Model\n * @type {boolean}\n * @default false\n */\nModel.csp = false\n\n/**\n * The name of the registered adapter that should be used by default by any\n * of the Model's static methods that use an adapter.\n *\n * @memberof Model\n * @type {string}\n * @default http\n */\nModel.defaultAdapter = 'http'\n\n/**\n * Whether to enable debug-level logs.\n *\n * @memberof Model\n * @type {boolean}\n * @default false\n */\nModel.debug = false\nModel.eagerEject = false\n\n/**\n * The field on instances of {@link Model} that should be used as the unique\n * identifier for instances of the Model.\n *\n * @memberof Model\n * @type {string}\n * @default id\n */\nModel.idAttribute = 'id'\n\n/**\n * Whether to add property accessors to the prototype of {@link Model} for\n * each of the Model's relations. For each relation, the property accessor\n * will be added as the field specified by the `localField` option of the\n * relation definition. A relation property accessor returns related data by\n * accessing the related Model. If the related Model's collection is empty,\n * then the property accessors won't return anything.\n *\n * __Defaults to `true` in the Browser.__\n *\n * __Defaults to `false` in Node.js__\n *\n * @memberof Model\n * @type {boolean}\n */\nModel.linkRelations = isBrowser\n\n/**\n * What to do when injecting an item into the Model's collection that shares a\n * primary key with an item already in the Model's collection.\n *\n * Possible values:\n * - merge\n * - replace\n *\n * Merge:\n *\n * Recursively shallow copy properties from the new item onto the existing\n * item.\n *\n * Replace:\n *\n * Shallow copy top-level properties from the new item onto the existing item.\n * Any top-level own properties of the existing item that are _not_ on the new\n * item will be removed.\n *\n * @memberof Model\n * @type {string}\n * @default merge\n */\nModel.onConflict = 'merge'\n\n/**\n * Whether the relation property accessors should be enumerable. It's\n * recommended that this stay false.\n *\n * @memberof Model\n * @type {boolean}\n * @default false\n */\nModel.relationsEnumerable = false\n\n/**\n * Whether {@link Model.create}, {@link Model.createMany},\n * {@link Model.update}, {@link Model.updateAll}, {@link Model.updateMany},\n * {@link Model.find}, {@link Model.findAll}, {@link Model.destroy}, and\n * {@link Model.destroyAll} should return a raw result object that contains\n * both the instance data returned by the adapter _and_ metadata about the\n * operation.\n *\n * The default is to NOT return the result object, and instead return just the\n * instance data.\n *\n * @memberof Model\n * @type {boolean}\n * @default false\n */\nModel.raw = false\n\n/**\n * Whether {@link Model.create}, {@link Model.createMany},\n * {@link Model.update}, {@link Model.updateAll}, {@link Model.updateMany},\n * {@link Model.find}, {@link Model.findAll}, {@link Model.destroy}, and\n * {@link Model.destroyAll} should return a raw result object that contains\n * both the instance data returned by the adapter _and_ metadata about the\n * operation.\n *\n * The default is to NOT return the result object, and instead return just the\n * instance data.\n *\n * @memberof Model\n * @type {boolean}\n * @default false\n */\nModel.upsert = true\n\n/**\n * Allow Models themselves emit events. Any events emitted on a Model's\n * collection will also be emitted on the Model itself.\n *\n * A Model's registered listeners are stored on the Model's `__events` property.\n */\nutils.eventify(\n  Model,\n  function () {\n    return this._events\n  },\n  function (value) {\n    this._events = value\n  }\n)\n\n/**\n * Allow instancess to emit events. Any events emitted instances in a Model's\n * collection will also be emitted on the collection itself, and hence, on the\n * Model as well.\n *\n * An instance's registered listeners are stored in the instance's private data\n * hash.\n */\nutils.eventify(\n  Model.prototype,\n  function () {\n    return this._get('events')\n  },\n  function (value) {\n    this._set('events', value)\n  }\n)\n","/* jshint eqeqeq:false */\nimport {fillIn, forOwn, isFunction} from '../utils.js'\nimport {Model} from '../model/index.js'\n\n// function lifecycleNoopCb (resource, attrs, cb) {\n//   cb(null, attrs)\n// }\n\n// function lifecycleNoop (resource, attrs) {\n//   return attrs\n// }\n\n// class Defaults {\n//   errorFn (a, b) {\n//     if (this.error && typeof this.error === 'function') {\n//       try {\n//         if (typeof a === 'string') {\n//           throw new Error(a)\n//         } else {\n//           throw a\n//         }\n//       } catch (err) {\n//         a = err\n//       }\n//       this.error(this.name || null, a || null, b || null)\n//     }\n//   }\n// }\n\n// var defaultsPrototype = Defaults.prototype\n\n// defaultsPrototype.actions = {}\n// defaultsPrototype.afterCreate = lifecycleNoopCb\n// defaultsPrototype.afterCreateCollection = lifecycleNoop\n// defaultsPrototype.afterCreateInstance = lifecycleNoop\n// defaultsPrototype.afterDestroy = lifecycleNoopCb\n// defaultsPrototype.afterEject = lifecycleNoop\n// defaultsPrototype.afterFind = lifecycleNoopCb\n// defaultsPrototype.afterFindAll = lifecycleNoopCb\n// defaultsPrototype.afterInject = lifecycleNoop\n// defaultsPrototype.afterLoadRelations = lifecycleNoopCb\n// defaultsPrototype.afterReap = lifecycleNoop\n// defaultsPrototype.afterUpdate = lifecycleNoopCb\n// defaultsPrototype.afterValidate = lifecycleNoopCb\n// defaultsPrototype.allowSimpleWhere = true\n// defaultsPrototype.basePath = ''\n// defaultsPrototype.beforeCreate = lifecycleNoopCb\n// defaultsPrototype.beforeCreateCollection = lifecycleNoop\n// defaultsPrototype.beforeCreateInstance = lifecycleNoop\n// defaultsPrototype.beforeDestroy = lifecycleNoopCb\n// defaultsPrototype.beforeEject = lifecycleNoop\n// defaultsPrototype.beforeInject = lifecycleNoop\n// defaultsPrototype.beforeReap = lifecycleNoop\n// defaultsPrototype.beforeUpdate = lifecycleNoopCb\n// defaultsPrototype.beforeValidate = lifecycleNoopCb\n// defaultsPrototype.bypassCache = false\n// defaultsPrototype.cacheResponse = !!DSUtils.w\n// defaultsPrototype.csp = false\n// defaultsPrototype.clearEmptyQueries = true\n// defaultsPrototype.computed = {}\n// defaultsPrototype.defaultAdapter = 'http'\n// defaultsPrototype.debug = false\n// defaultsPrototype.defaultValues = {}\n// defaultsPrototype.eagerEject = false\n// // TODO: Implement eagerInject in DS#create\n// defaultsPrototype.eagerInject = false\n// defaultsPrototype.endpoint = ''\n// defaultsPrototype.error = console ? (a, b, c) => console[typeof console.error === 'function' ? 'error' : 'log'](a, b, c) : false\n// defaultsPrototype.errorHandler = function (...args) {\n//   return DSUtils.Promise.reject(args[0])\n// }\n// defaultsPrototype.fallbackAdapters = ['http']\n// defaultsPrototype.findStrictCache = false\n// defaultsPrototype.idAttribute = 'id'\n// defaultsPrototype.ignoredChanges = [/\\$/]\n// defaultsPrototype.instanceEvents = !!DSUtils.w\n// defaultsPrototype.keepChangeHistory = false\n// defaultsPrototype.linkRelations = !!DSUtils.w\n// defaultsPrototype.log = console ? (a, b, c, d, e) => console[typeof console.info === 'function' ? 'info' : 'log'](a, b, c, d, e) : false\n\n// defaultsPrototype.logFn = function (a, b, c, d) {\n//   let _this = this\n//   if (_this.debug && _this.log && typeof _this.log === 'function') {\n//     _this.log(_this.name || null, a || null, b || null, c || null, d || null)\n//   }\n// }\n\n// defaultsPrototype.maxAge = false\n// defaultsPrototype.methods = {}\n// defaultsPrototype.notify = !!DSUtils.w\n// defaultsPrototype.omit = []\n// defaultsPrototype.onConflict = 'merge'\n// defaultsPrototype.reapAction = DSUtils.w ? 'inject' : 'none'\n// defaultsPrototype.reapInterval = DSUtils.w ? 30000 : false\n// defaultsPrototype.relationsEnumerable = false\n// defaultsPrototype.resetHistoryOnInject = true\n// defaultsPrototype.returnMeta = false\n// defaultsPrototype.scopes = {}\n// defaultsPrototype.strategy = 'single'\n// defaultsPrototype.upsert = !!DSUtils.w\n// defaultsPrototype.useClass = true\n// defaultsPrototype.useFilter = false\n// defaultsPrototype.validate = lifecycleNoopCb\n// defaultsPrototype.watchChanges = !!DSUtils.w\n\n// class _DS {\n//   constructor (options) {\n//     let _this = this\n//     options = options || {}\n\n//     _this.store = {}\n//     _this.definitions = {}\n//     _this.adapters = {}\n//     _this.defaults = new Defaults()\n//     _this.observe = DSUtils.observe\n//     DSUtils.forOwn(options, function (v, k) {\n//       if (k === 'omit') {\n//         _this.defaults.omit = v.concat(Defaults.prototype.omit)\n//       } else {\n//         _this.defaults[k] = v\n//       }\n//     })\n//     _this.defaults.logFn('new data store created', _this.defaults)\n\n//     DSUtils.Events(_this)\n//   }\n\n//   getAdapterName (options) {\n//     let errorIfNotExist = false\n//     options = options || {}\n//     this.defaults.logFn('getAdapterName', options)\n//     if (DSUtils._s(options)) {\n//       errorIfNotExist = true\n//       options = {\n//         adapter: options\n//       }\n//     }\n//     if (this.adapters[options.adapter]) {\n//       return options.adapter\n//     } else if (errorIfNotExist) {\n//       throw new Error(`${options.adapter} is not a registered adapter!`)\n//     } else {\n//       return options.defaultAdapter\n//     }\n//   }\n\n//   getAdapter (options) {\n//     options = options || {}\n//     this.defaults.logFn('getAdapter', options)\n//     return this.adapters[this.getAdapterName(options)]\n//   }\n\n//   registerAdapter (name, Adapter, options) {\n//     let _this = this\n//     options = options || {}\n//     _this.defaults.logFn('registerAdapter', name, Adapter, options)\n//     if (DSUtils.isFunction(Adapter)) {\n//       _this.adapters[name] = new Adapter(options)\n//     } else {\n//       _this.adapters[name] = Adapter\n//     }\n//     if (options.default) {\n//       _this.defaults.defaultAdapter = name\n//     }\n//     _this.defaults.logFn(`default adapter is ${_this.defaults.defaultAdapter}`)\n//   }\n\n//   errorFn (...args) {\n//     let options = args[args.length - 1]\n//     let defaultHandler = this.defaults.errorHandler\n//     let errorHandler = options ? options.errorHandler : defaultHandler\n//     errorHandler = errorHandler || defaultHandler\n//     return function (err) {\n//       return errorHandler(err, ...args)\n//     }\n//   }\n// }\n\n// var dsPrototype = _DS.prototype\n\n// dsPrototype.getAdapterName.shorthand = false\n// dsPrototype.getAdapter.shorthand = false\n// dsPrototype.registerAdapter.shorthand = false\n// dsPrototype.errors = DSErrors\n// dsPrototype.utils = DSUtils\n\nexport function DS (opts) {\n  opts || (opts = {})\n  this.definitions = {}\n}\n\nfillIn(DS.prototype, {\n  clear () {\n    const ejected = {}\n    forOwn(this.definitions, definition => {\n      const name = definition.name\n      ejected[name] = definition.ejectAll()\n    })\n    return ejected\n  },\n\n  defineModel (opts) {\n    const Child = Model.extend(opts.methods || {}, opts)\n    this.definitions[Child.name] = Child\n    return Child\n  }\n})\n\nDS.prototype.defineResource = DS.prototype.defineModel\n\nforOwn(Model, function (value, key) {\n  if (isFunction(value)) {\n    DS.prototype[key] = function (name, ...args) {\n      if (!this.definitions[name]) {\n        throw new Error(`${name} is not a registered Model!`)\n      }\n      return this.definitions[name][key](...args)\n    }\n  }\n})\n","/**\n * Registered as `js-data` in NPM and Bower.\n * #### Script tag\n * ```js\n * window.JSData\n * ```\n * #### CommonJS\n * ```js\n * var JSData = require('js-data')\n * ```\n * #### ES6 Modules\n * ```js\n * import JSData from 'js-data'\n * ```\n * #### AMD\n * ```js\n * define('myApp', ['js-data'], function (JSData) { ... })\n * ```\n *\n * @module js-data\n * @property {Function} belongsTo - {@link module:js-data.exports.belongsTo belongsTo}\n * decorator function.\n * @property {Function} configure - {@link module:js-data.exports.configure configure}\n * decorator function.\n * @property {Function} Collection - {@link Collection} class.\n * @property {Function} DS - {@link DS} class.\n * @property {Function} hasMany - {@link module:js-data.exports.hasMany hasMany}\n * decorator function.\n * @property {Function} hasOne - {@link module:js-data.exports.hasOne hasOne}\n * decorator function.\n * @property {Function} initialize - {@link module:js-data.exports.initialize initialize}\n * decorator function.\n * @property {Function} Model - {@link Model} class.\n * @property {Function} registerAdapter - {@link registerAdapter} decorator\n * function.\n * @property {Function} setSchema - {@link setSchema} decorator function.\n * @property {Function} Query - {@link Query} class.\n * @property {Object} utils - Utility methods used by the `js-data` module. See\n * {@link module:js-data.module:utils utils}.\n * @property {Object} version - Details of the current version of the `js-data`\n * module.\n * @property {string} version.full - The full semver value.\n * @property {number} version.major - The major version number.\n * @property {number} version.minor - The minor version number.\n * @property {number} version.patch - The patch version number.\n * @property {(string|boolean)} version.alpha - The alpha version value,\n * otherwise `false` if the current version is not alpha.\n * @property {(string|boolean)} version.beta - The beta version value,\n * otherwise `false` if the current version is not beta.\n */\n\nif (!Promise.prototype.spread) {\n  Promise.prototype.spread = function (cb) {\n    return this.then(function (arr) {\n      return cb.apply(this, arr)\n    })\n  }\n}\n\nexport * from './collection/index.js'\nexport * from './datastore/index.js'\n\nexport * from './decorators/index.js'\nexport * from './model/index.js'\nexport * from './validate/index.js'\nimport * as _utils from './utils.js'\nexport const utils = _utils\n\nexport const version = {\n  full: '<%= pkg.version %>',\n  major: parseInt('<%= major %>', 10),\n  minor: parseInt('<%= minor %>', 10),\n  patch: parseInt('<%= patch %>', 10),\n  alpha: '<%= alpha %>' !== 'false' ? '<%= alpha %>' : false,\n  beta: '<%= beta %>' !== 'false' ? '<%= beta %>' : false\n}\n"],"names":["set","resolve","op","get","_get","utils.resolve","utils.get","utils.set","utils.unset","utils.fillIn","utils.copy","validate","utils.isString","_validate.validate","utils.forOwn","utils.isArray","utils.isSorN","utils.uuid","utils.isFunction","utils.deepMixIn","utils._","belongsTo","_belongsTo","hasMany","_hasMany","hasOne","_hasOne","setSchema","_setSchema","configure","_configure","registerAdapter","_registerAdapter","utils.pascalCase","utils.camelCase","utils.eventify"],"mappings":"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"}