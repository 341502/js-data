/*!
* js-data
* @version 2.8.2 - Homepage <http://www.js-data.io/>
* @author Jason Dobry <jason.dobry@gmail.com>
* @copyright (c) 2014-2015 Jason Dobry
* @license MIT <https://github.com/js-data/js-data/blob/master/LICENSE>
*
* @overview Robust framework-agnostic data store.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JSData=t():e.JSData=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})};for(var o in r){i(o)}t.version={full:"<%= pkg.version %>",major:parseInt("<%= major %>",10),minor:parseInt("<%= minor %>",10),patch:parseInt("<%= patch %>",10),alpha:"<%= alpha %>",beta:"<%= beta %>"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})};for(var o in r){i(o)}var u=n(7),a=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})};for(var s in u){a(s)}var l=n(8),c=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})};for(var f in l){c(f)}t.CORE="FIXME"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})};for(var o in r){i(o)}var u=n(5),a=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})};for(var s in u){a(s)}var l=n(6),c=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})};for(var f in l){c(f)}t.DECORATORS="FIXME"},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,t){if(!e||!(0,u.isString)(e))throw new TypeError("action(name[, opts]): Expected: string, Found: "+("undefined"==typeof e?"undefined":r(e)));return function(n){if(n[e])throw new Error("action(name[, opts]): "+e+" already exists on target!");return t.request=t.request||function(e){return e},t.response=t.response||function(e){return e},t.responseError=t.responseError||function(e){return(0,u.reject)(e)},n[e]=function(n,r){(0,u.isObject)(n)&&(r=n),r=r||{};var i=this.getAdapter(t.adapter||this.defaultAdapter||"http"),o={};if((0,u.fillIn)(o,t),!r.hasOwnProperty("endpoint")&&o.endpoint&&(r.endpoint=o.endpoint),"function"==typeof r.getEndpoint)o.url=r.getEndpoint(this,r);else{var s=[r.basePath||this.basePath||i.defaults.basePath,i.getEndpoint(this,(0,u.isSorN)(n)?n:null,r)];(0,u.isSorN)(n)&&s.push(n),s.push(t.pathname||e),o.url=u.makePath.apply(null,s)}return o.method=o.method||"GET",o.resourceName=this.name,(0,a.configure)(o)(r),(0,u.resolve)(o).then(r.request||t.request).then(function(e){return i.HTTP(e)}).then(function(e){return e&&e.config&&(e.config.resourceName=this.name),e}).then(r.response||t.response,r.responseError||t.responseError)},n}}function o(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(e){return(0,u.forOwn)(e,function(t,n){i(n,t)(e)}),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.action=i,t.actions=o;var u=n(4),a=n(5)},function(e,t){"use strict";function n(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function r(e,t,n){var r=Object.keys(e),i=r.length,o=void 0;for(o=0;i>o;o++)t.call(n,e[r[o]],r[o],e)}function i(e){return"[object RegExp]"===toString.call(e)||!1}function o(e){return"string"==typeof e||e&&"object"===("undefined"==typeof e?"undefined":n(e))&&"[object String]"===toString.call(e)||!1}function u(e){return"[object Object]"===toString.call(e)||!1}function a(e){return e&&"object"===("undefined"==typeof e?"undefined":n(e))&&"[object Date]"===toString.call(e)||!1}function s(e){var t="undefined"==typeof e?"undefined":n(e);return"number"===t||e&&"object"===t&&"[object Number]"===toString.call(e)||!1}function l(e){return"function"==typeof e||e&&"[object Function]"===toString.call(e)||!1}function c(e){return o(e)||s(e)}function f(e){return Promise.resolve(e)}function d(e){return Promise.reject(e)}function h(e){return null!=e&&""!==e}function v(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return e.filter(h).join(t)}function g(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var r=v(t,"/");return r.replace(/([^:\/]|^)\/{2,}/g,"$1/")}function p(e,t){r(t,function(t,n){void 0===e[n]&&(e[n]=t)})}function y(e,t){if(!t||!t.length)return!1;for(var n=void 0,r=0;r<t.length;r++)if("[object RegExp]"===Object.prototype.toString.call(t[r])&&t[r].test(e)||t[r]===e)return n=e;return!!n}function m(e,t){var n=[];return r(e,function(e,r){y(r,t)&&n.push(r)}),n.forEach(function(t){delete e[t]}),e}function b(e){return o(e)?JSON.parse(e):e}function x(e,t,n,o,s){if(t){if(e===t)throw new Error("Cannot copy! Source and destination are identical.");if(n=n||[],o=o||[],u(e)){var l=n.indexOf(e);if(-1!==l)return o[l];n.push(e),o.push(t)}var c=void 0;if(k(e)){var f=void 0;for(t.length=0,f=0;f<e.length;f++)c=x(e[f],null,n,o,s),u(e[f])&&(n.push(e[f]),o.push(c)),t.push(c)}else{k(t)?t.length=0:r(t,function(e,n){delete t[n]});for(var d in e)if(e.hasOwnProperty(d)){if(y(d,s))continue;c=x(e[d],null,n,o,s),u(e[d])&&(n.push(e[d]),o.push(c)),t[d]=c}}}else t=e,e&&(k(e)?t=x(e,[],n,o,s):a(e)?t=new Date(e.getTime()):i(e)?(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex):u(e)&&(t=x(e,Object.create(Object.getPrototypeOf(e)),n,o,s)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.forOwn=r,t.isRegExp=i,t.isString=o,t.isObject=u,t.isDate=a,t.isNumber=s,t.isFunction=l,t.isSorN=c,t.resolve=f,t.reject=d,t.makePath=g,t.fillIn=p,t.isBlacklisted=y,t.omit=m,t.fromJson=b,t.copy=x;var k=t.isArray=Array.isArray;t.toJson=JSON.stringify},function(e,t,n){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(t){return(0,i.forOwn)(e,function(e,n){t[n]=(0,i.copy)(e)}),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.configure=r;var i=n(4)},function(e,t,n){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(t){return(0,i.forOwn)(e,function(e,n){var r={enumerable:void 0!==e.enumerable?e.enumerable:!0,writable:e.writable?e.writable:!0,configurable:e.configurable?e.configurable:!1};e.get&&(r.writable=!1,r.get=e.get),e.set&&(r.writable=!1,r.set=e.set),Object.defineProperty(t.prototype,n,r)}),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.schema=r;var i=n(4)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return function(n){var r=t.localField||e.name.toLowerCase(),i=t.localKey||e.name.toLowerCase()+"_id",o={enumerable:void 0!==t.enumerable?!!t.enumerable:!1,get:function(){return e.get(this[i])},set:function(t){this[i]=t[e.idAttribute]}};return(t.link===!1||void 0===t.link&&!n.linkRelations)&&(delete o.get,delete o.set),t.get&&!function(){var r=o.get;o.get=function(){var i=this;return t.get(n,e,this,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(i,t)}:void 0)}}(),t.set&&!function(){var r=o.set;o.set=function(i){var o=this;return t.set(n,e,this,i,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(o,t)}:void 0)}}(),Object.defineProperty(n.prototype,r,o),n}}function l(e){e.$$index={},e.$$collection=[]}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=t.belongsTo=void 0;var f=n(4),d=r(f),h=n(2),v=n(8),g=!1;try{g=!!window}catch(e){}t.belongsTo=s;var p=function e(){a(this,e)},y=t.Resource=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];a(this,t);var n=o(this,Object.getPrototypeOf(t).call(this));return(0,h.configure)(e)(n),Object.defineProperty(n,"$$props",{value:{}}),n}return u(t,e),c(t,null,[{key:"data",value:function(){throw new Error(this.name+": Did you forget to define a schema?")}},{key:"createIndex",value:function(e){this.data().createIndex(e,this.idAttribute)}},{key:"createInstance",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this;return e instanceof t?e:new t(e)}},{key:"inject",value:function(e){var t=this,n=!1;return d.isArray(e)?e=e.map(this.createInstance):(n=!0,e=[this.createInstance(e)]),e.forEach(function(e){t.data().get(e[t.idAttribute]).length||t.data().insertRecord(e)}),n?e[0]:e}},{key:"get",value:function(e){var t=this.data().get(e);return t.length?t[0]:void 0}},{key:"belongsTo",value:function(e,t){return s(e,t)(this)}},{key:"action",value:function(e,t){return(0,h.action)(e,t)(this)}},{key:"actions",value:function(e){return(0,h.actions)(e)(this)}},{key:"schema",value:function(e){return(0,h.schema)(e)(this)}},{key:"configure",value:function(e){return(0,h.configure)(e)(this)}},{key:"extend",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=void 0,r=this;if(t.csp)n=function(e){a(this,n),r.call(this,e)};else{var o=t.name,s="return function "+o+"(props) {\n                    _classCallCheck(this, "+o+")\n                    Parent.call(this, props)\n                  }";n=new Function("_classCallCheck","Parent",s)(a,r)}u(n,this),(0,h.configure)(e)(n.prototype),(0,h.configure)(t)(n),(0,h.schema)(i({},n.idAttribute,{}))(n);var l=new v.Collection([],n.idAttribute);return Object.defineProperty(n,"getCollection",{value:function(){if(this.__proto__.data===this.prototype.constructor.data)throw new Error(this.name+": Schemas are not inheritable, did you forget to define a schema?");return l}}),n}}]),t}(p);l(y),(0,h.configure)({autoInject:g,bypassCache:!1,csp:!1,defaultAdapter:"http",eagerEject:!1,idAttribute:"id",linkRelations:g,relationsEnumerable:!1,returnMeta:!1,strategy:"single",useFilter:!0})(y)},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var u=n(4),a=n(9),s=function(){function e(t){i(this,e),this.collection=t}return o(e,[{key:"getData",value:function(){return this.data||(this.data=this.collection.index.getAll()),this.data}},{key:"between",value:function(e,t,n){var r=this.collection,i=n.index?r.indexes[n.index]:r.index;if(this.data)throw new Error("Cannot access index after first operation!");return this.data=i.between(e,t,n),this}},{key:"getAll",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(this.data)throw new Error("Cannot access index after first operation!");if(!e.length)return this.getData(),this;var n=this.collection,r=t.index?n.indexes[t.index]:n.index;return this.data=r.get(e),this}},{key:"filter",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return console.log("filter",e,this.getData().length),this}},{key:"skip",value:function(e){if(!(0,u.isNumber)(e))throw new TypeError("skip: Expected number but found "+("undefined"==typeof e?"undefined":r(e))+"!");var t=this.getData();return e<t.length?this.data=t.slice(e):this.data=[],this}},{key:"limit",value:function(e){if(!(0,u.isNumber)(e))throw new TypeError("limit: Expected number but found "+("undefined"==typeof e?"undefined":r(e))+"!");var t=this.getData();return this.data=t.slice(0,Math.min(t.length,e)),this}},{key:"forEach",value:function(e,t){return this.getData().forEach(e,t),this}},{key:"map",value:function(e,t){return this.data=this.getData().map(e,t),this}},{key:"run",value:function(){var e=this.data;return this.data=null,e}}]),e}();t.Collection=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments.length<=1||void 0===arguments[1]?"id":arguments[1];if(i(this,e),!(0,u.isArray)(t))throw new TypeError("new Collection([data]): data: Expected array. Found "+("undefined"==typeof t?"undefined":r(t)));this.idAttribute=n,this.index=new a.Index([n],n),this.indexes={},t.forEach(this.index.insertRecord,this.index)}return o(e,[{key:"createIndex",value:function(e,t,n){var r=this.indexes[e]=new a.Index(t,n);return this.index.visitAll(r.insertRecord,r),this}},{key:"query",value:function(){return new s(this)}},{key:"between",value:function(){var e;return(e=this.query()).between.apply(e,arguments).run()}},{key:"getAll",value:function(){var e;return(e=this.query()).getAll.apply(e,arguments).run()}},{key:"filter",value:function(e){return this.query().filter(e).run()}},{key:"skip",value:function(e){return this.query().skip(e).run()}},{key:"limit",value:function(e){return this.query().limit(e).run()}},{key:"forEach",value:function(e,t){this.index.visitAll(e,t)}},{key:"map",value:function(e,t){var n=[];return this.index.visitAll(function(r){n.push(e.call(t,r))}),n}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Index=void 0;var o=n(4),u=n(10),a=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments[1];if(r(this,e),!(0,o.isArray)(t))throw new Error("fieldList must be an array.");this.fieldList=t,this.idAttribute=n,this.isIndex=!0,this.keys=[],this.values=[]}return i(e,[{key:"set",value:function(t,n){(0,o.isArray)(t)||(t=[t]);var r=t.shift()||null,i=(0,u.binarySearch)(this.keys,r);if(0===t.length)if(i.found){var a=(0,u.binarySearch)(this.values[i.index],n,this.idAttribute);a.found||(0,u.insertAt)(this.values[i.index],a.index,n)}else(0,u.insertAt)(this.keys,i.index,r),(0,u.insertAt)(this.values,i.index,[n]);else if(i.found)this.values[i.index].set(t,n);else{(0,u.insertAt)(this.keys,i.index,r);var s=new e;s.set(t,n),(0,u.insertAt)(this.values,i.index,s)}}},{key:"get",value:function(e){(0,o.isArray)(e)||(e=[e]);var t=e.shift()||null,n=(0,u.binarySearch)(this.keys,t);return 0===e.length?n.found?this.values[n.index].isIndex?this.values[n.index].getAll():this.values[n.index]:[]:n.found?this.values[n.index].get(e):[]}},{key:"getAll",value:function(){var e=[];return this.values.forEach(function(t){e=t.isIndex?e.concat(t.getAll()):e.concat(t)}),e}},{key:"visitAll",value:function(e,t){this.values.forEach(function(n){n.isIndex?n.visitAll(e,t):n.forEach(e,t)})}},{key:"query",value:function(e){var t=void 0,n=void 0;if(e[">"]?(t=e[">"],e.leftInclusive=!1):e[">="]&&(t=e[">="],e.leftInclusive=!0),e["<"]?(n=e["<"],e.rightInclusive=!1):e["<="]&&(n=e["<="],e.rightInclusive=!0),t.length!==n.length)throw new Error("Key arrays must be same length");return this.between(t,n,(0,o.omit)(e,[">",">=","<","<="]))}},{key:"between",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,o.isArray)(e)||(e=[e]),(0,o.isArray)(t)||(t=[t]),(0,o.fillIn)(n,{leftInclusive:!0,rightInclusive:!1,limit:void 0,offset:0});var r=this._between(e,t,n);return n.limit?r.slice(n.offset,n.limit+n.offset):r.slice(n.offset)}},{key:"_between",value:function(e,t,n){var r=[],i=e.shift(),a=t.shift(),s=void 0;if(s=void 0!==i?(0,u.binarySearch)(this.keys,i):{found:!1,index:0},0===e.length){s.found&&n.leftInclusive===!1&&(s.index+=1);for(var l=s.index;l<this.keys.length;l+=1){if(void 0!==a)if(n.rightInclusive){if(this.keys[l]>a)break}else if(this.keys[l]>=a)break;if(r=this.values[l].isIndex?r.concat(this.values[l].getAll()):r.concat(this.values[l]),n.limit&&r.length>=n.limit+n.offset)break}}else for(var l=s.index;l<this.keys.length;l+=1){var c=this.keys[l];if(c>a)break;if(r=this.values[l].isIndex?c===i?r.concat(this.values[l]._between((0,o.copy)(e),t.map(function(){}),n)):c===a?r.concat(this.values[l]._between(e.map(function(){}),(0,o.copy)(t),n)):r.concat(this.values[l].getAll()):r.concat(this.values[l]),n.limit&&r.length>=n.limit+n.offset)break}return n.limit?r.slice(0,n.limit+n.offset):r}},{key:"remove",value:function(e,t){(0,o.isArray)(e)||(e=[e]);var n=e.shift(),r=(0,u.binarySearch)(this.keys,n);if(0===e.length){if(r.found){var i=(0,u.binarySearch)(this.values[r.index],t,this.idAttribute);i.found&&((0,u.removeAt)(this.values[r.index],i.index),0===this.values[r.index].length&&((0,u.removeAt)(this.keys,r.index),(0,u.removeAt)(this.values,r.index)))}}else r.found&&this.values[r.index].delete(e,t)}},{key:"clear",value:function(){this.keys=[],this.values=[]}},{key:"insertRecord",value:function(e){var t=this.fieldList.map(function(t){return e[t]||null});this.set(t,e)}},{key:"removeRecord",value:function(e){var t=this.fieldList.map(function(t){return e[t]||null});this.remove(t,e)}},{key:"updateRecord",value:function(e){this.removeRecord(e),this.insertRecord(e)}}]),e}();t.Index=a},function(e,t){"use strict";function n(e,t,n){return e===t?0:(n&&(e=e[n],t=t[n]),null===e&&null===t?0:null===e?-1:null===t?1:t>e?-1:e>t?1:0)}function r(e,t,n){return e.splice(t,0,n),e}function i(e,t){return e.splice(t,1),e}function o(e,t,r){for(var i=0,o=e.length,u=void 0,a=void 0;o>i;){if(a=(i+o)/2|0,u=n(t,e[a],r),0===u)return{found:!0,index:a};0>u?o=a:i=a+1}return{found:!1,index:o}}Object.defineProperty(t,"__esModule",{value:!0}),t.sort=n,t.insertAt=r,t.removeAt=i,t.binarySearch=o}])});
//# sourceMappingURL=dist/js-data.min.map