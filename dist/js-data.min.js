/*!
* js-data
* @version 2.8.2 - Homepage <http://www.js-data.io/>
* @author Jason Dobry <jason.dobry@gmail.com>
* @copyright (c) 2014-2015 Jason Dobry
* @license MIT <https://github.com/js-data/js-data/blob/master/LICENSE>
*
* @overview Robust framework-agnostic data store.
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JSData=t():e.JSData=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})};for(var u in r){i(u)}var a=n(13),o=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})};for(var s in a){o(s)}var c=n(4),f=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})};for(var l in c){f(l)}var d=n(14),h=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})};for(var g in d){h(g)}Promise.prototype.spread||(Promise.prototype.spread=function(e){return this.then(function(t){return e.apply(this,t)})});t.version={full:"<%= pkg.version %>",major:parseInt("<%= major %>",10),minor:parseInt("<%= minor %>",10),patch:parseInt("<%= patch %>",10),alpha:"<%= alpha %>",beta:"<%= beta %>"}},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments.length<=1||void 0===arguments[1]?"id":arguments[1];if(!(0,a.isArray)(e))throw new TypeError("new Collection([data]): data: Expected array. Found "+("undefined"==typeof e?"undefined":r(e)));this.idAttribute=t,this.index=new s.Index([t],t),this.indexes={},e.forEach(this.index.insertRecord,this.index)}Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=i;var u=n(2),a=n(3),o=n(4),s=n(11);t.Query=u.Query,(0,o.configure)({createIndex:function(e,t){(0,a.isString)(e)&&void 0===t&&(t=[e]);var n=this.indexes[e]=new s.Index(t,this.idAttribute);return this.index.visitAll(n.insertRecord,n),this},query:function(){return new u.Query(this)},between:function(){var e;return(e=this.query()).between.apply(e,arguments).run()},get:function(){var e;return(e=this.query()).get.apply(e,arguments).run()},getAll:function(){var e;return(e=this.query()).getAll.apply(e,arguments).run()},filter:function(e){return this.query().filter(e).run()},skip:function(e){return this.query().skip(e).run()},limit:function(e){return this.query().limit(e).run()},forEach:function(e,t){this.index.visitAll(e,t)},map:function(e,t){var n=[];return this.index.visitAll(function(r){n.push(e.call(t,r))}),n},insert:function(e){this.index.insertRecord(e),(0,a.forOwn)(this.indexes,function(t,n){t.insertRecord(e)})},update:function(e){this.index.updateRecord(e),(0,a.forOwn)(this.indexes,function(t,n){t.updateRecord(e)})},remove:function(e){this.index.removeRecord(e),(0,a.forOwn)(this.indexes,function(t,n){t.removeRecord(e)})},insertRecord:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.index?this.indexes[t.index]:this.index;n.insertRecord(e)},updateRecord:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.index?this.indexes[t.index]:this.index;n.updateRecord(e)},removeRecord:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.index?this.indexes[t.index]:this.index;n.removeRecord(e)}})(i.prototype)},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e){this.collection=e}function u(e,t,n,r){var i=e[t],a=(0,c.get)(n,i[0]),o=(0,c.get)(r,i[0]);return a&&(0,c.isString)(a)&&(a=a.toUpperCase()),o&&(0,c.isString)(o)&&(o=o.toUpperCase()),"DESC"===i[1]?a>o?-1:o>a?1:t<e.length-1?u(e,t+1,n,r):0:o>a?-1:a>o?1:t<e.length-1?u(e,t+1,n,r):0}function a(e){return e.replace(d,"\\$1")}function o(e,t){return new RegExp("^"+a(e).replace(h,".*").replace(g,".")+"$",t)}function s(e,t,n){switch(t){case"==":return e==n;case"===":return e===n;case"!=":return e!=n;case"!==":return e!==n;case">":return e>n;case">=":return e>=n;case"<":return n>e;case"<=":return n>=e;case"isectEmpty":return!(0,c.intersection)(e||[],n||[]).length;case"isectNotEmpty":return(0,c.intersection)(e||[],n||[]).length;case"in":return-1!==n.indexOf(e);case"notIn":return-1===n.indexOf(e);case"contains":return-1!==e.indexOf(n);case"notContains":return-1===e.indexOf(n);default:if(0===t.indexOf("like"))return null!==o(n,t.substr(4)).exec(e);if(0===t.indexOf("notLike"))return null===o(n,t.substr(7)).exec(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Query=i;var c=n(3),f=n(4),l={skip:"",offset:"",where:"",limit:"",orderBy:"",sort:""},d=/([.*+?^=!:${}()|[\]\/\\])/g,h=/%/g,g=/_/g;(0,f.configure)({getData:function(){return this.data||(this.data=this.collection.index.getAll()),this.data},between:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=this.collection,i=n.index?r.indexes[n.index]:r.index;if(this.data)throw new Error("Cannot access index after first operation!");return this.data=i.between(e,t,n),this},get:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(this.data)throw new Error("Cannot access index after first operation!");if(e&&!(0,c.isArray)(e)&&(e=[e]),!e.length)return this.getData(),this;var n=this.collection,r=t.index?n.indexes[t.index]:n.index;return this.data=r.get(e),this},getAll:function(){var e=this,t={};if(this.data)throw new Error("Cannot access index after first operation!");for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];if(!r.length||1===r.length&&(0,c.isObject)(r[0]))return this.getData(),this;r.length&&(0,c.isObject)(r[r.length-1])&&(t=r[r.length-1],r.pop());var u=this.collection,a=t.index?u.indexes[t.index]:u.index;return this.data=[],r.forEach(function(t){e.data=e.data.concat(a.get(t))}),this},filter:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments[1];return this.getData(),(0,c.isObject)(t)?!function(){var n={};(0,c.isObject)(t.where)&&(n=t.where),(0,c.forOwn)(t,function(e,t){t in l||t in n||(n[t]={"==":e})});var r=[],i=[],a=[];(0,c.forOwn)(n,function(e,t){(0,c.isObject)(e)||(e={"==":e}),(0,c.forOwn)(e,function(e,n){r.push(t),i.push(n),a.push(e)})}),r.length&&!function(){var t=void 0,n=r.length;e.data=e.data.filter(function(e){var u=!0,o=!0;for(t=0;n>t;t++){var f=i[t],l="|"===f.charAt(0);f=l?f.substr(1):f;var d=s((0,c.get)(e,r[t]),f,a[t]);void 0!==d&&(o=u?d:l?o||d:o&&d),u=!1}return o})}();var o=t.orderBy||t.sort;(0,c.isString)(o)&&(o=[[o,"ASC"]]),(0,c.isArray)(o)||(o=null),o&&!function(){var t=0;o.forEach(function(e,t){(0,c.isString)(e)&&(o[t]=[e,"ASC"])}),e.data.sort(function(e,n){return u(o,t,e,n)})}(),(0,c.isNumber)(t.skip)?e.skip(t.skip):(0,c.isNumber)(t.offset)&&e.skip(t.offset),(0,c.isNumber)(t.limit)&&e.limit(t.limit)}():(0,c.isFunction)(t)&&(this.data=this.data.filter(t,n)),this},skip:function(e){if(!(0,c.isNumber)(e))throw new TypeError("skip: Expected number but found "+("undefined"==typeof e?"undefined":r(e))+"!");var t=this.getData();return e<t.length?this.data=t.slice(e):this.data=[],this},limit:function(e){if(!(0,c.isNumber)(e))throw new TypeError("limit: Expected number but found "+("undefined"==typeof e?"undefined":r(e))+"!");var t=this.getData();return this.data=t.slice(0,Math.min(t.length,e)),this},forEach:function(e,t){return this.getData().forEach(e,t),this},map:function(e,t){return this.data=this.getData().map(e,t),this},run:function(){var e=this.data;return this.data=null,this.params=null,e}})(i.prototype)},function(e,t){"use strict";function n(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function r(e){return"[object Object]"===toString.call(e)||!1}function i(e){return!!e&&"object"===("undefined"==typeof e?"undefined":n(e))&&e.constructor===Object}function u(e){return"[object RegExp]"===toString.call(e)||!1}function a(e){return"string"==typeof e||e&&"object"===("undefined"==typeof e?"undefined":n(e))&&"[object String]"===toString.call(e)||!1}function o(e){return e&&"object"===("undefined"==typeof e?"undefined":n(e))&&"[object Date]"===toString.call(e)||!1}function s(e){var t="undefined"==typeof e?"undefined":n(e);return"number"===t||e&&"object"===t&&"[object Number]"===toString.call(e)||!1}function c(e){return"function"==typeof e||e&&"[object Function]"===toString.call(e)||!1}function f(e){return a(e)||s(e)}function l(e,t){for(var n=t.split("."),r=n.pop();t=n.shift();)if(e=e[t],null==e)return;return e[r]}function d(e,t){for(var n=t.split("."),r=n.pop();t=n.shift();)if(e=e[t],null==e)return;delete e[r]}function h(e,t){if(!t)return e;var n=t.split(".");return n.forEach(function(t){e[t]||(e[t]={}),e=e[t]}),e}function g(e,t,n){var r=N.exec(t);r?h(e,r[1])[r[2]]=n:e[t]=n}function v(e,t,n){var r=Object.keys(e),i=r.length,u=void 0;for(u=0;i>u;u++)t.call(n,e[r[u]],r[u],e)}function p(e,t){return t&&v(t,function(e,t){var n=this[t];i(e)&&i(n)?p(n,e):this[t]=e},e),e}function m(e){return Promise.resolve(e)}function y(e){return Promise.reject(e)}function b(e,t){for(var n in e){var r=e[n];void 0!==t[n]||c(r)||(t[n]=r)}}function x(e,t){if(!e||!t)return[];var n=[],r=void 0,i=void 0,u=e.length;for(i=0;u>i;i++)r=e[i],-1===n.indexOf(r)&&-1!==t.indexOf(r)&&n.push(r);return n}function A(e){return null!=e&&""!==e}function w(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return e.filter(A).join(t)}function k(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var r=w(t,"/");return r.replace(/([^:\/]|^)\/{2,}/g,"$1/")}function O(e,t){v(t,function(t,n){void 0===e[n]&&(e[n]=t)})}function j(e,t){return function(n){var r=e[t];e[t]=function(){for(var t=arguments.length,i=Array(t),u=0;t>u;u++)i[u]=arguments[u];var a=n.apply(e,i);return void 0===a||F(a)||(a=[a]),r.apply(e,a||i)},j(e,t)}}function E(e,t){if(!t||!t.length)return!1;for(var n=void 0,r=0;r<t.length;r++)if("[object RegExp]"===Object.prototype.toString.call(t[r])&&t[r].test(e)||t[r]===e)return n=e;return!!n}function _(e,t){var n=[];return v(e,function(e,r){E(r,t)&&n.push(r)}),n.forEach(function(t){delete e[t]}),e}function P(e){return a(e)?JSON.parse(e):e}function S(e,t,n,i,a){if(t){if(e===t)throw new Error("Cannot copy! Source and destination are identical.");if(n=n||[],i=i||[],r(e)){var s=n.indexOf(e);if(-1!==s)return i[s];n.push(e),i.push(t)}var c=void 0;if(F(e)){var f=void 0;for(t.length=0,f=0;f<e.length;f++)c=S(e[f],null,n,i,a),r(e[f])&&(n.push(e[f]),i.push(c)),t.push(c)}else{F(t)?t.length=0:v(t,function(e,n){delete t[n]});for(var l in e)if(e.hasOwnProperty(l)){if(E(l,a))continue;c=S(e[l],null,n,i,a),r(e[l])&&(n.push(e[l]),i.push(c)),t[l]=c}}}else t=e,e&&(F(e)?t=S(e,[],n,i,a):o(e)?t=new Date(e.getTime()):u(e)?(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex):r(e)&&(t=S(e,Object.create(Object.getPrototypeOf(e)),n,i,a)));return t}function C(e,t,n){return""+t.toUpperCase()+n.toLowerCase()}function R(e){return e.replace($,"").replace(L,C)}function I(e){return e.split(D).map(R).join("")}function M(e){return e=I(e),e?e.charAt(0).toLowerCase()+e.slice(1):e}Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=r,t.isRegExp=u,t.isString=a,t.isDate=o,t.isNumber=s,t.isFunction=c,t.isSorN=f,t.get=l,t.unset=d,t.set=g,t.forOwn=v,t.deepMixIn=p,t.resolve=m,t.reject=y,t._=b,t.intersection=x,t.makePath=k,t.fillIn=O,t.makeBefore=j,t.isBlacklisted=E,t.omit=_,t.fromJson=P,t.copy=S,t.pascalCase=I,t.camelCase=M;var F=t.isArray=Array.isArray,N=/^(.+)\.(.+)$/,D=(t.toJson=JSON.stringify,/\s+/),$=/[^A-Za-z]/g,L=/(\w)(\w*)/g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})};for(var u in r){i(u)}var a=n(7),o=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})};for(var s in a){o(s)}var c=n(6),f=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})};for(var l in c){f(l)}var d=n(8),h=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return d[e]}})};for(var g in d){h(g)}var v=n(9),p=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})};for(var m in v){p(m)}var y=n(10),b=function(e){return"default"===e?"continue":void Object.defineProperty(t,e,{enumerable:!0,get:function(){return y[e]}})};for(var x in y){b(x)}t.DECORATORS="FIXME"},function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,t){if(!e||!(0,a.isString)(e))throw new TypeError("action(name[, opts]): Expected: string, Found: "+("undefined"==typeof e?"undefined":r(e)));return function(n){if(n[e])throw new Error("action(name[, opts]): "+e+" already exists on target!");return t.request=t.request||function(e){return e},t.response=t.response||function(e){return e},t.responseError=t.responseError||function(e){return(0,a.reject)(e)},n[e]=function(n,r){(0,a.isObject)(n)&&(r=n),r=r||{};var i=this.getAdapter(t.adapter||this.defaultAdapter||"http"),u={};if((0,a.fillIn)(u,t),!r.hasOwnProperty("endpoint")&&u.endpoint&&(r.endpoint=u.endpoint),"function"==typeof r.getEndpoint)u.url=r.getEndpoint(this,r);else{var s=[r.basePath||this.basePath||i.defaults.basePath,i.getEndpoint(this,(0,a.isSorN)(n)?n:null,r)];(0,a.isSorN)(n)&&s.push(n),s.push(t.pathname||e),u.url=a.makePath.apply(null,s)}return u.method=u.method||"GET",u.resourceName=this.name,(0,o.configure)(u)(r),(0,a.resolve)(u).then(r.request||t.request).then(function(e){return i.HTTP(e)}).then(function(e){return e&&e.config&&(e.config.resourceName=this.name),e}).then(r.response||t.response,r.responseError||t.responseError)},n}}function u(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(e){return(0,a.forOwn)(e,function(t,n){i(n,t)(e)}),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.action=i,t.actions=u;var a=n(3),o=n(6)},function(e,t,n){"use strict";function r(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];return e=e||{},function(n){return(0,i.forOwn)(e,function(e,r){(void 0===n[r]||t)&&(n[r]=(0,i.copy)(e))}),n}}Object.defineProperty(t,"__esModule",{value:!0}),t.configure=r;var i=n(3)},function(e,t,n){"use strict";function r(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=n.localField=n.localField||t.name.toLowerCase(),i=n.localKey=n.localKey||t.name.toLowerCase()+"_id",a={enumerable:void 0!==n.enumerable?!!n.enumerable:!1,get:function(){var e=(0,u.get)(this,i);return void 0!==e?t.get(e):void 0},set:function(e){return(0,u.set)(this,i,e[t.idAttribute]),(0,u.get)(this,r)}};return(n.link===!1||void 0===n.link&&!e.linkRelations)&&(delete a.get,delete a.set,a.writable=!0),n.get&&!function(){var r=a.get;a.get=function(){var i=this;return n.get(e,t,this,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(i,t)}:void 0)}}(),n.set&&!function(){var r=a.set;a.set=function(i){var u=this;return n.set(e,t,this,i,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(u,t)}:void 0)}}(),Object.defineProperty(e.prototype,r,a),e.relationList||(e.relationList=[]),e.relationFields||(e.relationFields=[]),n.type="belongsTo",n.name=e.name,n.relation=t.name,n.Relation=t,e.relationList.push(n),e.relationFields.push(r),e.data().createIndex(i),e}function i(e,t){return function(n){return r(n,e,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.belongsTo=i;var u=n(3)},function(e,t,n){"use strict";function r(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=n.localField||(0,u.camelCase)(t.name)+"Collection",i=n.foreignKey,a=n.localKeys,o=n.foreignKeys;i||a||o||(i=n.foreignKey=(0,u.camelCase)(e.name)+"Id"),i&&t.data().createIndex(i);var s={enumerable:void 0!==n.enumerable?!!n.enumerable:!1,get:function(){var n={};if(i)return t.getAll((0,u.get)(this,e.idAttribute),{index:i});if(a){var r=(0,u.get)(this,a)||[],s=(0,u.isArray)(r)?r:Object.keys(r);return t.getAll.apply(t,s)}return o?((0,u.set)(n,"where."+o+".contains",(0,u.get)(this,e.idAttribute)),t.filter(n)):void 0},set:function(n){var s=this;return n&&n.length&&!function(){var r=(0,u.get)(s,e.idAttribute);i?n.forEach(function(e){(0,u.set)(e,i,r)}):a?!function(){var e=[];n.forEach(function(n){e.push((0,u.get)(n,t.idAttribute))}),(0,u.set)(s,a,e)}():o&&n.forEach(function(e){var t=(0,u.get)(e,o);t?-1===t.indexOf(r)&&t.push(r):(0,u.set)(e,o,[r])})}(),(0,u.get)(this,r)}};return(n.link===!1||void 0===n.link&&!e.linkRelations)&&(delete s.get,delete s.set,s.writable=!0),n.get&&!function(){var r=s.get;s.get=function(){var i=this;return n.get(e,t,this,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(i,t)}:void 0)}}(),n.set&&!function(){var r=s.set;s.set=function(i){var u=this;return n.set(e,t,this,i,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(u,t)}:void 0)}}(),Object.defineProperty(e.prototype,r,s),e.relationList||(e.relationList=[]),e.relationFields||(e.relationFields=[]),n.type="hasMany",n.name=e.name,n.relation=t.name,n.Relation=t,e.relationList.push(n),e.relationFields.push(r),e}function i(e,t){return function(n){return r(n,e,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.hasMany=i;var u=n(3)},function(e,t,n){"use strict";function r(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],r=n.localField=n.localField||(0,u.camelCase)(t.name),i=n.foreignKey=n.foreignKey||(0,u.camelCase)(e.name)+"Id",a={enumerable:void 0!==n.enumerable?!!n.enumerable:!1,get:function(){var n=t.getAll((0,u.get)(this,e.idAttribute),{index:i});return n&&n.length?n[0]:void 0},set:function(t){return(0,u.set)(t,i,(0,u.get)(this,e.idAttribute)),(0,u.get)(this,r)}};return(n.link===!1||void 0===n.link&&!e.linkRelations)&&(delete a.get,delete a.set),n.get&&!function(){var r=a.get;a.get=function(){var i=this;return n.get(e,t,this,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(i,t)}:void 0)}}(),n.set&&!function(){var r=a.set;a.set=function(i){var u=this;return n.set(e,t,this,i,r?function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return r.apply(u,t)}:void 0)}}(),Object.defineProperty(e.prototype,r,a),e.relationList||(e.relationList=[]),e.relationFields||(e.relationFields=[]),n.type="hasOne",n.name=e.name,n.relation=t.name,n.Relation=t,e.relationList.push(n),e.relationFields.push(r),e.data().createIndex(i),e}function i(e,t){return function(n){return r(n,e,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.hasOne=i;var u=n(3)},function(e,t,n){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return function(t){var n=new u.Collection([],t.idAttribute);return t.data=function(){if(this.data===Object.getPrototypeOf(this).data)throw new Error(this.name+": Schemas are not inheritable, did you forget to define a schema?");return n},(0,i.forOwn)(e,function(e,n){var r={enumerable:void 0!==e.enumerable?e.enumerable:!0,writable:e.writable?e.writable:!0,configurable:e.configurable?e.configurable:!0};e.indexed&&(delete r.writable,t.createIndex(n),r.get=function(){return this.$$props[n]},r.set=function(e){return this.$$props[n]=e,this.$$s&&t.data().updateRecord(this,{index:n}),e}),e.get&&(delete r.writable,r.get=e.get),e.set&&(delete r.writable,r.set?!function(){var t=r.set;r.set=function(n){return e.set.call(this,t.call(this,n))}}():r.set=e.set),r.writable||Object.defineProperty(t.prototype,n,r)}),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.schema=r;var i=n(3),u=n(1)},function(e,t,n){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1];if(!(0,i.isArray)(e))throw new Error("fieldList must be an array.");this.fieldList=e,this.idAttribute=t,this.isIndex=!0,this.keys=[],this.values=[]}Object.defineProperty(t,"__esModule",{value:!0}),t.Index=r;var i=n(3),u=n(4),a=n(12);(0,u.configure)({set:function(e,t){(0,i.isArray)(e)||(e=[e]);var n=e.shift()||null,u=(0,a.binarySearch)(this.keys,n);if(0===e.length)if(u.found){var o=(0,a.binarySearch)(this.values[u.index],t,this.idAttribute);o.found||(0,a.insertAt)(this.values[u.index],o.index,t)}else(0,a.insertAt)(this.keys,u.index,n),(0,a.insertAt)(this.values,u.index,[t]);else if(u.found)this.values[u.index].set(e,t);else{(0,a.insertAt)(this.keys,u.index,n);var s=new r([],this.idAttribute);s.set(e,t),(0,a.insertAt)(this.values,u.index,s)}},get:function(e){(0,i.isArray)(e)||(e=[e]);var t=e.shift()||null,n=(0,a.binarySearch)(this.keys,t);return 0===e.length?n.found?this.values[n.index].isIndex?this.values[n.index].getAll():this.values[n.index]:[]:n.found?this.values[n.index].get(e):[]},getAll:function(){var e=[];return this.values.forEach(function(t){e=t.isIndex?e.concat(t.getAll()):e.concat(t)}),e},visitAll:function(e,t){this.values.forEach(function(n){n.isIndex?n.visitAll(e,t):n.forEach(e,t)})},query:function(e){var t=void 0,n=void 0;if(e[">"]?(t=e[">"],e.leftInclusive=!1):e[">="]&&(t=e[">="],e.leftInclusive=!0),e["<"]?(n=e["<"],e.rightInclusive=!1):e["<="]&&(n=e["<="],e.rightInclusive=!0),t.length!==n.length)throw new Error("Key arrays must be same length");return this.between(t,n,(0,i.omit)(e,[">",">=","<","<="]))},between:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(0,i.isArray)(e)||(e=[e]),(0,i.isArray)(t)||(t=[t]),(0,i.fillIn)(n,{leftInclusive:!0,rightInclusive:!1,limit:void 0,offset:0});var r=this._between(e,t,n);return n.limit?r.slice(n.offset,n.limit+n.offset):r.slice(n.offset)},_between:function(e,t,n){var r=[],u=e.shift(),o=t.shift(),s=void 0;if(s=void 0!==u?(0,a.binarySearch)(this.keys,u):{found:!1,index:0},0===e.length){s.found&&n.leftInclusive===!1&&(s.index+=1);for(var c=s.index;c<this.keys.length;c+=1){if(void 0!==o)if(n.rightInclusive){if(this.keys[c]>o)break}else if(this.keys[c]>=o)break;if(r=this.values[c].isIndex?r.concat(this.values[c].getAll()):r.concat(this.values[c]),n.limit&&r.length>=n.limit+n.offset)break}}else for(var c=s.index;c<this.keys.length;c+=1){var f=this.keys[c];if(f>o)break;if(r=this.values[c].isIndex?f===u?r.concat(this.values[c]._between((0,i.copy)(e),t.map(function(){}),n)):f===o?r.concat(this.values[c]._between(e.map(function(){}),(0,i.copy)(t),n)):r.concat(this.values[c].getAll()):r.concat(this.values[c]),n.limit&&r.length>=n.limit+n.offset)break}return n.limit?r.slice(0,n.limit+n.offset):r},remove:function(e,t){(0,i.isArray)(e)||(e=[e]);var n=e.shift(),r=(0,a.binarySearch)(this.keys,n);if(0===e.length){if(r.found){var u=(0,a.binarySearch)(this.values[r.index],t,this.idAttribute);u.found&&((0,a.removeAt)(this.values[r.index],u.index),0===this.values[r.index].length&&((0,a.removeAt)(this.keys,r.index),(0,a.removeAt)(this.values,r.index)))}}else r.found&&this.values[r.index].delete(e,t)},clear:function(){this.keys=[],this.values=[]},insertRecord:function(e){var t=this.fieldList.map(function(t){return e[t]||null});this.set(t,e)},removeRecord:function(e){var t=this.fieldList.map(function(t){return e[t]||null});this.remove(t,e)},updateRecord:function(e){this.removeRecord(e),this.insertRecord(e)}})(r.prototype)},function(e,t){"use strict";function n(e,t,n){return e===t?0:(n&&(e=e[n],t=t[n]),null===e&&null===t?0:null===e?-1:null===t?1:t>e?-1:e>t?1:0)}function r(e,t,n){return e.splice(t,0,n),e}function i(e,t){return e.splice(t,1),e}function u(e,t,r){for(var i=0,u=e.length,a=void 0,o=void 0;u>i;){if(o=(i+u)/2|0,a=n(t,e[o],r),0===a)return{found:!0,index:o};0>a?u=o:i=o+1}return{found:!1,index:u}}Object.defineProperty(t,"__esModule",{value:!0}),t.sort=n,t.insertAt=r,t.removeAt=i,t.binarySearch=u},function(e,t,n){"use strict";function r(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.definitions={}}Object.defineProperty(t,"__esModule",{value:!0}),t.DS=r;var i=n(4),u=n(3),a=n(14);(0,i.configure)({clear:function(){var e={};return(0,u.forOwn)(this.definitions,function(t){var n=t.name;e[n]=t.ejectAll()}),e},defineResource:function(e){var t=a.Resource.extend(e.methods||{},e);return this.definitions[t.name]=t,t}})(r.prototype),(0,u.forOwn)(a.Resource,function(e,t){(0,u.isFunction)(e)&&(r.prototype[t]=function(e){var n;if(!this.definitions[e])throw new Error(e+" is not a registered Resource!");for(var r=arguments.length,i=Array(r>1?r-1:0),u=1;r>u;u++)i[u-1]=arguments[u];return(n=this.definitions[e])[t].apply(n,i)})})},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t,n){return n.autoInject?e.inject(t):t}var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Resource=void 0;var l=n(3),d=r(l),h=n(4),g=!1;try{g=!!window}catch(e){}var v=function e(){s(this,e)},p=t.Resource=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s(this,t);var n=a(this,Object.getPrototypeOf(t).call(this));return Object.defineProperty(n,"$$props",{value:{}}),(0,h.configure)(e)(n),n}return o(t,e),f(t,[{key:"create",value:function(e){var t=this,n=this.constructor;return n.create(this,e).then(function(e){return e!==t&&e[n.idAttribute]&&d.forOwn(e,function(e,n){t[n]=e}),t})}},{key:"save",value:function(e){var t=this.constructor,n=d._(t,e),r=t.getAdapterName(n);return t.adapters[r].update(t,this[t.idAttribute],this,n)}},{key:"destroy",value:function(e){var t=this.constructor;return t.destroy(this[t.idAttribute],e)}}],[{key:"data",value:function(){throw new Error(this.name+": Did you forget to define a schema?")}},{key:"createIndex",value:function(e,t){this.data().createIndex(e,t)}},{key:"createInstance",value:function(e){var t=this;return e instanceof t?e:new t(e)}},{key:"is",value:function(e){return e instanceof this}},{key:"inject",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=this,r=!1;d.isArray(e)||(e=[e],r=!0);var i=n.data(),a=n.idAttribute,o=n.relationList||[];return e.forEach(function(e){o.forEach(function(t){var r=t.Relation,i=d.get(e,t.localField);if(d.isFunction(t.inject))t.inject(n,t,e);else if(i&&t.inject!==!1)if(d.isArray(i))i.forEach(function(n){if(n!==r.get(d.get(n,r.idAttribute)))try{t.foreignKey&&d.set(n,t.foreignKey,d.get(e,a)),r.inject(n)}catch(e){throw new Error("Failed to inject "+t.type+' relation: "'+t.relation+'"!')}}),t.localKeys&&d.set(i,t.localKeys,i.map(function(e){return d.get(e,r.idAttribute)}));else if(i!==r.get(r.idAttribute))try{t.localKey&&d.set(e,t.localKey,d.get(i,r.idAttribute)),t.foreignKey&&d.set(i,t.foreignKey,d.get(e,a)),r.inject(i)}catch(e){throw new Error("Failed to inject "+t.type+' relation: "'+t.relation+'"!')}("boolean"==typeof t.link?t.link:!!n.linkRelations)&&d.unset(e,t.localField)})}),e=e.map(function(e){var r=d.get(e,a);if(!r)throw new TypeError("User#"+a+": Expected string or number, found "+("undefined"==typeof r?"undefined":u(r))+"!");var o=n.get(r);if(o){var s=t.onConflict||n.onConflict;"merge"===s?d.deepMixIn(o,e):"replace"===s&&(d.forOwn(o,function(t,n){n!==a&&(e.hasOwnProperty(n)||delete o[n])}),d.forOwn(e,function(e,t){t!==a&&(o[t]=e)})),e=o}else e=n.createInstance(e),e.$$props.$$s=!0,i.index.insertRecord(e);return d.forOwn(i.indexes,function(t){t.updateRecord(e)}),e}),r?e.length?e[0]:void 0:e}},{key:"eject",value:function(e){var t=(arguments.length<=1||void 0===arguments[1]?{}:arguments[1],this.get(e));t&&(delete t.$$props.$$s,this.data().remove(t))}},{key:"ejectAll",value:function(e){var t=(arguments.length<=1||void 0===arguments[1]?{}:arguments[1],this.filter(e)),n=this.data();return t.forEach(function(e){n.remove(e)}),t}},{key:"get",value:function(e){var t=this.data().get(e);return t.length?t[0]:void 0}},{key:"between",value:function(){var e;return(e=this.data()).between.apply(e,arguments)}},{key:"getAll",value:function(){var e;return(e=this.data()).getAll.apply(e,arguments)}},{key:"filter",value:function(e){return this.data().filter(e)}},{key:"query",value:function(){return this.data().query()}},{key:"getAdapter",value:function(e){return this.adapters[this.getAdapterName(e)]}},{key:"getAdapterName",value:function(e){return d._(this,e),e.adapter||e.defaultAdapter}},{key:"beforeCreate",value:function(){}},{key:"create",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return d._(this,n),n.upsert&&d.get(t,this.idAttribute)?this.update(d.get(t,this.idAttribute),t,n):this.beforeCreate(t,n).then(function(){var r=e.getAdapterName(n);return e.adapters[r].create(e,d.omit(t,n.omit),n)}).then(function(t){return e.afterCreate(t,n)}).then(function(t){return c(e,t,n)})}},{key:"afterCreate",value:function(){}},{key:"beforeCreateMany",value:function(){}},{key:"createMany",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(d._(this,n),n.upsert){var r=function(){var r=!0;return t.forEach(function(e){r=r&&d.get(e,this.idAttribute)}),r?{v:e.updateMany(t,n)}:void 0}();if("object"===("undefined"==typeof r?"undefined":u(r)))return r.v}var i=this.getAdapterName(n);return this.beforeCreateMany(t,n).then(function(){return e.adapters[i].createMany(e,t.map(function(e){return d.omit(e,n.omit)}),n)}).then(function(t){return e.afterCreateMany(t,n)}).then(function(t){return c(e,t,n)})}},{key:"afterCreateMany",value:function(){}},{key:"beforeFind",value:function(){}},{key:"find",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];d._(this,n);var r=this.getAdapterName(n);return this.beforeFind(e,n).then(function(){return t.adapters[r].find(t,e,n)}).then(function(e){return t.afterFind(e,n)}).then(function(e){return c(t,e,n)})}},{key:"afterFind",value:function(){}},{key:"beforeFindAll",value:function(){}},{key:"findAll",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];d._(this,n);var r=this.getAdapterName(n);return this.beforeFindAll(t,n).then(function(){return e.adapters[r].findAll(e,t,n)}).then(function(t){return e.afterFindAll(t,n)}).then(function(t){return c(e,t,n)})}},{key:"afterFindAll",value:function(){}},{key:"beforeUpdate",value:function(){}},{key:"update",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];
d._(this,r);var i=this.getAdapterName(r);return this.beforeUpdate(e,n,r).then(function(){return t.adapters[i].update(t,e,n,r)}).then(function(n){return t.afterUpdate(e,n,r)}).then(function(e){return c(t,e,r)})}},{key:"afterUpdate",value:function(){}},{key:"beforeUpdateMany",value:function(){}},{key:"updateMany",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];d._(this,n);var r=this.getAdapterName(n);return this.beforeUpdateMany(t,n).then(function(){return e.adapters[r].updateMany(e,t,n)}).then(function(t){return e.afterUpdateMany(t,n)}).then(function(t){return c(e,t,n)})}},{key:"afterUpdateMany",value:function(){}},{key:"beforeUpdateAll",value:function(){}},{key:"updateAll",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];d._(this,r);var i=this.getAdapterName(r);return this.beforeUpdateAll(e,n,r).then(function(){return t.adapters[i].updateAll(t,e,n,r)}).then(function(n){return t.afterUpdateAll(e,n,r)}).then(function(e){return c(t,e,r)})}},{key:"afterUpdateAll",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroy",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];d._(this,n);var r=this.getAdapterName(n);return this.beforeDestroy(e,n).then(function(){return t.adapters[r].destroy(t,e,n)}).then(function(){return t.afterDestroy(e,n)}).then(function(){return t.eject(e,n)})}},{key:"afterDestroy",value:function(){}},{key:"beforeDestroyAll",value:function(){}},{key:"destroyAll",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];d._(this,n);var r=this.getAdapterName(n);return this.beforeDestroyAll(t,n).then(function(){return e.adapters[r].destroyAll(e,t,n)}).then(function(){return e.afterDestroyAll(t,n)}).then(function(){return e.ejectAll(t,n)})}},{key:"afterDestroyAll",value:function(){}},{key:"belongsTo",value:function(e,t){return(0,h.belongsTo)(e,t)(this)}},{key:"hasMany",value:function(e,t){return(0,h.hasMany)(e,t)(this)}},{key:"hasOne",value:function(e,t){return(0,h.hasOne)(e,t)(this)}},{key:"action",value:function(e,t){return(0,h.action)(e,t)(this)}},{key:"actions",value:function(e){return(0,h.actions)(e)(this)}},{key:"schema",value:function(e){return(0,h.schema)(e)(this)}},{key:"configure",value:function(e){return(0,h.configure)(e)(this)}},{key:"extend",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=void 0,r=this;if(e=e||{},!t.name)throw new TypeError("name: Expected string, found "+u(t.name)+"!");var c=t.schema||i({},t.idAttribute,{}),f=e.initialize;if(delete e.initialize,c[t.idAttribute]=c[t.idAttribute]||{},t.shortname=t.shortname||d.camelCase(t.name),e.hasOwnProperty("constructor"))n=e.constructor,delete e.constructor;else if(t.csp)n=function(){s(this,n);for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];var i=a(this,Object.getPrototypeOf(n).apply(this,t));return f&&f.apply(this,t),i};else{var l=d.pascalCase(t.name);delete t.name;var g="return function "+l+"() {\n                        _classCallCheck(this, "+l+")\n                        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf("+l+").apply(this, arguments));\n                        if (initialize) {\n                          initialize.apply(this, arguments)\n                        }\n                        return _this\n                      }";n=new Function("_classCallCheck","_possibleConstructorReturn","Parent","initialize",g)(s,a,r,f)}return o(n,r),(0,h.configure)(e)(n.prototype),(0,h.configure)(t)(n),(0,h.schema)(c)(n),n}}]),t}(v);(0,h.configure)({adapters:{},autoInject:g,bypassCache:!1,csp:!1,defaultAdapter:"http",eagerEject:!1,idAttribute:"id",linkRelations:g,onConflict:"merge",relationsEnumerable:!1,returnMeta:!1,strategy:"single",useFilter:!0})(p)}])});
//# sourceMappingURL=dist/js-data.min.map