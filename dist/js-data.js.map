{"version":3,"file":"js-data.js","sources":["../C:/Users/jason/Documents/GitHub/js-data/src/utils.js","../C:/Users/jason/Documents/GitHub/js-data/src/collection/query.js","../C:/Users/jason/Documents/GitHub/js-data/lib/mindex/utils.js","../C:/Users/jason/Documents/GitHub/js-data/lib/mindex/index.js","../C:/Users/jason/Documents/GitHub/js-data/src/collection/collection.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/belongsTo.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/configure.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/hasMany.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/hasOne.js","../C:/Users/jason/Documents/GitHub/js-data/src/validate/index.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/schema.js","../C:/Users/jason/Documents/GitHub/js-data/src/decorators/adapter.js","../C:/Users/jason/Documents/GitHub/js-data/src/model/index.js","../C:/Users/jason/Documents/GitHub/js-data/src/datastore/index.js","../C:/Users/jason/Documents/GitHub/js-data/src/index.js"],"sourcesContent":["/**\r\n * @module utils\r\n * @memberof module:js-data\r\n */\r\n\r\nfunction toString (x) {\r\n  return Object.prototype.toString.call(x)\r\n}\r\n\r\n/**\r\n * Return whether the provided value is an array.\r\n * @method\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport const isArray = Array.isArray\r\n/**\r\n * Return whether the provided value is an object type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isObject (value) {\r\n  return toString(value) === '[object Object]' || false\r\n}\r\nfunction isPlainObject (value) {\r\n  return (!!value && typeof value === 'object' && value.constructor === Object)\r\n}\r\n/**\r\n * Return whether the provided value is a regular expression type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isRegExp (value) {\r\n  return toString(value) === '[object RegExp]' || false\r\n}\r\n/**\r\n * Return whether the provided value is a string type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isString (value) {\r\n  return typeof value === 'string' || (value && typeof value === 'object' && toString(value) === '[object String]') || false\r\n}\r\n/**\r\n * Return whether the provided value is a date type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isDate (value) {\r\n  return (value && typeof value === 'object' && toString(value) === '[object Date]') || false\r\n}\r\n/**\r\n * Return whether the provided value is a number type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isNumber (value) {\r\n  const type = typeof value\r\n  return type === 'number' || (value && type === 'object' && toString(value) === '[object Number]') || false\r\n}\r\n/**\r\n * Return whether the provided value is a boolean type.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isBoolean (value) {\r\n  return toString(value) === '[object Boolean]'\r\n}\r\n/**\r\n * Return whether the provided value is a function.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isFunction (value) {\r\n  return typeof value === 'function' || (value && toString(value) === '[object Function]') || false\r\n}\r\n/**\r\n * Return whether the provided value is a string or a number.\r\n * @param {*} [value] - The value to test.\r\n */\r\nexport function isSorN (value) {\r\n  return isString(value) || isNumber(value)\r\n}\r\n/**\r\n * Get the value at the provided key or path.\r\n * @param {Object} object - The object from which to retrieve a property.\r\n * @param {string} prop - The key or path to the property.\r\n */\r\nexport function get (object, prop) {\r\n  if (!prop) {\r\n    return\r\n  }\r\n  const parts = prop.split('.')\r\n  const last = parts.pop()\r\n\r\n  while (prop = parts.shift()) { // eslint-disable-line\r\n    object = object[prop]\r\n    if (object == null) return\r\n  }\r\n\r\n  return object[last]\r\n}\r\n/**\r\n * Unset the value at the provided key or path.\r\n * @param {Object} object - The object on which to unset a property.\r\n * @param {string} prop - The key or path to the property.\r\n */\r\nexport function unset (object, prop) {\r\n  const parts = prop.split('.')\r\n  const last = parts.pop()\r\n\r\n  while (prop = parts.shift()) { // eslint-disable-line\r\n    object = object[prop]\r\n    if (object == null) return\r\n  }\r\n\r\n  object[last] = undefined\r\n  delete object[last]\r\n}\r\nfunction mkdirP (object, path) {\r\n  if (!path) {\r\n    return object\r\n  }\r\n  const parts = path.split('.')\r\n  parts.forEach(function (key) {\r\n    if (!object[key]) {\r\n      object[key] = {}\r\n    }\r\n    object = object[key]\r\n  })\r\n  return object\r\n}\r\nconst PATH = /^(.+)\\.(.+)$/\r\n/**\r\n * Set the value at the provided key or path.\r\n * @param {Object} object - The object on which to set a property.\r\n * @param {(string|Object)} path - The key or path to the property. Can also\r\n * pass in an object of path/value pairs, which will all be set on the target\r\n * object.\r\n * @param {*} [value] - The value to set.\r\n */\r\nexport function set (object, path, value) {\r\n  if (isObject(path)) {\r\n    forOwn(path, function (value, _path) {\r\n      set(object, _path, value)\r\n    })\r\n  } else {\r\n    const parts = PATH.exec(path)\r\n    if (parts) {\r\n      mkdirP(object, parts[1])[parts[2]] = value\r\n    } else {\r\n      object[path] = value\r\n    }\r\n  }\r\n}\r\n/**\r\n * Iterate over an object's own enumerable properties.\r\n * @param {Object} object - The object whose properties are to be enumerated.\r\n * @param {Function} fn - Iteration function.\r\n * @param {Object} [thisArg] - Content to which to bind `fn`.\r\n */\r\nexport function forOwn (obj, fn, thisArg) {\r\n  const keys = Object.keys(obj)\r\n  const len = keys.length\r\n  let i\r\n  for (i = 0; i < len; i++) {\r\n    fn.call(thisArg, obj[keys[i]], keys[i], obj)\r\n  }\r\n}\r\n/**\r\n * Recursively shallow copy own enumberable properties from `source` to `dest`.\r\n * @param {Object} dest - The destination object.\r\n * @param {Object} source - The source object.\r\n */\r\nexport function deepMixIn (dest, source) {\r\n  if (source) {\r\n    forOwn(source, function (value, key) {\r\n      const existing = this[key]\r\n      if (isPlainObject(value) && isPlainObject(existing)) {\r\n        deepMixIn(existing, value)\r\n      } else {\r\n        this[key] = value\r\n      }\r\n    }, dest)\r\n  }\r\n  return dest\r\n}\r\n/**\r\n * Proxy for `Promise.resolve`.\r\n * @param {*} [value] - Value with which to resolve the Promise.\r\n * @return {Promise} Promise resolved with `value`.\r\n */\r\nexport function resolve (value) {\r\n  return Promise.resolve(value)\r\n}\r\n/**\r\n * Proxy for `Promise.reject`.\r\n * @param {*} [value] - Value with which to reject the Promise.\r\n * @return {Promise} Promise reject with `value`.\r\n */\r\nexport function reject (value) {\r\n  return Promise.reject(value)\r\n}\r\n/**\r\n * Shallow copy own enumerable non-function properties from `Model` to `opts`.\r\n * @param {Model} Model - The source Model.\r\n * @param {Object} opts - The target object.\r\n */\r\nexport function _ (Model, opts) {\r\n  for (var key in Model) {\r\n    let value = Model[key]\r\n    if (opts[key] === undefined && !isFunction(value) && key && key.indexOf('_') !== 0) {\r\n      opts[key] = value\r\n    }\r\n  }\r\n}\r\n/**\r\n * Return the intersection of two arrays.\r\n * @param {Array} array1 - First array.\r\n * @param {Array} array2 - Second array.\r\n * @return {Array} Array of elements common to both arrays.\r\n */\r\nexport function intersection (array1, array2) {\r\n  if (!array1 || !array2) {\r\n    return []\r\n  }\r\n  const result = []\r\n  let item\r\n  let i\r\n  const len = array1.length\r\n  for (i = 0; i < len; i++) {\r\n    item = array1[i]\r\n    if (result.indexOf(item) !== -1) {\r\n      continue\r\n    }\r\n    if (array2.indexOf(item) !== -1) {\r\n      result.push(item)\r\n    }\r\n  }\r\n  return result\r\n}\r\n/**\r\n * Shallow copy own enumerable properties from `src` to `dest` that are on `src`\r\n * but are missing from `dest.\r\n * @param {Object} dest - The destination object.\r\n * @param {Object} source - The source object.\r\n */\r\nexport function fillIn (dest, src) {\r\n  forOwn(src, function (value, key) {\r\n    if (dest[key] === undefined) {\r\n      dest[key] = value\r\n    }\r\n  })\r\n}\r\n/**\r\n * Return whether `prop` is matched by any string or regular expression in `bl`.\r\n * @param {string} prop - The name of a property.\r\n * @param {Array} bl - Array of strings and regular expressions.\r\n * @return {boolean} Whether `prop` was matched.\r\n */\r\nexport function isBlacklisted (prop, bl) {\r\n  if (!bl || !bl.length) {\r\n    return false\r\n  }\r\n  let matches\r\n  for (var i = 0; i < bl.length; i++) {\r\n    if ((toString(bl[i]) === '[object RegExp]' && bl[i].test(prop)) || bl[i] === prop) {\r\n      matches = prop\r\n      return matches\r\n    }\r\n  }\r\n  return !!matches\r\n}\r\n/**\r\n * Proxy for `JSON.parse`.\r\n * @param {string} json - JSON to parse.\r\n * @return {Object} Parsed object.\r\n */\r\nexport function fromJson (json) {\r\n  return isString(json) ? JSON.parse(json) : json\r\n}\r\n/**\r\n * Proxy for `JSON.stringify`.\r\n * @method\r\n * @param {*} value - Value to serialize to JSON.\r\n * @return {string} JSON string.\r\n */\r\nexport const toJson = JSON.stringify\r\n/**\r\n * Deep copy a value.\r\n * @param {*} from - Value to deep copy.\r\n * @return {*} Deep copy of `from`.\r\n */\r\nexport function copy (from, to, stackFrom, stackTo, blacklist) {\r\n  if (!to) {\r\n    to = from\r\n    if (from) {\r\n      if (isArray(from)) {\r\n        to = copy(from, [], stackFrom, stackTo, blacklist)\r\n      } else if (isDate(from)) {\r\n        to = new Date(from.getTime())\r\n      } else if (isRegExp(from)) {\r\n        to = new RegExp(from.source, from.toString().match(/[^\\/]*$/)[0])\r\n        to.lastIndex = from.lastIndex\r\n      } else if (isObject(from)) {\r\n        to = copy(from, Object.create(Object.getPrototypeOf(from)), stackFrom, stackTo, blacklist)\r\n      }\r\n    }\r\n  } else {\r\n    if (from === to) {\r\n      throw new Error('Cannot copy! Source and destination are identical.')\r\n    }\r\n\r\n    stackFrom = stackFrom || []\r\n    stackTo = stackTo || []\r\n\r\n    if (isObject(from)) {\r\n      let index = stackFrom.indexOf(from)\r\n      if (index !== -1) {\r\n        return stackTo[index]\r\n      }\r\n\r\n      stackFrom.push(from)\r\n      stackTo.push(to)\r\n    }\r\n\r\n    let result\r\n    if (isArray(from)) {\r\n      let i\r\n      to.length = 0\r\n      for (i = 0; i < from.length; i++) {\r\n        result = copy(from[i], null, stackFrom, stackTo, blacklist)\r\n        if (isObject(from[i])) {\r\n          stackFrom.push(from[i])\r\n          stackTo.push(result)\r\n        }\r\n        to.push(result)\r\n      }\r\n    } else {\r\n      if (isArray(to)) {\r\n        to.length = 0\r\n      } else {\r\n        forOwn(to, function (value, key) {\r\n          delete to[key]\r\n        })\r\n      }\r\n      for (var key in from) {\r\n        if (from.hasOwnProperty(key)) {\r\n          if (isBlacklisted(key, blacklist)) {\r\n            continue\r\n          }\r\n          result = copy(from[key], null, stackFrom, stackTo, blacklist)\r\n          if (isObject(from[key])) {\r\n            stackFrom.push(from[key])\r\n            stackTo.push(result)\r\n          }\r\n          to[key] = result\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return to\r\n}\r\nconst SPLIT = /\\s+/\r\nconst NON_ALPHA = /[^A-Za-z]/g\r\nconst PASCAL_CASE = /(\\w)(\\w*)/g\r\nfunction pascalize (g0, g1, g2) {\r\n  return `${g1.toUpperCase()}${g2.toLowerCase()}`\r\n}\r\nfunction mapToPascal (x) {\r\n  return x.replace(NON_ALPHA, '').replace(PASCAL_CASE, pascalize)\r\n}\r\n/**\r\n * Convert a string to pascalcase.\r\n * @param {string} str - String to convert.\r\n * @return {string} Converted string.\r\n */\r\nexport function pascalCase (str) {\r\n  return str\r\n    .split(SPLIT)\r\n    .map(mapToPascal)\r\n    .join('')\r\n}\r\n/**\r\n * Convert a string to camelcase.\r\n * @param {string} str - String to convert.\r\n * @return {string} Converted string.\r\n */\r\nexport function camelCase (str) {\r\n  str = pascalCase(str)\r\n  if (str) {\r\n    return str.charAt(0).toLowerCase() + str.slice(1)\r\n  }\r\n  return str\r\n}\r\n/**\r\n * Add eventing capabilities into the target object.\r\n * @param {Object} target - Target object.\r\n * @param {Function} [getter] - Custom getter for retrieving the object's event\r\n * listeners.\r\n * @param {Function} [setter] - Custom setter for setting the object's event\r\n * listeners.\r\n */\r\nexport function eventify (target, getter, setter, enumerable) {\r\n  target = target || this\r\n  let _events = {}\r\n  if (!getter && !setter) {\r\n    getter = function () {\r\n      return _events\r\n    }\r\n    setter = function (value) {\r\n      _events = value\r\n    }\r\n  }\r\n  Object.defineProperties(target, {\r\n    on: {\r\n      enumerable: !!enumerable,\r\n      value (type, func, ctx) {\r\n        if (!getter.call(this)) {\r\n          setter.call(this, {})\r\n        }\r\n        const events = getter.call(this)\r\n        events[type] = events[type] || []\r\n        events[type].push({\r\n          f: func,\r\n          c: ctx\r\n        })\r\n      }\r\n    },\r\n    off: {\r\n      enumerable: !!enumerable,\r\n      value (type, func) {\r\n        const events = getter.call(this)\r\n        const listeners = events[type]\r\n        if (!listeners) {\r\n          setter.call(this, {})\r\n        } else if (func) {\r\n          for (let i = 0; i < listeners.length; i++) {\r\n            if (listeners[i].f === func) {\r\n              listeners.splice(i, 1)\r\n              break\r\n            }\r\n          }\r\n        } else {\r\n          listeners.splice(0, listeners.length)\r\n        }\r\n      }\r\n    },\r\n    emit: {\r\n      enumerable: !!enumerable,\r\n      value (...args) {\r\n        const events = getter.call(this) || {}\r\n        const type = args.shift()\r\n        let listeners = events[type] || []\r\n        let i\r\n        for (i = 0; i < listeners.length; i++) {\r\n          listeners[i].f.apply(listeners[i].c, args)\r\n        }\r\n        listeners = events.all || []\r\n        args.unshift(type)\r\n        for (i = 0; i < listeners.length; i++) {\r\n          listeners[i].f.apply(listeners[i].c, args)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/*eslint-disable*/\r\n// RiveraGroup/node-tiny-uuid\r\n// DO WTF YOU WANT TO PUBLIC LICENSE\r\nexport function uuid (a, b) {\r\n  for (\r\n    b = a = ''; // b - result , a - numeric variable\r\n    a++ < 36;\r\n    b += a * 51 & 52 // if \"a\" is not 9 or 14 or 19 or 24\r\n    ?  //  return a random number or 4\r\n    (\r\n      a ^ 15 // if \"a\" is not 15\r\n      ? // genetate a random number from 0 to 15\r\n      8 ^ Math.random() * (a ^ 20 ? 16 : 4) // unless \"a\" is 20, in which case a random number from 8 to 11\r\n      :\r\n      4 //  otherwise 4\r\n    ).toString(16)\r\n    :\r\n    '-' //  in other cases (if \"a\" is 9,14,19,24) insert \"-\"\r\n  );\r\n  return b\r\n}\r\n/*eslint-enable*/\r\n\r\nexport function classCallCheck (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError('Cannot call a class as a function')\r\n  }\r\n}\r\n\r\nexport function possibleConstructorReturn (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError('this hasn\\'t been initialised - super() hasn\\'t been called')\r\n  }\r\n\r\n  return call && (typeof call === 'object' || typeof call === 'function') ? call : self\r\n}\r\n\r\nexport function addHiddenPropsToTarget (target, props) {\r\n  forOwn(props, function (value, key) {\r\n    props[key] = {\r\n      value\r\n    }\r\n  })\r\n  Object.defineProperties(target, props)\r\n}\r\n\r\nexport function extend (props, classProps) {\r\n  const Parent = this\r\n  let Child\r\n\r\n  props || (props = {})\r\n  classProps || (classProps = {})\r\n\r\n  if (props.hasOwnProperty('constructor')) {\r\n    Child = props.constructor\r\n    delete props.constructor\r\n  } else {\r\n    Child = function (...args) {\r\n      classCallCheck(this, Child)\r\n      const _this = possibleConstructorReturn(this, (Child.__super__ || Object.getPrototypeOf(Child)).apply(this, args))\r\n      return _this\r\n    }\r\n  }\r\n\r\n  Child.prototype = Object.create(Parent && Parent.prototype, {\r\n    constructor: {\r\n      value: Child,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  })\r\n\r\n  if (Object.setPrototypeOf) {\r\n    Object.setPrototypeOf(Child, Parent)\r\n  } else if (classProps.strictEs6Class) {\r\n    Child.__proto__ = Parent // eslint-disable-line\r\n  } else {\r\n    forOwn(Parent, function (value, key) {\r\n      Child[key] = value\r\n    })\r\n  }\r\n  Object.defineProperty(Child, '__super__', {\r\n    configurable: true,\r\n    value: Parent\r\n  })\r\n\r\n  deepMixIn(Child.prototype, props)\r\n  deepMixIn(Child, classProps)\r\n\r\n  return Child\r\n}\r\n","import {\r\n  addHiddenPropsToTarget,\r\n  classCallCheck,\r\n  forOwn,\r\n  get,\r\n  intersection,\r\n  isArray,\r\n  isFunction,\r\n  isNumber,\r\n  isObject,\r\n  isString\r\n} from '../utils'\r\n\r\n/**\r\n * A class used by the @{link Collection} class to build queries to be executed\r\n * against the collection's data. An instance of `Query` is returned by\r\n * {@link Model.query} and {@link Collection.query}.\r\n * @class Query\r\n * @param {Collection} collection - The collection on which this query operates.\r\n */\r\nexport function Query (collection) {\r\n  classCallCheck(this, Query)\r\n\r\n  /**\r\n   * The collection on which this query operates.\r\n   * @type {Collection}\r\n   */\r\n  this.collection = collection\r\n  /**\r\n   * The data result of this query.\r\n   * @type {Array}\r\n   */\r\n  this.data = null\r\n}\r\n\r\nconst reserved = {\r\n  skip: '',\r\n  offset: '',\r\n  where: '',\r\n  limit: '',\r\n  orderBy: '',\r\n  sort: ''\r\n}\r\n\r\nconst escapeRegExp = /([.*+?^=!:${}()|[\\]\\/\\\\])/g\r\nconst percentRegExp = /%/g\r\nconst underscoreRegExp = /_/g\r\n\r\nfunction escape (pattern) {\r\n  return pattern.replace(escapeRegExp, '\\\\$1')\r\n}\r\n\r\nQuery.ops = {\r\n  '==': function (value, predicate) {\r\n    return value == predicate // eslint-disable-line\r\n  },\r\n  '===': function (value, predicate) {\r\n    return value === predicate\r\n  },\r\n  '!=': function (value, predicate) {\r\n    return value != predicate // eslint-disable-line\r\n  },\r\n  '!==': function (value, predicate) {\r\n    return value !== predicate\r\n  },\r\n  '>': function (value, predicate) {\r\n    return value > predicate\r\n  },\r\n  '>=': function (value, predicate) {\r\n    return value >= predicate\r\n  },\r\n  '<': function (value, predicate) {\r\n    return value < predicate\r\n  },\r\n  '<=': function (value, predicate) {\r\n    return value <= predicate\r\n  },\r\n  'isectEmpty': function (value, predicate) {\r\n    return !intersection((value || []), (predicate || [])).length\r\n  },\r\n  'isectNotEmpty': function (value, predicate) {\r\n    return intersection((value || []), (predicate || [])).length\r\n  },\r\n  'in': function (value, predicate) {\r\n    return predicate.indexOf(value) !== -1\r\n  },\r\n  'notIn': function (value, predicate) {\r\n    return predicate.indexOf(value) === -1\r\n  },\r\n  'contains': function (value, predicate) {\r\n    return (value || []).indexOf(predicate) !== -1\r\n  },\r\n  'notContains': function (value, predicate) {\r\n    return (value || []).indexOf(predicate) === -1\r\n  }\r\n}\r\n\r\naddHiddenPropsToTarget(Query.prototype, {\r\n  compare (orderBy, index, a, b) {\r\n    const def = orderBy[index]\r\n    let cA = get(a, def[0])\r\n    let cB = get(b, def[0])\r\n    if (cA && isString(cA)) {\r\n      cA = cA.toUpperCase()\r\n    }\r\n    if (cB && isString(cB)) {\r\n      cB = cB.toUpperCase()\r\n    }\r\n    a || (a = null)\r\n    b || (b = null)\r\n    if (def[1] === 'DESC') {\r\n      if (cB < cA) {\r\n        return -1\r\n      } else if (cB > cA) {\r\n        return 1\r\n      } else {\r\n        if (index < orderBy.length - 1) {\r\n          return this.compare(orderBy, index + 1, a, b)\r\n        } else {\r\n          return 0\r\n        }\r\n      }\r\n    } else {\r\n      if (cA < cB) {\r\n        return -1\r\n      } else if (cA > cB) {\r\n        return 1\r\n      } else {\r\n        if (index < orderBy.length - 1) {\r\n          return this.compare(orderBy, index + 1, a, b)\r\n        } else {\r\n          return 0\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  evaluate (value, op, predicate) {\r\n    if (Query.ops[op]) {\r\n      return Query.ops[op](value, predicate)\r\n    }\r\n    if (op.indexOf('like') === 0) {\r\n      return this.like(predicate, op.substr(4)).exec(value) !== null\r\n    } else if (op.indexOf('notLike') === 0) {\r\n      return this.like(predicate, op.substr(7)).exec(value) === null\r\n    }\r\n  },\r\n\r\n  like (pattern, flags) {\r\n    return new RegExp(`^${(escape(pattern).replace(percentRegExp, '.*').replace(underscoreRegExp, '.'))}$`, flags)\r\n  },\r\n\r\n  /**\r\n   * Return the current data result of this query.\r\n   * @memberof Query\r\n   * @instance\r\n   * @return {Array} The data in this query.\r\n   */\r\n  getData () {\r\n    if (!this.data) {\r\n      this.data = this.collection.index.getAll()\r\n    }\r\n    return this.data\r\n  },\r\n\r\n  /**\r\n   * Find all entities between two boundaries.\r\n   *\r\n   * Get the users ages 18 to 30\r\n   * ```js\r\n   * const users = query.between(18, 30, { index: 'age' }).run()\r\n   * ```\r\n   * Same as above\r\n   * ```js\r\n   * const users = query.between([18], [30], { index: 'age' }).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {Array} leftKeys - Keys defining the left boundary.\r\n   * @param {Array} rightKeys - Keys defining the right boundary.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.index] - Name of the secondary index to use in the\r\n   * query. If no index is specified, the main index is used.\r\n   * @param {boolean} [opts.leftInclusive=true] - Whether to include entities\r\n   * on the left boundary.\r\n   * @param {boolean} [opts.rightInclusive=false] - Whether to include entities\r\n   * on the left boundary.\r\n   * @param {boolean} [opts.limit] - Limit the result to a certain number.\r\n   * @param {boolean} [opts.offset] - The number of resulting entities to skip.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  between (leftKeys, rightKeys, opts) {\r\n    opts || (opts = {})\r\n    const collection = this.collection\r\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\r\n    if (this.data) {\r\n      throw new Error('Cannot access index after first operation!')\r\n    }\r\n    this.data = index.between(leftKeys, rightKeys, opts)\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Find the entity or entities that match the provided key.\r\n   *\r\n   * #### Example\r\n   *\r\n   * Get the entity whose primary key is 25\r\n   * ```js\r\n   * const entities = query.get(25).run()\r\n   * ```\r\n   * Same as above\r\n   * ```js\r\n   * const entities = query.get([25]).run()\r\n   * ```\r\n   * Get all users who are active and have the \"admin\" role\r\n   * ```js\r\n   * const activeAdmins = query.get(['active', 'admin'], {\r\n   *   index: 'activityAndRoles'\r\n   * }).run()\r\n   * ```\r\n   * Get all entities that match a certain weather condition\r\n   * ```js\r\n   * const niceDays = query.get(['sunny', 'humid', 'calm'], {\r\n   *   index: 'weatherConditions'\r\n   * }).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {Array} keyList - Key(s) defining the entity to retrieve. If\r\n   * `keyList` is not an array (i.e. for a single-value key), it will be\r\n   * wrapped in an array.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.string] - Name of the secondary index to use in the\r\n   * query. If no index is specified, the main index is used.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  get (keyList = [], opts) {\r\n    opts || (opts = {})\r\n    if (this.data) {\r\n      throw new Error('Cannot access index after first operation!')\r\n    }\r\n    if (keyList && !isArray(keyList)) {\r\n      keyList = [keyList]\r\n    }\r\n    if (!keyList.length) {\r\n      this.getData()\r\n      return this\r\n    }\r\n    const collection = this.collection\r\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\r\n    this.data = index.get(keyList)\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Find the entity or entities that match the provided keyLists.\r\n   *\r\n   * #### Example\r\n   *\r\n   * Get the posts where \"status\" is \"draft\" or \"inReview\"\r\n   * ```js\r\n   * const posts = query.getAll('draft', 'inReview', { index: 'status' }).run()\r\n   * ```\r\n   * Same as above\r\n   * ```js\r\n   * const posts = query.getAll(['draft'], ['inReview'], { index: 'status' }).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {...Array} [keyList] - Provide one or more keyLists, and all\r\n   * entities matching each keyList will be retrieved. If no keyLists are\r\n   * provided, all entities will be returned.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.index] - Name of the secondary index to use in the\r\n   * query. If no index is specified, the main index is used.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  getAll (...args) {\r\n    let opts = {}\r\n    if (this.data) {\r\n      throw new Error('Cannot access index after first operation!')\r\n    }\r\n    if (!args.length || args.length === 1 && isObject(args[0])) {\r\n      this.getData()\r\n      return this\r\n    } else if (args.length && isObject(args[args.length - 1])) {\r\n      opts = args[args.length - 1]\r\n      args.pop()\r\n    }\r\n    const collection = this.collection\r\n    const index = opts.index ? collection.indexes[opts.index] : collection.index\r\n    this.data = []\r\n    args.forEach(keyList => {\r\n      this.data = this.data.concat(index.get(keyList))\r\n    })\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Find the entity or entities that match the provided query or pass the\r\n   * provided filter function.\r\n   *\r\n   * #### Example\r\n   *\r\n   * Get the draft posts created less than three months\r\n   * ```js\r\n   * const posts = query.filter({\r\n   *   where: {\r\n   *     status: {\r\n   *       '==': 'draft'\r\n   *     },\r\n   *     created_at_timestamp: {\r\n   *       '>=': (new Date().getTime() - (1000 * 60 * 60 * 24 * 30 * 3)) // 3 months ago\r\n   *     }\r\n   *   }\r\n   * }).run()\r\n   * ```\r\n   * Use a custom filter function\r\n   * ```js\r\n   * const posts = query.filter(function (post) {\r\n   *   return post.isReady()\r\n   * }).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {(Object|Function)} [queryOrFn={}] - Selection query or filter\r\n   * function.\r\n   * @param {Function} [thisArg] - Context to which to bind `queryOrFn` if\r\n   * `queryOrFn` is a function.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  filter (query, thisArg) {\r\n    const self = this\r\n    query || (query = {})\r\n    self.getData()\r\n    if (isObject(query)) {\r\n      let where = {}\r\n      // Filter\r\n      if (isObject(query.where)) {\r\n        where = query.where\r\n      }\r\n      forOwn(query, function (value, key) {\r\n        if (!(key in reserved) && !(key in where)) {\r\n          where[key] = {\r\n            '==': value\r\n          }\r\n        }\r\n      })\r\n\r\n      const fields = []\r\n      const ops = []\r\n      const predicates = []\r\n      forOwn(where, function (clause, field) {\r\n        if (!isObject(clause)) {\r\n          clause = {\r\n            '==': clause\r\n          }\r\n        }\r\n        forOwn(clause, function (expr, op) {\r\n          fields.push(field)\r\n          ops.push(op)\r\n          predicates.push(expr)\r\n        })\r\n      })\r\n      if (fields.length) {\r\n        let i\r\n        let len = fields.length\r\n        self.data = self.data.filter(function (item) {\r\n          let first = true\r\n          let keep = true\r\n\r\n          for (i = 0; i < len; i++) {\r\n            let op = ops[i]\r\n            const isOr = op.charAt(0) === '|'\r\n            op = isOr ? op.substr(1) : op\r\n            const expr = self.evaluate(get(item, fields[i]), op, predicates[i])\r\n            if (expr !== undefined) {\r\n              keep = first ? expr : (isOr ? keep || expr : keep && expr)\r\n            }\r\n            first = false\r\n          }\r\n          return keep\r\n        })\r\n      }\r\n\r\n      // Sort\r\n      let orderBy = query.orderBy || query.sort\r\n\r\n      if (isString(orderBy)) {\r\n        orderBy = [\r\n          [orderBy, 'ASC']\r\n        ]\r\n      }\r\n      if (!isArray(orderBy)) {\r\n        orderBy = null\r\n      }\r\n\r\n      // Apply 'orderBy'\r\n      if (orderBy) {\r\n        let index = 0\r\n        orderBy.forEach(function (def, i) {\r\n          if (isString(def)) {\r\n            orderBy[i] = [def, 'ASC']\r\n          }\r\n        })\r\n        self.data.sort(function (a, b) {\r\n          return self.compare(orderBy, index, a, b)\r\n        })\r\n      }\r\n\r\n      // Skip\r\n      if (isNumber(query.skip)) {\r\n        self.skip(query.skip)\r\n      } else if (isNumber(query.offset)) {\r\n        self.skip(query.offset)\r\n      }\r\n      // Limit\r\n      if (isNumber(query.limit)) {\r\n        self.limit(query.limit)\r\n      }\r\n    } else if (isFunction(query)) {\r\n      self.data = self.data.filter(query, thisArg)\r\n    }\r\n    return self\r\n  },\r\n\r\n  /**\r\n   * Skip a number of results.\r\n   *\r\n   * #### Example\r\n   *\r\n   * Get all but the first 10 draft posts\r\n   * ```js\r\n   * const posts = query.get('draft', { index: 'status' }).skip(10).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {number} num - The number of entities to skip.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  skip (num) {\r\n    if (!isNumber(num)) {\r\n      throw new TypeError(`skip: Expected number but found ${typeof num}!`)\r\n    }\r\n    const data = this.getData()\r\n    if (num < data.length) {\r\n      this.data = data.slice(num)\r\n    } else {\r\n      this.data = []\r\n    }\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Limit the result.\r\n   *\r\n   * #### Example\r\n   *\r\n   * Get only the first 10 draft posts\r\n   * ```js\r\n   * const posts = query.get('draft', { index: 'status' }).limit(10).run()\r\n   * ```\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {number} num - The maximum number of entities to keep in the result.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  limit (num) {\r\n    if (!isNumber(num)) {\r\n      throw new TypeError(`limit: Expected number but found ${typeof num}!`)\r\n    }\r\n    const data = this.getData()\r\n    this.data = data.slice(0, Math.min(data.length, num))\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Iterate over all entities.\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {Function} forEachFn - Iteration function.\r\n   * @param {*} [thisArg] - Context to which to bind `forEachFn`.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  forEach (forEachFn, thisArg) {\r\n    this.getData().forEach(forEachFn, thisArg)\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Apply a mapping function to the result data.\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {Function} mapFn - Mapping function.\r\n   * @param {*} [thisArg] - Context to which to bind `mapFn`.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  map (mapFn, thisArg) {\r\n    this.data = this.getData().map(mapFn, thisArg)\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Return the result of calling the specified function on each item in this\r\n   * collection's main index.\r\n   * @memberof Query\r\n   * @instance\r\n   * @param {string} funcName - Name of function to call\r\n   * @parama {...*} [args] - Remaining arguments to be passed to the function.\r\n   * @return {Query} A reference to itself for chaining.\r\n   */\r\n  mapCall (funcName, ...args) {\r\n    this.data = this.getData().map(function (item) {\r\n      return item[funcName](...args)\r\n    })\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Complete the execution of the query and return the resulting data.\r\n   *\r\n   * @memberof Query\r\n   * @instance\r\n   * @return {Array} The result of executing this query.\r\n   */\r\n  run () {\r\n    const data = this.data\r\n    this.data = null\r\n    return data\r\n  }\r\n})\r\n","export function sort (a, b, hashCode) {\r\n  // Short-curcuit comparison if a and b are strictly equal\r\n  // This is absolutely necessary for indexed objects that\r\n  // don't have the idAttribute field\r\n  if (a === b) {\r\n    return 0\r\n  }\r\n  if (hashCode) {\r\n    a = hashCode(a)\r\n    b = hashCode(b)\r\n  }\r\n  if (a === null && b === null) {\r\n    return 0\r\n  }\r\n\r\n  if (a === null) {\r\n    return -1\r\n  }\r\n\r\n  if (b === null) {\r\n    return 1\r\n  }\r\n\r\n  if (a < b) {\r\n    return -1\r\n  }\r\n\r\n  if (a > b) {\r\n    return 1\r\n  }\r\n\r\n  return 0\r\n}\r\n\r\nexport function insertAt (array, index, value) {\r\n  array.splice(index, 0, value)\r\n  return array\r\n}\r\n\r\nexport function removeAt (array, index) {\r\n  array.splice(index, 1)\r\n  return array\r\n}\r\n\r\nexport function binarySearch (array, value, field) {\r\n  let lo = 0\r\n  let hi = array.length\r\n  let compared\r\n  let mid\r\n\r\n  while (lo < hi) {\r\n    mid = ((lo + hi) / 2) | 0\r\n    compared = sort(value, array[mid], field)\r\n    if (compared === 0) {\r\n      return {\r\n        found: true,\r\n        index: mid\r\n      }\r\n    } else if (compared < 0) {\r\n      hi = mid\r\n    } else {\r\n      lo = mid + 1\r\n    }\r\n  }\r\n\r\n  return {\r\n    found: false,\r\n    index: hi\r\n  }\r\n}\r\n","// Copyright (c) 2015, InternalFX.\r\n\r\n// Permission to use, copy, modify, and/or distribute this software for any purpose with or\r\n// without fee is hereby granted, provided that the above copyright notice and this permission\r\n// notice appear in all copies.\r\n\r\n// THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO\r\n// THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT\r\n// SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR\r\n// ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION\r\n// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE\r\n// USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n// Modifications\r\n// Copyright 2015 Jason Dobry\r\n//\r\n// Summary of modifications:\r\n// Converted to ES6 Class syntax\r\n// Reworked dependencies so as to re-use code already in js-data\r\nimport {\r\n  addHiddenPropsToTarget,\r\n  classCallCheck,\r\n  copy,\r\n  fillIn,\r\n  forOwn,\r\n  isArray,\r\n  isFunction\r\n} from '../../src/utils'\r\nimport {binarySearch, insertAt, removeAt} from './utils'\r\n\r\nconst blacklist = { '>': 1, '>=': 1, '<': 1, '<=': 1 }\r\n\r\nexport function Index (fieldList, opts) {\r\n  classCallCheck(this, Index)\r\n  fieldList || (fieldList = [])\r\n\r\n  if (!isArray(fieldList)) {\r\n    throw new Error('fieldList must be an array.')\r\n  }\r\n\r\n  opts || (opts = {})\r\n  this.fieldList = fieldList\r\n  this.fieldGetter = opts.fieldGetter\r\n  this.hashCode = opts.hashCode\r\n  this.isIndex = true\r\n  this.keys = []\r\n  this.values = []\r\n}\r\n\r\naddHiddenPropsToTarget(Index.prototype, {\r\n  set (keyList, value) {\r\n    if (!isArray(keyList)) {\r\n      keyList = [keyList]\r\n    }\r\n\r\n    let key = keyList.shift() || null\r\n    let pos = binarySearch(this.keys, key)\r\n\r\n    if (keyList.length === 0) {\r\n      if (pos.found) {\r\n        let dataLocation = binarySearch(this.values[pos.index], value, this.hashCode)\r\n        if (!dataLocation.found) {\r\n          insertAt(this.values[pos.index], dataLocation.index, value)\r\n        }\r\n      } else {\r\n        insertAt(this.keys, pos.index, key)\r\n        insertAt(this.values, pos.index, [value])\r\n      }\r\n    } else {\r\n      if (pos.found) {\r\n        this.values[pos.index].set(keyList, value)\r\n      } else {\r\n        insertAt(this.keys, pos.index, key)\r\n        let newIndex = new Index([], { hashCode: this.hashCode })\r\n        newIndex.set(keyList, value)\r\n        insertAt(this.values, pos.index, newIndex)\r\n      }\r\n    }\r\n  },\r\n\r\n  get (keyList) {\r\n    if (!isArray(keyList)) {\r\n      keyList = [keyList]\r\n    }\r\n\r\n    let key = keyList.shift() || null\r\n    let pos = binarySearch(this.keys, key)\r\n\r\n    if (keyList.length === 0) {\r\n      if (pos.found) {\r\n        if (this.values[pos.index].isIndex) {\r\n          return this.values[pos.index].getAll()\r\n        } else {\r\n          return this.values[pos.index]\r\n        }\r\n      } else {\r\n        return []\r\n      }\r\n    } else {\r\n      if (pos.found) {\r\n        return this.values[pos.index].get(keyList)\r\n      } else {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n\r\n  getAll () {\r\n    let results = []\r\n    this.values.forEach(function (value) {\r\n      if (value.isIndex) {\r\n        results = results.concat(value.getAll())\r\n      } else {\r\n        results = results.concat(value)\r\n      }\r\n    })\r\n    return results\r\n  },\r\n\r\n  visitAll (cb, thisArg) {\r\n    this.values.forEach(function (value) {\r\n      if (value.isIndex) {\r\n        value.visitAll(cb, thisArg)\r\n      } else {\r\n        value.forEach(cb, thisArg)\r\n      }\r\n    })\r\n  },\r\n\r\n  query (query) {\r\n    let leftKeys\r\n    let rightKeys\r\n\r\n    if (query['>']) {\r\n      leftKeys = query['>']\r\n      query.leftInclusive = false\r\n    } else if (query['>=']) {\r\n      leftKeys = query['>=']\r\n      query.leftInclusive = true\r\n    }\r\n\r\n    if (query['<']) {\r\n      rightKeys = query['<']\r\n      query.rightInclusive = false\r\n    } else if (query['<=']) {\r\n      rightKeys = query['<=']\r\n      query.rightInclusive = true\r\n    }\r\n\r\n    if (leftKeys.length !== rightKeys.length) {\r\n      throw new Error('Key arrays must be same length')\r\n    }\r\n\r\n    const _opts = {}\r\n    forOwn(query, function (value, key) {\r\n      if (!blacklist[key]) {\r\n        _opts[key] = value\r\n      }\r\n    })\r\n    return this.between(leftKeys, rightKeys, _opts)\r\n  },\r\n\r\n  between (leftKeys, rightKeys, opts = {}) {\r\n    if (!isArray(leftKeys)) {\r\n      leftKeys = [leftKeys]\r\n    }\r\n    if (!isArray(rightKeys)) {\r\n      rightKeys = [rightKeys]\r\n    }\r\n    fillIn(opts, {\r\n      leftInclusive: true,\r\n      rightInclusive: false,\r\n      limit: undefined,\r\n      offset: 0\r\n    })\r\n\r\n    let results = this._between(leftKeys, rightKeys, opts)\r\n\r\n    if (opts.limit) {\r\n      return results.slice(opts.offset, opts.limit + opts.offset)\r\n    } else {\r\n      return results.slice(opts.offset)\r\n    }\r\n  },\r\n\r\n  _between (leftKeys, rightKeys, opts) {\r\n    let results = []\r\n\r\n    let leftKey = leftKeys.shift()\r\n    let rightKey = rightKeys.shift()\r\n\r\n    let pos\r\n\r\n    if (leftKey !== undefined) {\r\n      pos = binarySearch(this.keys, leftKey)\r\n    } else {\r\n      pos = {\r\n        found: false,\r\n        index: 0\r\n      }\r\n    }\r\n\r\n    if (leftKeys.length === 0) {\r\n      if (pos.found && opts.leftInclusive === false) {\r\n        pos.index += 1\r\n      }\r\n\r\n      for (let i = pos.index; i < this.keys.length; i += 1) {\r\n        if (rightKey !== undefined) {\r\n          if (opts.rightInclusive) {\r\n            if (this.keys[i] > rightKey) { break }\r\n          } else {\r\n            if (this.keys[i] >= rightKey) { break }\r\n          }\r\n        }\r\n\r\n        if (this.values[i].isIndex) {\r\n          results = results.concat(this.values[i].getAll())\r\n        } else {\r\n          results = results.concat(this.values[i])\r\n        }\r\n\r\n        if (opts.limit) {\r\n          if (results.length >= (opts.limit + opts.offset)) {\r\n            break\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      for (let i = pos.index; i < this.keys.length; i += 1) {\r\n        let currKey = this.keys[i]\r\n        if (currKey > rightKey) { break }\r\n\r\n        if (this.values[i].isIndex) {\r\n          if (currKey === leftKey) {\r\n            results = results.concat(this.values[i]._between(copy(leftKeys), rightKeys.map(function () { return undefined }), opts))\r\n          } else if (currKey === rightKey) {\r\n            results = results.concat(this.values[i]._between(leftKeys.map(function () { return undefined }), copy(rightKeys), opts))\r\n          } else {\r\n            results = results.concat(this.values[i].getAll())\r\n          }\r\n        } else {\r\n          results = results.concat(this.values[i])\r\n        }\r\n\r\n        if (opts.limit) {\r\n          if (results.length >= (opts.limit + opts.offset)) {\r\n            break\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (opts.limit) {\r\n      return results.slice(0, opts.limit + opts.offset)\r\n    } else {\r\n      return results\r\n    }\r\n  },\r\n\r\n  peek () {\r\n    if (this.values.length) {\r\n      if (this.values[0].isIndex) {\r\n        return this.values[0].peek()\r\n      } else {\r\n        return this.values[0]\r\n      }\r\n    }\r\n    return []\r\n  },\r\n\r\n  remove (keyList, value) {\r\n    if (!isArray(keyList)) {\r\n      keyList = [keyList]\r\n    }\r\n\r\n    let key = keyList.shift()\r\n    let pos = binarySearch(this.keys, key)\r\n\r\n    if (keyList.length === 0) {\r\n      if (pos.found) {\r\n        let dataLocation = binarySearch(this.values[pos.index], value, this.hashCode)\r\n        if (dataLocation.found) {\r\n          removeAt(this.values[pos.index], dataLocation.index)\r\n          if (this.values[pos.index].length === 0) {\r\n            removeAt(this.keys, pos.index)\r\n            removeAt(this.values, pos.index)\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      if (pos.found) {\r\n        this.values[pos.index].delete(keyList, value)\r\n      }\r\n    }\r\n  },\r\n\r\n  clear () {\r\n    this.keys = []\r\n    this.values = []\r\n  },\r\n\r\n  insertRecord (data) {\r\n    let keyList = this.fieldList.map(function (field) {\r\n      if (isFunction(field)) {\r\n        return field(data) || null\r\n      } else {\r\n        return data[field] || null\r\n      }\r\n    })\r\n    this.set(keyList, data)\r\n  },\r\n\r\n  removeRecord (data) {\r\n    let removed\r\n    this.values.forEach((value, i) => {\r\n      if (value.isIndex) {\r\n        if (value.removeRecord(data)) {\r\n          if (value.keys.length === 0) {\r\n            removeAt(this.keys, i)\r\n            removeAt(this.values, i)\r\n          }\r\n          removed = true\r\n          return false\r\n        }\r\n      } else {\r\n        const dataLocation = binarySearch(value, data, this.hashCode)\r\n        if (dataLocation.found) {\r\n          removeAt(value, dataLocation.index)\r\n          if (value.length === 0) {\r\n            removeAt(this.keys, i)\r\n            removeAt(this.values, i)\r\n          }\r\n          removed = true\r\n          return false\r\n        }\r\n      }\r\n    })\r\n    return removed ? data : undefined\r\n  },\r\n\r\n  updateRecord (data) {\r\n    this.removeRecord(data)\r\n    this.insertRecord(data)\r\n  }\r\n})\r\n","import {Query} from './query'\r\nimport {\r\n  _,\r\n  addHiddenPropsToTarget,\r\n  classCallCheck,\r\n  deepMixIn,\r\n  eventify,\r\n  fillIn,\r\n  forOwn,\r\n  get,\r\n  isArray,\r\n  isFunction,\r\n  isObject,\r\n  isSorN,\r\n  isString,\r\n  set,\r\n  uuid\r\n} from '../utils'\r\nimport {Index} from '../../lib/mindex/index'\r\n\r\n/**\r\n * Holds a set of Model instances. Use a Collection to store and manage\r\n * instances of Model.\r\n *\r\n * ```javascript\r\n * import {Collection, Model} from 'js-data'\r\n * class User extends Model {}\r\n * const UserCollection = new Collection({ model: User })\r\n * const OtherUserCollection = new Collection([{ id: 1 }, { id: 2 }], { model: User })\r\n * ```\r\n *\r\n * @class Collection\r\n * @param {Model[]} [models=[]] - Initial set of models to insert into the\r\n * collection.\r\n * @param {Object} [opts] - Configuration options.\r\n * @param {boolean} [opts.autoPk=false]\r\n * @param {string} [opts.idAttribute]\r\n * @param {Model} [opts.model] - Reference to the Model type that will be stored\r\n * by this Collection.\r\n * @param {Object} [opts.modelOpts={}]\r\n * @param {string} [opts.onConflict=merge]\r\n */\r\nexport function Collection (models, opts) {\r\n  const self = this\r\n\r\n  classCallCheck(self, Collection)\r\n\r\n  if (isObject(models) && !isArray(models)) {\r\n    opts = models\r\n    models = []\r\n  }\r\n\r\n  // Default values for arguments\r\n  models || (models = [])\r\n  opts || (opts = {})\r\n\r\n  /**\r\n   * Reference to this Collection's Model.\r\n   *\r\n   * @name Collection#model\r\n   * @type {Model}\r\n   */\r\n  self.model = opts.model\r\n\r\n  // Re-emit any events emitted by this Collection's model.\r\n  if (self.model) {\r\n    self.model.on('all', self._onModelEvent, self)\r\n  }\r\n\r\n  /**\r\n   * AutoPk.\r\n   *\r\n   * @name Collection#autoPk\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  self.autoPk = opts.autoPk === undefined ? false : opts.autoPk\r\n\r\n  /**\r\n   * Field to be used as the unique identifier for models in this collection.\r\n   * Defaults to `\"id\"` unless {@link Collection#model} is set, in which case\r\n   * this will default to {@link Model.idAttribute}.\r\n   *\r\n   * @name Collection#idAttribute\r\n   * @type {string}\r\n   */\r\n  self.idAttribute = opts.idAttribute\r\n\r\n  /**\r\n   * Any options set here will override any options of {@link Collection#model}.\r\n   * Useful for making multiple collection that use the same Model in different\r\n   * ways.\r\n   *\r\n   * @name Collection#modelOpts\r\n   * @type {Object}\r\n   * @default {}\r\n   */\r\n  self.modelOpts = opts.modelOpts || {}\r\n\r\n  /**\r\n   * Event listeners attached to this Collection.\r\n   *\r\n   * @name Collection#_listeners\r\n   * @instance\r\n   * @type {Model}\r\n   * @private\r\n   */\r\n  self._listeners = {}\r\n\r\n  /**\r\n   * What to do when inserting a model into this Collection that shares a\r\n   * primary key with a model already in this Collection.\r\n   *\r\n   * Possible values:\r\n   * - merge\r\n   * - replace\r\n   *\r\n   * Merge:\r\n   *\r\n   * Recursively shallow copy properties from the new model onto the existing\r\n   * model.\r\n   *\r\n   * Replace:\r\n   *\r\n   * Shallow copy top-level properties from the new model onto the existing model.\r\n   * Any top-level own properties of the existing model that are _not_ on the new\r\n   * model will be removed.\r\n   *\r\n   * @name Collection#onConflict\r\n   * @type {string}\r\n   * @default merge\r\n   */\r\n  self.onConflict = opts.onConflict || 'merge'\r\n\r\n  const idAttribute = self.modelId()\r\n\r\n  /**\r\n   * The main index, which uses @{link Collection#modelId} as the key.\r\n   * @name Collection#index\r\n   * @type {Index}\r\n   */\r\n  self.index = new Index([idAttribute], {\r\n    hashCode (obj) {\r\n      return get(obj, idAttribute)\r\n    }\r\n  })\r\n\r\n  /**\r\n   * Object that holds the secondary indexes of this collection.\r\n   * @name Collection#indexes\r\n   * @type {Object.<string, Index>}\r\n   */\r\n  self.indexes = {}\r\n\r\n  /**\r\n   * Object that holds the timestamps of when models were added to this\r\n   * collection.\r\n   * @name Collection#added\r\n   * @type {Object.<number, Model>}\r\n   */\r\n  self.added = {}\r\n\r\n  /**\r\n   * Object that holds the autoPks of models which needed ids to be generated.\r\n   * @name Collection#autoPks\r\n   * @type {Object.<number, Model>}\r\n   */\r\n  self.autoPks = {}\r\n\r\n  self.createIndex('addedTimestamps', ['$'], {\r\n    fieldGetter (obj) {\r\n      return self.added[get(obj, idAttribute)]\r\n    }\r\n  })\r\n  models.forEach(function (model) {\r\n    self.index.insertRecord(model)\r\n    if (model && isFunction(model.on)) {\r\n      model.on('all', self._onModelEvent, self)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * TODO\r\n *\r\n * @name Collection#on\r\n * @instance\r\n * @method\r\n * @param {string} event - TODO.\r\n * @param {Function} handler - TODO\r\n */\r\n\r\n /**\r\n * TODO\r\n *\r\n * @name Collection#off\r\n * @instance\r\n * @method\r\n * @param {string} [event] - TODO.\r\n * @param {Function} [handler] - TODO\r\n */\r\n\r\n /**\r\n * TODO\r\n *\r\n * @name Collection#emit\r\n * @instance\r\n * @method\r\n * @param {string} event - TODO.\r\n * @param {...*} [arg] - TODO\r\n */\r\n\r\naddHiddenPropsToTarget(Collection.prototype, {\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @private\r\n   * @param {Object} data - TODO.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   */\r\n  _end (data, opts) {\r\n    const self = this\r\n    if (opts.raw) {\r\n      if (opts.autoAdd) {\r\n        data.data = self.add(data.data, opts)\r\n      }\r\n      return data\r\n    } else if (opts.autoAdd) {\r\n      data = self.add(data, opts)\r\n    }\r\n    return data\r\n  },\r\n\r\n  /**\r\n   * Used to bind to events emitted by this Collection's Model or models in this\r\n   * Collection.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @private\r\n   * @param {...*} [arg] - Args passed to {@link Collection#emit}.\r\n   */\r\n  _onModelEvent (...args) {\r\n    this.emit(...args)\r\n  },\r\n\r\n  /**\r\n   * Insert the provided model or models.\r\n   *\r\n   * If a model is already in the collection then the provided model will\r\n   * either merge with or replace the existing model based on the value of the\r\n   * `onConflict` option.\r\n   *\r\n   * The collection's secondary indexes will be updated as each entity is\r\n   * visited.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(Object|Object[]|Model|Model[])} data - The model or models to insert.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.autoPk={@link Collection.autoPk}] - Whether to\r\n   * generate primary keys for the models to be inserted. Useful for inserting\r\n   * temporary, unsaved data into the collection.\r\n   * @param {string} [opts.onConflict] - What to do when a model is already in\r\n   * the collection. Possible values are `merge` or `replace`.\r\n   * @return {(Model|Model[])} The added model or models.\r\n   */\r\n  add (models, opts) {\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Collection's configuration\r\n    _(self, opts)\r\n    models = self.beforeAdd(models, opts) || models\r\n\r\n    // Track whether just one or an array of models is being inserted\r\n    let singular = false\r\n    const idAttribute = self.modelId()\r\n    const relationList = self.model ? self.model.relationList || [] : []\r\n    const timestamp = new Date().getTime()\r\n    if (!isArray(models)) {\r\n      models = [models]\r\n      singular = true\r\n    }\r\n\r\n    // Map the provided models to existing models.\r\n    // New models will be inserted. If any props map to existing models,\r\n    // they will be merged into the existing models according to the onConflict\r\n    // option.\r\n    models = models.map(function (props) {\r\n      let id = self.modelId(props)\r\n      // Track whether we had to generate an id for this model\r\n      // Validate that the primary key attached to the model is a string or\r\n      // number\r\n      let autoPk = false\r\n      if (!isSorN(id)) {\r\n        // No id found, generate one\r\n        if (opts.autoPk) {\r\n          id = uuid()\r\n          set(props, idAttribute, id)\r\n          autoPk = true\r\n        } else {\r\n          // Not going to generate one, throw an error\r\n          throw new TypeError(`${idAttribute}: Expected string or number, found ${typeof id}!`)\r\n        }\r\n      }\r\n      // Grab existing model if there is one\r\n      const existing = self.get(id)\r\n      // If the currently visited props are just reference to the existing\r\n      // model, then there is nothing to be done. Exit early.\r\n      if (props === existing) {\r\n        return existing\r\n      }\r\n\r\n      // Check the currently visited props for relations that need to be\r\n      // inserted as well\r\n      relationList.forEach(function (def) {\r\n        // A reference to the Model that this Model is related to\r\n        const Relation = def.getRelation()\r\n        if (!Relation.idAttribute) {\r\n          return\r\n        }\r\n        // The field used by the related Model as the primary key\r\n        const relationIdAttribute = Relation.idAttribute\r\n        // Grab the foreign key in this relationship, if there is one\r\n        const foreignKey = def.foreignKey\r\n\r\n        // Grab a reference to the related data attached or linked to the\r\n        // currently visited props\r\n        let toInsert = get(props, def.getLocalField())\r\n\r\n        // If the user provided a custom insertion function for this relation,\r\n        // call it\r\n        if (isFunction(def.add)) {\r\n          def.add(self, def, props)\r\n        } else if (toInsert && def.add !== false) {\r\n          // Otherwise, if there is something to be added, add it\r\n          if (isArray(toInsert)) {\r\n            // Handle inserting hasMany relations\r\n            toInsert = toInsert.map(function (toInsertItem) {\r\n              // Check that this item isn't the same item that is already in the\r\n              // store\r\n              if (!Relation.is(toInsertItem)) {\r\n                try {\r\n                  // Make sure this item has its foreignKey\r\n                  if (foreignKey) {\r\n                    set(toInsertItem, foreignKey, id)\r\n                  }\r\n                  // Finally add this related item\r\n                  toInsertItem = Relation.createInstance(toInsertItem)\r\n                } catch (err) {\r\n                  throw new Error(`Failed to insert ${def.type} relation: \"${def.relation}\"! ${err.message}`)\r\n                }\r\n              }\r\n              return toInsertItem\r\n            })\r\n            // If it's the parent that has the localKeys\r\n            if (def.localKeys) {\r\n              set(props, def.localKeys, toInsert.map(function (inserted) {\r\n                return get(inserted, relationIdAttribute)\r\n              }))\r\n            }\r\n          } else {\r\n            // Handle inserting belongsTo and hasOne relations\r\n            if (!Relation.is(toInsert)) {\r\n              try {\r\n                // Make sure this item has its foreignKey\r\n                if (foreignKey) {\r\n                  set(toInsert, def.foreignKey, id)\r\n                }\r\n                // Finally insert this related item\r\n                toInsert = Relation.createInstance(toInsert)\r\n              } catch (err) {\r\n                throw new Error(`Failed to insert ${def.type} relation: \"${def.relation}\"!`)\r\n              }\r\n            }\r\n          }\r\n        }\r\n        set(props, def.localField, toInsert)\r\n      })\r\n\r\n      if (existing) {\r\n        // Here, the currently visited props corresponds to an entity already\r\n        // in the collection, so we need to merge them\r\n        const onConflict = opts.onConflict || self.onConflict\r\n        if (onConflict === 'merge') {\r\n          deepMixIn(existing, props)\r\n        } else if (onConflict === 'replace') {\r\n          forOwn(existing, (value, key) => {\r\n            if (key !== idAttribute && !props.hasOwnProperty(key)) {\r\n              delete existing[key]\r\n            }\r\n          })\r\n          existing.set(props)\r\n        }\r\n        props = existing\r\n        // Update all indexes in the collection\r\n        self.updateIndexes(props)\r\n      } else {\r\n        // Here, the currently visted props does not correspond to any model\r\n        // in the collection, so make this props is an instance of this Model\r\n        // and insert it into the collection\r\n        props = self.model ? self.model.createInstance(props) : props\r\n        self.index.insertRecord(props)\r\n        forOwn(self.indexes, function (index, name) {\r\n          index.insertRecord(props)\r\n        })\r\n        if (props && isFunction(props.on)) {\r\n          props.on('all', self._onModelEvent, self)\r\n          self.emit('add', props)\r\n        }\r\n      }\r\n      // Track when this model was added\r\n      self.added[id] = timestamp\r\n      if (autoPk) {\r\n        self.autoPks[id] = props\r\n      }\r\n      return props\r\n    })\r\n    // Finally, return the inserted data\r\n    const result = singular ? (models.length ? models[0] : undefined) : models\r\n    return self.afterAdd(models, opts, result) || result\r\n  },\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#add}. If this method returns a\r\n   * value then {@link Collection#add} will return that same value.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(Model|Model[])} result - The model or models that were added to\r\n   * this Collection by {@link Collection#add}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#add}.\r\n   */\r\n  afterAdd () {},\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#remove}. If this method returns\r\n   * a value then {@link Collection#remove} will return that same value.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Collection#remove}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#remove}.\r\n   * @param {Object} model - The result that will be returned by {@link Collection#remove}.\r\n   */\r\n  afterRemove () {},\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#removeAll}. If this method\r\n   * returns a value then {@link Collection#removeAll} will return that same\r\n   * value.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} query - The `query` argument passed to {@link Collection#removeAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#removeAll}.\r\n   * @param {Object} models - The result that will be returned by {@link Collection#removeAll}.\r\n   */\r\n  afterRemoveAll () {},\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#add}. If this method returns a\r\n   * value then the `models` argument in {@link Collection#add} will be\r\n   * re-assigned to the returned value.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(Model|Model[])} models - The `models` argument passed to {@link Collection#add}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#add}.\r\n   */\r\n  beforeAdd () {},\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#remove}.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Collection#remove}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#remove}.\r\n   */\r\n  beforeRemove () {},\r\n\r\n  /**\r\n   * Lifecycle hook called by {@link Collection#removeAll}.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} query - The `query` argument passed to {@link Collection#removeAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Collection#removeAll}.\r\n   */\r\n  beforeRemoveAll () {},\r\n\r\n  /**\r\n   * Find all entities between two boundaries.\r\n   *\r\n   * Shortcut for `collection.query().between(18, 30, { index: 'age' }).run()`\r\n   *\r\n   * Get all users ages 18 to 30:\r\n   * ```javascript\r\n   * const users = collection.between(18, 30, { index: 'age' })\r\n   * ```\r\n   * Same as above:\r\n   * ```javascript\r\n   * const users = collection.between([18], [30], { index: 'age' })\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Array} leftKeys - Keys defining the left boundary.\r\n   * @param {Array} rightKeys - Keys defining the right boundary.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.index] - Name of the secondary index to use in the\r\n   * query. If no index is specified, the main index is used.\r\n   * @param {boolean} [opts.leftInclusive=true] - Whether to include entities\r\n   * on the left boundary.\r\n   * @param {boolean} [opts.rightInclusive=false] - Whether to include entities\r\n   * on the left boundary.\r\n   * @param {boolean} [opts.limit] - Limit the result to a certain number.\r\n   * @param {boolean} [opts.offset] - The number of resulting entities to skip.\r\n   * @return {Array} The result.\r\n   */\r\n  between (leftKeys, rightKeys, opts) {\r\n    return this.query().between(leftKeys, rightKeys, opts).run()\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} props - Passed to {@link Model.create}.\r\n   * @param {Object} [opts] - Passed to {@link Model.create}. See\r\n   * {@link Model.create} for more configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  create (props, opts) {\r\n    const self = this\r\n    const id = self.modelId(props)\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.create(props, opts).then(function (data) {\r\n      // If the created model was already in this Collection via an autoPk id,\r\n      // remove it from the collection\r\n      // TODO: Fix this?\r\n      if (self.autoPks[id]) {\r\n        self.remove(id)\r\n      }\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Create a new secondary index on the contents of the collection.\r\n   *\r\n   * Index users by age:\r\n   * ```javascript\r\n   * collection.createIndex('age')\r\n   * ```\r\n   * Index users by status and role:\r\n   * ```javascript\r\n   * collection.createIndex('statusAndRole', ['status', 'role'])\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {string} name - The name of the new secondary index.\r\n   * @param {string[]} [fieldList] - Array of field names to use as the key or\r\n   * compound key of the new secondary index. If no fieldList is provided, then\r\n   * the name will also be the field that is used to index the collection.\r\n   * @return {Collection} A reference to itself for chaining.\r\n   */\r\n  createIndex (name, fieldList, opts) {\r\n    const self = this\r\n    if (isString(name) && fieldList === undefined) {\r\n      fieldList = [name]\r\n    }\r\n    opts || (opts = {})\r\n    opts.hashCode = opts.hashCode || function (obj) {\r\n      return self.modelId(obj)\r\n    }\r\n    const index = self.indexes[name] = new Index(fieldList, opts)\r\n    self.index.visitAll(index.insertRecord, index)\r\n    return self\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Array} models - Passed to {@link Model.createMany}.\r\n   * @param {Object} [opts] - Passed to {@link Model.createMany}. See\r\n   * {@link Model.createMany} for more configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  createMany (models, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.createMany(models, opts).then(function (data) {\r\n      // If the created models were already in this Collection via an autoPk\r\n      // id, remove them from the Collection\r\n      // TODO: Fix this?\r\n      models.forEach(function (model) {\r\n        const id = self.modelId(model)\r\n        if (self.autoPks[id]) {\r\n          self.remove(id)\r\n        }\r\n      })\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - Passed to {@link Model.destroy}.\r\n   * @param {Object} [opts] - Passed to {@link Model.destroy}. See\r\n   * {@link Model.destroy} for more configuration options.\r\n   * @return {Promise}\r\n   */\r\n  destroy (id, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.destroy(id, opts).then(function (data) {\r\n      if (opts.raw) {\r\n        data.data = self.remove(id, opts)\r\n      } else {\r\n        data = self.remove(id, opts)\r\n      }\r\n      return data\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} [query] - Passed to {@link Model.destroyAll}.\r\n   * @param {Object} [opts] - Passed to {@link Model.destroyAll}. See\r\n   * {@link Model.destroyAll} for more configuration options.\r\n   * @return {Promise}\r\n   */\r\n  destroyAll (query, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.destroyAll(query, opts).then(function (data) {\r\n      if (opts.raw) {\r\n        data.data = self.removeAll(query, opts)\r\n      } else {\r\n        data = self.removeAll(query, opts)\r\n      }\r\n      return data\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Find the entity or entities that match the provided query or pass the\r\n   * provided filter function.\r\n   *\r\n   * Shortcut for `collection.query().filter(queryOrFn[, thisArg]).run()`\r\n   *\r\n   * Get the draft posts created less than three months:\r\n   * ```javascript\r\n   * const posts = collection.filter({\r\n   *   where: {\r\n   *     status: {\r\n   *       '==': 'draft'\r\n   *     },\r\n   *     created_at_timestamp: {\r\n   *       '>=': (new Date().getTime() - (1000 * 60 * 60 * 24 * 30 * 3)) // 3 months ago\r\n   *     }\r\n   *   }\r\n   * })\r\n   * ```\r\n   * Use a custom filter function:\r\n   * ```javascript\r\n   * const posts = collection.filter(function (post) {\r\n   *   return post.isReady()\r\n   * })\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(Object|Function)} [queryOrFn={}] - Selection query or filter\r\n   * function.\r\n   * @param {Object} [thisArg] - Context to which to bind `queryOrFn` if\r\n   * `queryOrFn` is a function.\r\n   * @return {Array} The result.\r\n   */\r\n  filter (query, thisArg) {\r\n    return this.query().filter(query, thisArg).run()\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - Passed to {@link Model.find}.\r\n   * @param {Object} [opts] - Passed to {@link Model.find}.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  find (id, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.find(id, opts).then(function (data) {\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} [query] - Passed to {@link Model.findAll}.\r\n   * @param {Object} [opts] - Passed to {@link Model.findAll}.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  findAll (query, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.findAll(query, opts).then(function (data) {\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Iterate over all entities.\r\n   *\r\n   * ```javascript\r\n   * collection.forEach(function (entity) {\r\n   *   // do something\r\n   * })\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Function} forEachFn - Iteration function.\r\n   * @param {*} [thisArg] - Context to which to bind `forEachFn`.\r\n   * @return {Array} The result.\r\n   */\r\n  forEach (cb, thisArg) {\r\n    this.index.visitAll(cb, thisArg)\r\n  },\r\n\r\n  /**\r\n   * Get the model with the given id.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - The primary key of the model to get.\r\n   * @return {Model} The model with the given id.\r\n   */\r\n  get (id) {\r\n    const instances = this.query().get(id).run()\r\n    return instances.length ? instances[0] : undefined\r\n  },\r\n\r\n  /**\r\n   * Find the entity or entities that match the provided keyLists.\r\n   *\r\n   * Shortcut for `collection.query().getAll(keyList1, keyList2, ...).run()`\r\n   *\r\n   * Get the posts where \"status\" is \"draft\" or \"inReview\":\r\n   * ```javascript\r\n   * const posts = collection.getAll('draft', 'inReview', { index: 'status' })\r\n   * ```\r\n   * Same as above:\r\n   * ```javascript\r\n   * const posts = collection.getAll(['draft'], ['inReview'], { index: 'status' })\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {...Array} [keyList] - Provide one or more keyLists, and all\r\n   * entities matching each keyList will be retrieved. If no keyLists are\r\n   * provided, all entities will be returned.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.index] - Name of the secondary index to use in the\r\n   * query. If no index is specified, the main index is used.\r\n   * @return {Array} The result.\r\n   */\r\n  getAll (...args) {\r\n    return this.query().getAll(...args).run()\r\n  },\r\n\r\n  /**\r\n   * Return the entities in this Collection that have a primary key that\r\n   * was automatically generated when they were inserted.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @return {Model[]} The models that have autoPks.\r\n   */\r\n  getAutoPkItems () {\r\n    const self = this\r\n    return self.getAll().filter(function (model) {\r\n      return self.autoPks[self.modelId(model)]\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Limit the result.\r\n   *\r\n   * Shortcut for `collection.query().limit(maximumNumber).run()`\r\n   *\r\n   * ```javascript\r\n   * const posts = collection.limit(10)\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {number} num - The maximum number of entities to keep in the result.\r\n   * @return {Array} The result.\r\n   */\r\n  limit (num) {\r\n    return this.query().limit(num).run()\r\n  },\r\n\r\n  /**\r\n   * Apply a mapping function to all entities.\r\n   *\r\n   * ```javascript\r\n   * const names = collection.map(function (user) {\r\n   *   return user.name\r\n   * })\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Function} mapFn - Mapping function.\r\n   * @param {*} [thisArg] - Context to which to bind `mapFn`.\r\n   * @return {Array} The result of the mapping.\r\n   */\r\n  map (cb, thisArg) {\r\n    const data = []\r\n    this.index.visitAll(function (value) {\r\n      data.push(cb.call(thisArg, value))\r\n    })\r\n    return data\r\n  },\r\n\r\n  /**\r\n   * Return the result of calling the specified function on each item in this\r\n   * collection's main index.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {string} funcName - Name of function to call\r\n   * @parama {...*} [args] - Remaining arguments to be passed to the function.\r\n   * @return {Array} The result.\r\n   */\r\n  mapCall (funcName, ...args) {\r\n    const data = []\r\n    this.index.visitAll(function (item) {\r\n      data.push(item[funcName](...args))\r\n    })\r\n    return data\r\n  },\r\n\r\n  /**\r\n   * Return the primary key of the given, or if no model is provided, return the\r\n   * name of the field that holds the primary key of models in this Collection.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Model} [model] - The model whose primary key is to be returned.\r\n   * @return {(string|number)} - Primary key or name of field that holds primary\r\n   * key.\r\n   */\r\n  modelId (model) {\r\n    const self = this\r\n    if (!model) {\r\n      return self.model ? self.model.idAttribute : self.idAttribute || 'id'\r\n    }\r\n    return get(model, self.modelId())\r\n  },\r\n\r\n  /**\r\n   * Create a new query to be executed against the contents of the collection.\r\n   * The result will be all or a subset of the contents of the collection.\r\n   *\r\n   * Grab page 2 of users between ages 18 and 30:\r\n   * ```javascript\r\n   * collection.query()\r\n   *   .between(18, 30, { index: 'age' }) // between ages 18 and 30\r\n   *   .skip(10) // second page\r\n   *   .limit(10) // page size\r\n   *   .run()\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @return {Query} New query object.\r\n   */\r\n  query () {\r\n    return new Query(this)\r\n  },\r\n\r\n  /**\r\n   * Reduce the data in the collection to a single value and return the result.\r\n   *\r\n   * ```javascript\r\n   * const totalVotes = collection.reduce(function (prev, entity) {\r\n   *   return prev + entity.upVotes + entity.downVotes\r\n   * }, 0)\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Function} cb - Reduction callback.\r\n   * @param {*} initialValue - Initial value of the reduction.\r\n   * @return {*} The result.\r\n   */\r\n  reduce (cb, initialValue) {\r\n    const data = this.getAll()\r\n    return data.reduce(cb, initialValue)\r\n  },\r\n\r\n  /**\r\n   * Remove the model with the given id from this Collection.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - The primary key of the entity to be removed.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @return {Model} The removed entity, if any.\r\n   */\r\n  remove (id, opts) {\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n    self.beforeRemove(id, opts)\r\n    const model = self.get(id)\r\n\r\n    // The model is in the collection, remove it\r\n    if (model) {\r\n      delete self.added[id]\r\n      delete self.autoPks[id]\r\n      self.index.removeRecord(model)\r\n      forOwn(self.indexes, function (index, name) {\r\n        index.removeRecord(model)\r\n      })\r\n      if (model && isFunction(model.off)) {\r\n        model.off('all', self._onModelEvent, self)\r\n        self.emit('remove', model)\r\n      }\r\n    }\r\n    return self.afterRemove(id, opts, model) || model\r\n  },\r\n\r\n  /**\r\n   * Remove the instances selected by \"query\" from the Collection instance of\r\n   * this Model.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} [query={}] - Selection query.\r\n   * @param {Object} [query.where] - Filtering criteria.\r\n   * @param {number} [query.skip] - Number to skip.\r\n   * @param {number} [query.limit] - Number to limit to.\r\n   * @param {Array} [query.orderBy] - Sorting criteria.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @return {Model[]} The removed entites, if any.\r\n   */\r\n  removeAll (query, opts) {\r\n    const self = this\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n    self.beforeRemoveAll(query, opts)\r\n    const models = self.filter(query)\r\n\r\n    // Remove each selected entity from the collection\r\n    models.forEach(function (item) {\r\n      self.remove(self.modelId(item))\r\n    })\r\n    return self.afterRemoveAll(query, opts, models) || models\r\n  },\r\n\r\n  /**\r\n   * Skip a number of results.\r\n   *\r\n   * Shortcut for `collection.query().skip(numberToSkip).run()`\r\n   *\r\n   * ```javascript\r\n   * const posts = collection.skip(10)\r\n   * ```\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {number} num - The number of entities to skip.\r\n   * @return {Array} The result.\r\n   */\r\n  skip (num) {\r\n    return this.query().skip(num).run()\r\n  },\r\n\r\n  /**\r\n   * Return the plain JSON representation of all items in this collection.\r\n   * Assumes entities in this collection have a toJSON method.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string[]} [opts.with] - Array of relation names or relation fields\r\n   * to include in the representation.\r\n   * @return {Array} The entities.\r\n   */\r\n  toJSON (opts) {\r\n    return this.mapCall('toJSON', opts)\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {(string|number)} id - Passed to {@link Model.update}.\r\n   * @param {Object} props - Passed to {@link Model.update}.\r\n   * @param {Object} [opts] - Passed to {@link Model.update}. See\r\n   * {@link Model.update} for more configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  update (id, props, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.update(id, props, opts).then(function (data) {\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object?} query - Passed to {@link Model.updateAll}.\r\n   * @param {Object} props - Passed to {@link Model.updateAll}.\r\n   * @param {Object} [opts] - Passed to {@link Model.updateAll}. See\r\n   * {@link Model.updateAll} for more configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  updateAll (query, props, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.updateAll(query, props, opts).then(function (data) {\r\n      return self._end(data, opts)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Update a record's position in a single index of this collection. See\r\n   * {@link Collection#updateIndexes} to update a record's position in all\r\n   * indexes at once.\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} record - The record to update.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string} [opts.index] The index in which to update the record's\r\n   * position. If you don't specify an index then the record will be updated\r\n   * in the main index.\r\n   */\r\n  updateIndex (record, opts) {\r\n    opts || (opts = {})\r\n    const index = opts.index ? this.indexes[opts.index] : this.index\r\n    index.updateRecord(record)\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Object} record - TODO\r\n   * @param {Object} [opts] - Configuration options.\r\n   */\r\n  updateIndexes (record) {\r\n    const self = this\r\n    self.index.updateRecord(record)\r\n    forOwn(self.indexes, function (index, name) {\r\n      index.updateRecord(record)\r\n    })\r\n  },\r\n\r\n  /**\r\n   * TODO\r\n   *\r\n   * @memberof Collection\r\n   * @instance\r\n   * @param {Model[]} models - Passed to {@link Model.updateMany}.\r\n   * @param {Object} [opts] - Passed to {@link Model.updateMany}. See\r\n   * {@link Model.updateMany} for more configuration options.\r\n   * @param {boolean} [opts.autoAdd] - TODO\r\n   * @return {Promise}\r\n   */\r\n  updateMany (models, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    fillIn(opts, self.modelOpts)\r\n    return self.model.updateMany(models, opts).then(function (data) {\r\n      return self._end(data, opts)\r\n    })\r\n  }\r\n})\r\n\r\neventify(\r\n  Collection.prototype,\r\n  function () {\r\n    return this._listeners\r\n  },\r\n  function (value) {\r\n    this._listeners = value\r\n  }\r\n)\r\n","import {\r\n  camelCase,\r\n  get,\r\n  isFunction,\r\n  isString,\r\n  set\r\n} from '../utils'\r\n\r\nconst op = 'belongsTo'\r\n\r\n/**\r\n * Steps to apply a \"belongsTo\" relationship\r\n * 1. Choose the localField and foreignKey\r\n * 2. Configure property descriptor, possibly including custom getter/setter\r\n * 3. Add property to prototype of target Model\r\n *\r\n * The added property is where an instance of the related Model will be\r\n * attached to an instance of the target Model, e.g. if Comment belongsTo\r\n * User and \"localField\" is set to \"user\", \"comment.user\" will be a reference to\r\n * the user.\r\n *\r\n * @ignore\r\n */\r\nfunction applyBelongsTo (Model, Relation, opts) {\r\n  opts || (opts = {})\r\n\r\n  function getRelation () {\r\n    const fake = {\r\n      name: Relation\r\n    }\r\n    if (isString(Relation)) {\r\n      if (isFunction(Model.getModel)) {\r\n        return Model.getModel(Relation) || fake\r\n      }\r\n      return fake\r\n    }\r\n    return Relation\r\n  }\r\n\r\n  function getLocalField () {\r\n    return opts.localField || camelCase(getRelation().name)\r\n  }\r\n\r\n  function getForeignKey () {\r\n    return opts.foreignKey || opts.localKey || `${camelCase(getRelation().name)}Id`\r\n  }\r\n\r\n  // Setup configuration of the property\r\n  const descriptor = {\r\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\r\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\r\n    // Set default method for retrieving the linked relation\r\n    get () {\r\n      return this._get(`links.${getLocalField()}`)\r\n    },\r\n    // Set default method for setting the linked relation\r\n    set (parent) {\r\n      if (!parent) {\r\n        return\r\n      }\r\n      this._set(`links.${getLocalField()}`, parent)\r\n      set(this, getForeignKey(), parent[getRelation().idAttribute])\r\n      return get(this, getLocalField())\r\n    }\r\n  }\r\n\r\n  const originalGet = descriptor.get\r\n  const originalSet = descriptor.set\r\n\r\n  // Check for user-defined getter\r\n  if (opts.get) {\r\n    // Set user-defined getter\r\n    descriptor.get = function () {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - the original getter function, in case the user wants to use it\r\n      return opts.get(Model, getRelation(), this, () => originalGet.call(this))\r\n    }\r\n    delete descriptor.writable\r\n  }\r\n\r\n  // Check for user-defined setter\r\n  if (opts.set) {\r\n    // Set user-defined setter\r\n    descriptor.set = function (parent) {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - instance of related Model\r\n      //  - the original setter function, in case the user wants to use it\r\n      return opts.set(Model, getRelation(), this, parent, value => originalSet.call(this, value === undefined ? parent : value))\r\n    }\r\n    delete descriptor.writable\r\n  }\r\n\r\n  if (descriptor.get) {\r\n    descriptor.set || (descriptor.set = function () {})\r\n  }\r\n\r\n  // Finally, added property to prototype of target Model\r\n  Object.defineProperty(Model.prototype, getLocalField(), descriptor)\r\n\r\n  if (!Model.relationList) {\r\n    Model.relationList = []\r\n  }\r\n  if (!Model.relationFields) {\r\n    Model.relationFields = []\r\n  }\r\n  opts.type = 'belongsTo'\r\n  opts.name = Model.name\r\n  opts.relation = Relation.name\r\n  opts.Relation = Relation\r\n  opts.getRelation = getRelation\r\n  opts.getLocalField = getLocalField\r\n  opts.getForeignKey = getForeignKey\r\n  Model.relationList.push(opts)\r\n  Model.relationFields.push(getLocalField())\r\n\r\n  // Return target Model for chaining\r\n  return Model\r\n}\r\n\r\n/**\r\n * @memberof! module:js-data\r\n * @example\r\n * // ES6\r\n * import {belongsTo, Model} from 'js-data'\r\n * class User extends Model {}\r\n *\r\n * // @belongsTo(User) (ES7)\r\n * class Comment extends Model {}\r\n * belongsTo(User)(Comment)\r\n *\r\n * // ES5\r\n * var JSData = require('js-data')\r\n * var User = JSData.Model.extend({}, { name: 'User' })\r\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\r\n * JSData.belongsTo(User)(Comment)\r\n *\r\n * @param {Model} Relation - The Relation the target belongs to.\r\n * @param {Object} [opts] - Configuration options.\r\n * @param {string} [opts.localField] - The field on the target where the relation\r\n * will be attached.\r\n * @return {Function} Invocation function, which accepts the target as the only\r\n * parameter.\r\n */\r\nexport function belongsTo (Relation, opts) {\r\n  return function (Model) {\r\n    Model.dbg(op, Relation, opts)\r\n    return applyBelongsTo(Model, Relation, opts)\r\n  }\r\n}\r\n","import {copy, forOwn} from '../utils'\r\n\r\n/**\r\n * @memberof! module:js-data\r\n * @example\r\n * // ES6\r\n * import {configure, Model} from 'js-data'\r\n *\r\n * // @configure(opts) (ES7)\r\n * class User extends JSData.Model {}\r\n * configure(opts)(User)\r\n *\r\n * // ES5\r\n * var JSData = require('js-data')\r\n * var User = JSData.Model.extend()\r\n * User.configure(opts)\r\n *\r\n * @param {Object} opts - Properties to apply to the target.\r\n * @param {boolean} [overwrite=true] - Whether to overwrite properties that\r\n * already exist on the target.\r\n */\r\nexport function configure (opts, overwrite = true) {\r\n  opts = opts || {}\r\n  return function (target) {\r\n    forOwn(opts, function (value, key) {\r\n      if (target[key] === undefined || overwrite) {\r\n        target[key] = copy(value)\r\n      }\r\n    })\r\n    return target\r\n  }\r\n}\r\n","import {\r\n  camelCase,\r\n  get,\r\n  isFunction,\r\n  isString,\r\n  set\r\n} from '../utils'\r\n\r\nconst op = 'hasMany'\r\n\r\n/**\r\n * Steps to apply a \"hasMany\" relationship\r\n * 1. Choose the localField and foreignKey or localKeys\r\n * 2. Configure property descriptor, possibly including custom getter/setter\r\n * 3. Add property to prototype of target Model\r\n *\r\n * The added property is where instances of the related Model will be\r\n * attached to an instance of the target Model, e.g. if User hasMany Comment\r\n * and \"localField\" is set to \"comments\", \"user.comments\" will be a reference to\r\n * the array of comments.\r\n *\r\n * @ignore\r\n */\r\nfunction applyHasMany (Model, Relation, opts) {\r\n  opts || (opts = {})\r\n\r\n  function getRelation () {\r\n    const fake = {\r\n      name: Relation\r\n    }\r\n    if (isString(Relation)) {\r\n      if (isFunction(Model.getModel)) {\r\n        return Model.getModel(Relation) || fake\r\n      }\r\n      return fake\r\n    }\r\n    return Relation\r\n  }\r\n\r\n  function getLocalField () {\r\n    return opts.localField || `${camelCase(getRelation().name)}Collection`\r\n  }\r\n\r\n  // Choose field on related instances that holds the primary key of instances\r\n  // of the target Model\r\n  let foreignKey = opts.foreignKey\r\n  const localKeys = opts.localKeys\r\n  const foreignKeys = opts.foreignKeys\r\n\r\n  if (!foreignKey && !localKeys && !foreignKeys) {\r\n    foreignKey = opts.foreignKey = `${camelCase(Model.name)}Id`\r\n  }\r\n\r\n  // Setup configuration of the property\r\n  const descriptor = {\r\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\r\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\r\n    // Set default method for retrieving the linked relation\r\n    get () {\r\n      return this._get(`links.${getLocalField()}`)\r\n    },\r\n    // Set default method for setting the linked relation\r\n    set (children) {\r\n      if (!children) {\r\n        return\r\n      }\r\n      this._set(`links.${getLocalField()}`, children)\r\n      if (children && children.length) {\r\n        const id = get(this, Model.idAttribute)\r\n        if (foreignKey) {\r\n          children.forEach(function (child) {\r\n            set(child, foreignKey, id)\r\n          })\r\n        } else if (localKeys) {\r\n          const keys = []\r\n          children.forEach(function (child) {\r\n            keys.push(get(child, getRelation().idAttribute))\r\n          })\r\n          set(this, localKeys, keys)\r\n        } else if (foreignKeys) {\r\n          children.forEach(function (child) {\r\n            const keys = get(child, foreignKeys)\r\n            if (keys) {\r\n              if (keys.indexOf(id) === -1) {\r\n                keys.push(id)\r\n              }\r\n            } else {\r\n              set(child, foreignKeys, [id])\r\n            }\r\n          })\r\n        }\r\n      }\r\n      return get(this, getLocalField())\r\n    }\r\n  }\r\n\r\n  const originalGet = descriptor.get\r\n  const originalSet = descriptor.set\r\n\r\n  // Check for user-defined getter\r\n  if (opts.get) {\r\n    // Set user-defined getter\r\n    descriptor.get = function () {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - the original getter function, in case the user wants to use it\r\n      return opts.get(Model, getRelation(), this, () => originalGet.call(this))\r\n    }\r\n  }\r\n\r\n  // Check for user-defined setter\r\n  if (opts.set) {\r\n    // Set user-defined setter\r\n    descriptor.set = function (children) {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - instances of related Model\r\n      //  - the original setter function, in case the user wants to use it\r\n      return opts.set(Model, getRelation(), this, children, value => originalSet.call(this, value === undefined ? children : value))\r\n    }\r\n  }\r\n\r\n  // Finally, added property to prototype of target Model\r\n  Object.defineProperty(Model.prototype, getLocalField(), descriptor)\r\n\r\n  if (!Model.relationList) {\r\n    Model.relationList = []\r\n  }\r\n  if (!Model.relationFields) {\r\n    Model.relationFields = []\r\n  }\r\n  opts.type = 'hasMany'\r\n  opts.name = Model.name\r\n  opts.relation = getRelation().name\r\n  opts.Relation = getRelation()\r\n  opts.getRelation = getRelation\r\n  opts.getLocalField = getLocalField\r\n  Model.relationList.push(opts)\r\n  Model.relationFields.push(getLocalField())\r\n\r\n  // Return target Model for chaining\r\n  return Model\r\n}\r\n\r\n/**\r\n * @memberof! module:js-data\r\n * @example\r\n * // ES6\r\n * import {hasMany, Model} from 'js-data'\r\n * class Comment extends Model {}\r\n *\r\n * // @hasMany(Comment)\r\n * class User extends Model {}\r\n * hasMany(Comment)(User)\r\n *\r\n * // ES5\r\n * var JSData = require('js-data')\r\n * var User = JSData.Model.extend({}, { name: 'User' })\r\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\r\n * JSData.hasMany(User)(Comment)\r\n *\r\n * @param {Model} Model - The Model of which the target has many.\r\n * @param {Object} [opts] - Configuration options.\r\n * @param {string} [opts.localField] - The field on the target where the relation\r\n * will be attached.\r\n * @return {Function} Invocation function, which accepts the target as the only\r\n * parameter.\r\n */\r\nexport function hasMany (Relation, opts) {\r\n  return function (target) {\r\n    target.dbg(op, Relation, opts)\r\n    return applyHasMany(target, Relation, opts)\r\n  }\r\n}\r\n","import {\r\n  camelCase,\r\n  get,\r\n  isFunction,\r\n  isString,\r\n  set\r\n} from '../utils'\r\n\r\nconst op = 'hasOne'\r\n\r\n/**\r\n * Steps to apply a \"hasOne\" relationship\r\n * 1. Choose the foreignKey and localKey\r\n * 2. Configure property descriptor, possibly including custom getter/setter\r\n * 3. Add property to prototype of target Model\r\n *\r\n * The added property is where an instance of the related Model will be\r\n * attached to an instance of the target Model, e.g. if User hasOne\r\n * Profile and \"localField\" is set to \"profile\", \"user.profile\" will be a\r\n * reference to the profile.\r\n *\r\n * @ignore\r\n */\r\nfunction applyHasOne (Model, Relation, opts) {\r\n  opts || (opts = {})\r\n\r\n  function getRelation () {\r\n    const fake = {\r\n      name: Relation\r\n    }\r\n    if (isString(Relation)) {\r\n      if (isFunction(Model.getModel)) {\r\n        return Model.getModel(Relation) || fake\r\n      }\r\n      return fake\r\n    }\r\n    return Relation\r\n  }\r\n\r\n  function getLocalField () {\r\n    return opts.localField || camelCase(getRelation().name)\r\n  }\r\n\r\n  function getForeignKey () {\r\n    return opts.foreignKey || opts.localKey || `${camelCase(Model.name)}Id`\r\n  }\r\n\r\n  // Setup configuration of the property\r\n  const descriptor = {\r\n    // Whether the field specified by \"localField\" will show up in \"for...in\"\r\n    enumerable: opts.enumerable !== undefined ? !!opts.enumerable : false,\r\n    // Set default method for retrieving the linked relation\r\n    get () {\r\n      return this._get(`links.${getLocalField()}`)\r\n    },\r\n    // Set default method for setting the linked relation\r\n    set (child) {\r\n      if (!child) {\r\n        return\r\n      }\r\n      this._set(`links.${getLocalField()}`, child)\r\n      set(child, getForeignKey(), get(this, Model.idAttribute))\r\n      return get(this, getLocalField())\r\n    }\r\n  }\r\n\r\n  // Check for user-defined getter\r\n  if (opts.get) {\r\n    const originalGet = descriptor.get\r\n    // Set user-defined getter\r\n    descriptor.get = function () {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - the original getter function, in case the user wants to use it\r\n      return opts.get(Model, Relation, this, originalGet ? (...args) => originalGet.apply(this, args) : undefined)\r\n    }\r\n  }\r\n\r\n  // Check for user-defined setter\r\n  if (opts.set) {\r\n    const originalSet = descriptor.set\r\n    // Set user-defined setter\r\n    descriptor.set = function (child) {\r\n      // Call user-defined getter, passing in:\r\n      //  - target Model\r\n      //  - related Model\r\n      //  - instance of target Model\r\n      //  - instance of related Model\r\n      //  - the original setter function, in case the user wants to use it\r\n      return opts.set(Model, Relation, this, child, originalSet ? (...args) => originalSet.apply(this, args) : undefined)\r\n    }\r\n  }\r\n\r\n  // Finally, added property to prototype of target Model\r\n  Object.defineProperty(Model.prototype, getLocalField(), descriptor)\r\n\r\n  if (!Model.relationList) {\r\n    Model.relationList = []\r\n  }\r\n  if (!Model.relationFields) {\r\n    Model.relationFields = []\r\n  }\r\n  opts.type = 'hasOne'\r\n  opts.name = Model.name\r\n  opts.relation = Relation.name\r\n  opts.Relation = Relation\r\n  opts.getRelation = getRelation\r\n  opts.getLocalField = getLocalField\r\n  opts.getForeignKey = getForeignKey\r\n  Model.relationList.push(opts)\r\n  Model.relationFields.push(getLocalField())\r\n\r\n  // Return target Model for chaining\r\n  return Model\r\n}\r\n\r\n/**\r\n * @memberof! module:js-data\r\n * @example\r\n * // ES6\r\n * import {hasOne, Model} from 'js-data'\r\n * class User extends Model {}\r\n *\r\n * // @hasOne(User) (ES7)\r\n * class Comment extends Model {}\r\n * hasOne(User, {...})(Comment)\r\n *\r\n * // ES5\r\n * var JSData = require('js-data')\r\n * var User = JSData.Model.extend({}, { name: 'User' })\r\n * var Comment = JSDataModel.extend({}, { name: 'Comment' })\r\n * JSData.hasOne(User, {...})(Comment)\r\n *\r\n * @param {Model} Model - The Model of which the target has one.\r\n * @param {Object} [opts] - Configuration options.\r\n * @param {string} [opts.localField] - The field on the target where the relation\r\n * will be attached.\r\n * @return {Function} Invocation function, which accepts the target as the only\r\n * parameter.\r\n */\r\nexport function hasOne (Model, opts) {\r\n  return function (target) {\r\n    target.dbg(op, 'Model:', Model, 'opts:', opts)\r\n    return applyHasOne(target, Model, opts)\r\n  }\r\n}\r\n","import {\r\n  forOwn,\r\n  isArray,\r\n  isBoolean,\r\n  isNumber,\r\n  isObject,\r\n  isString\r\n} from '../utils'\r\n\r\nconst types = {\r\n  array: isArray,\r\n  boolean: isBoolean,\r\n  integer: isNumber,\r\n  number: isNumber,\r\n  'null': function (value) {\r\n    return value === null\r\n  },\r\n  object: isObject,\r\n  string: isString\r\n}\r\n\r\nexport const rules = {\r\n  type (predicate, value) {\r\n    if (value === undefined) {\r\n      return\r\n    }\r\n    if (isString(predicate)) {\r\n      predicate = [predicate]\r\n    }\r\n    const errors = predicate.map(function (type) {\r\n      const validator = types[type]\r\n      if (!validator) {\r\n        return `type: Unknown type ${predicate}`\r\n      }\r\n      return validator(value) ? undefined : 1\r\n    })\r\n    return errors.indexOf(undefined) !== -1 ? undefined : `type: Expected: ${predicate.join(' or ')}. Actual: ${typeof value}`\r\n  },\r\n\r\n  anyOf (schemas, value) {\r\n    let validated = false\r\n    let allErrors = []\r\n    schemas.forEach(function (schema) {\r\n      const errors = validate(schema, value)\r\n      if (errors) {\r\n        allErrors = allErrors.concat(errors)\r\n      } else {\r\n        validated = true\r\n      }\r\n    })\r\n    return validated ? undefined : allErrors\r\n  },\r\n\r\n  allOf (schemas, value) {\r\n    let allErrors = []\r\n    schemas.forEach(function (schema) {\r\n      allErrors = allErrors.concat(validate(schema, value) || [])\r\n    })\r\n    return allErrors.length ? undefined : allErrors\r\n  },\r\n\r\n  oneOf (schemas, value) {\r\n    let validated = false\r\n    let allErrors = []\r\n    schemas.forEach(function (schema) {\r\n      const errors = validate(schema, value)\r\n      if (errors) {\r\n        allErrors = allErrors.concat(errors)\r\n      } else if (validated) {\r\n        allErrors = ['more than one schema validated']\r\n        validated = false\r\n        return false\r\n      } else {\r\n        validated = true\r\n      }\r\n    })\r\n    return validated ? undefined : allErrors\r\n  }\r\n}\r\n\r\nexport function validate (schema, value) {\r\n  const errors = []\r\n  forOwn(schema, function (predicate, rule) {\r\n    const validator = rules[rule]\r\n    if (validator) {\r\n      const err = validator(predicate, value)\r\n      if (err) {\r\n        errors.push(err)\r\n      }\r\n    }\r\n  })\r\n  return errors.length ? errors : undefined\r\n}\r\n","import {\r\n  forOwn,\r\n  get\r\n} from '../utils'\r\nimport {validate} from '../validate/index'\r\nimport {configure} from './configure'\r\n\r\nconst op = 'setSchema'\r\n\r\n/**\r\n * @param {Model} target - Target Model.\r\n * @param {string} key - Key for new property.\r\n * @param {Object} opts - Configuration options.\r\n * @ignore\r\n */\r\nfunction makeDescriptor (target, key, opts) {\r\n  const descriptor = {\r\n    enumerable: opts.enumerable !== undefined ? opts.enumerable : true\r\n  }\r\n  descriptor.get = function () {\r\n    return this._get(`props.${key}`)\r\n  }\r\n  descriptor.set = function (value) {\r\n    // TODO: rework this\r\n    // if (isFunction(opts.validate) && !opts.validate(value)) {\r\n    //   return false\r\n    // }\r\n    const _get = this._get\r\n    const _set = this._set\r\n    const _unset = this._unset\r\n    if (!_get('noValidate')) {\r\n      const errors = validate(opts, value)\r\n      if (errors) {\r\n        throw new Error(errors.join(', '))\r\n      }\r\n    }\r\n    if (opts.track && !_get('creating')) {\r\n      let changing = _get('changing')\r\n      const previous = _get(`previous.${key}`)\r\n      const current = _get(`props.${key}`)\r\n      let changed = _get('changed')\r\n      if (!changing) {\r\n        changed = []\r\n      }\r\n      const index = changed.indexOf(key)\r\n      if (current !== value && index === -1) {\r\n        changed.push(key)\r\n      }\r\n      if (previous !== value) {\r\n        _set(`changes.${key}`, value)\r\n      } else {\r\n        _unset(`changes.${key}`)\r\n        if (index >= 0) {\r\n          changed.splice(index, 1)\r\n        }\r\n      }\r\n      if (!changed.length) {\r\n        changing = false\r\n        _unset('changing')\r\n        _unset('changed')\r\n        if (_get('eventId')) {\r\n          clearTimeout(_get('eventId'))\r\n          _unset('eventId')\r\n        }\r\n      }\r\n      if (!changing && changed.length) {\r\n        _set('changed', changed)\r\n        _set('changing', true)\r\n        _set('eventId', setTimeout(() => {\r\n          _unset('changed')\r\n          _unset('eventId')\r\n          _unset('changing')\r\n          if (!_get('silent')) {\r\n            let i\r\n            for (i = 0; i < changed.length; i++) {\r\n              this.emit('change:' + changed[i], this, get(this, changed[i]))\r\n            }\r\n            this.emit('change', this, _get('changes'))\r\n          }\r\n          _unset('silent')\r\n        }, 0))\r\n      }\r\n    }\r\n    _set(`props.${key}`, value)\r\n    // if (_get('$') && opts.indexed) {\r\n    //   target.getCollection().updateIndex(this, { index: key })\r\n    // }\r\n    return value\r\n  }\r\n  // if (opts.indexed) {\r\n  //   // Update index\r\n  //   // TODO: Make this configurable, ie. immediate or lazy update\r\n  //   target.createIndex(key)\r\n  // }\r\n  if (opts.get) {\r\n    if (descriptor.get) {\r\n      const originalGet = descriptor.get\r\n      descriptor.get = function () {\r\n        return opts.get.call(this, originalGet)\r\n      }\r\n    } else {\r\n      descriptor.get = opts.get\r\n    }\r\n  }\r\n  if (opts.set) {\r\n    if (descriptor.set) {\r\n      const originalSet = descriptor.set\r\n      descriptor.set = function (value) {\r\n        return opts.set.call(this, value, originalSet)\r\n      }\r\n    } else {\r\n      descriptor.set = opts.set\r\n    }\r\n  }\r\n  return descriptor\r\n}\r\n\r\n/**\r\n * @memberof! module:js-data\r\n * @example\r\n * // ES6\r\n * import {setSchema, Model} from 'js-data'\r\n * const properties = {\r\n *   first: {},\r\n *   last: {},\r\n *   role: {\r\n *     value: 'dev'\r\n *   },\r\n *   // computed property\r\n *   name: {\r\n *     get() { return `${this.first} ${this.last}` },\r\n *     set(value) {\r\n *       let parts = value.split(' ')\r\n *       this.first = parts[0]\r\n *       this.last = parts[1]\r\n *       return this\r\n *     }\r\n *   }\r\n * }\r\n *\r\n * // @setSchema(properties) (ES7)\r\n * class User extends Model {}\r\n * User.setSchema(properties)\r\n *\r\n * // ES5\r\n * var JSData = require('js-data')\r\n * var User = JSData.Model.extend({}, { name: 'User' })\r\n * User.setSchema(properties)\r\n *\r\n * @param {Object.<string, Object>} opts - Property configurations.\r\n * @return {Function} Invocation function, which accepts the target as the only\r\n * parameter.\r\n */\r\nexport function setSchema (opts) {\r\n  opts || (opts = {})\r\n\r\n  return function (target) {\r\n    target.dbg(op, 'opts:', opts)\r\n\r\n    target.schema || (target.schema = {})\r\n    configure(target.schema, opts)\r\n\r\n    forOwn(opts, function (prop, key) {\r\n      const descriptor = makeDescriptor(target, key, prop)\r\n      // TODO: This won't work for properties of Object type, because all\r\n      // instances will share the prototype value\r\n      if (!descriptor.writable) {\r\n        Object.defineProperty(target.prototype, key, descriptor)\r\n      }\r\n    })\r\n    return target\r\n  }\r\n}\r\n","const op = 'registerAdapter'\r\n\r\n/**\r\n * Add the provided adapter to the target's \"adapters\" property, registering it\r\n * with the specified.\r\n * @memberof! module:js-data\r\n * @param {string} name - The name under which to register the adapter.\r\n * @param {Adapter} adapter - The adapter to register.\r\n * @param {Object} opts - Configuration options.\r\n * @param {boolean} [opts.default=false] - Whether to make the adapter the\r\n * default adapter for the target.\r\n * @return {Function} Invocation function, which accepts the target as the only\r\n * parameter.\r\n */\r\nexport function registerAdapter (name, adapter, opts) {\r\n  opts || (opts = {})\r\n  opts.op = op\r\n  return function (target) {\r\n    target.dbg(op, 'name:', name, 'adapter:', adapter, 'opts:', opts)\r\n    // Register the adapter\r\n    target.getAdapters()[name] = adapter\r\n    // Optionally make it the default adapter for the target.\r\n    if (opts === true || opts.default) {\r\n      target.defaultAdapter = name\r\n    }\r\n  }\r\n}\r\n","import * as utils from '../utils'\r\nimport {\r\n  belongsTo,\r\n  configure,\r\n  hasMany,\r\n  hasOne,\r\n  setSchema,\r\n  registerAdapter\r\n} from '../decorators/index'\r\nimport * as validate from '../validate/index'\r\n\r\nconst {\r\n  resolve\r\n} = utils\r\n\r\nconst notify = function (...args) {\r\n  const self = this\r\n  const opts = args.pop()\r\n  self.dbg(opts.op, ...args)\r\n  if (opts.notify || (opts.notify === undefined && self.notify)) {\r\n    setTimeout(() => {\r\n      self.emit(opts.op, ...args)\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * js-data's Model class.\r\n * @class Model\r\n * @example {@lang javascript}class User extends Model {}\r\n *\r\n * @abstract\r\n * @param {Object} [props] The initial properties of the new instance.\r\n * @param {Object} [opts] Configuration options.\r\n * @param {boolean} [opts.noValidate=false] Whether to skip validation on the\r\n * initial properties.\r\n */\r\nexport function Model (props, opts) {\r\n  const self = this\r\n  utils.classCallCheck(self, Model)\r\n\r\n  props || (props = {})\r\n  opts || (opts = {})\r\n  const _props = {}\r\n  Object.defineProperties(self, {\r\n    _get: {\r\n      value (key) {\r\n        return utils.get(_props, key)\r\n      }\r\n    },\r\n    _set: {\r\n      value (key, value) {\r\n        return utils.set(_props, key, value)\r\n      }\r\n    },\r\n    _unset: {\r\n      value (key) {\r\n        return utils.unset(_props, key)\r\n      }\r\n    }\r\n  })\r\n  self._set('creating', true)\r\n  if (opts.noValidate) {\r\n    self._set('noValidate', true)\r\n  }\r\n  utils.fillIn(self, props)\r\n  self._unset('creating')\r\n  self._set('changes', {})\r\n  self._unset('noValidate')\r\n  self._set('previous', utils.copy(props))\r\n}\r\n\r\n/**\r\n * Instance members\r\n */\r\nutils.addHiddenPropsToTarget(Model.prototype, {\r\n  schema (key) {\r\n    let _schema = this.constructor.schema\r\n    return key ? _schema[key] : _schema\r\n  },\r\n\r\n  validate (obj, value) {\r\n    let errors = []\r\n    let _schema = this.schema()\r\n    if (!obj) {\r\n      obj = this\r\n    } else if (utils.isString(obj)) {\r\n      const prop = _schema[obj]\r\n      if (prop) {\r\n        errors = validate.validate(prop, value) || []\r\n      }\r\n    } else {\r\n      utils.forOwn(_schema, function (prop, key) {\r\n        errors = errors.concat(validate.validate(prop, utils.get(obj, key)) || [])\r\n      })\r\n    }\r\n    return errors.length ? errors : undefined\r\n  },\r\n\r\n  /**\r\n   * @param {Object} [opts] Configuration options. @see {@link Model.create}.\r\n   */\r\n  create (opts) {\r\n    return this.constructor.create(this, opts)\r\n  },\r\n\r\n  beforeSave () {},\r\n  save (opts) {\r\n    let op, adapter\r\n    const self = this\r\n    const Ctor = self.constructor\r\n\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeSave lifecycle hook\r\n    op = opts.op = 'beforeSave'\r\n    return resolve(self[op](opts)).then(function () {\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'save'\r\n      Ctor.dbg(op, self, opts)\r\n      return self.getAdapter(adapter)[op](Ctor, self, opts)\r\n    }).then(function (data) {\r\n      // afterSave lifecycle hook\r\n      op = opts.op = 'afterSave'\r\n      return resolve(self[op](data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        if (opts.raw) {\r\n          self.set(data.data)\r\n          data.data = self\r\n        } else {\r\n          self.set(data)\r\n        }\r\n        return Ctor.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n  afterSave () {},\r\n\r\n  beforeLoadRelations () {},\r\n  loadRelations (relations, opts) {\r\n    let op\r\n    const self = this\r\n    const Ctor = self.constructor\r\n    const relationList = Ctor.relationList || []\r\n\r\n    // Default values for arguments\r\n    relations || (relations = [])\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(Ctor, opts)\r\n    opts.adapter = Ctor.getAdapterName(opts)\r\n\r\n    // beforeLoadRelations lifecycle hook\r\n    op = opts.op = 'beforeLoadRelations'\r\n    return resolve(self[op](relations, opts)).then(function () {\r\n      if (utils.isString(relations)) {\r\n        relations = [relations]\r\n      }\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'loadRelations'\r\n      Ctor.dbg(op, self, relations, opts)\r\n      return Promise.all(relationList.map(function (def) {\r\n        if (utils.isFunction(def.load)) {\r\n          return def.load(Ctor, def, self, opts)\r\n        }\r\n        let task\r\n        if (def.type === 'hasMany' && def.foreignKey) {\r\n          // hasMany\r\n          task = def.Relation.findAll({\r\n            [def.foreignKey]: utils.get(self, Ctor.idAttribute)\r\n          }, opts)\r\n        } else if (def.foreignKey) {\r\n          // belongsTo or hasOne\r\n          const key = utils.get(self, def.foreignKey)\r\n          if (utils.isSorN(key)) {\r\n            task = def.Relation.find(key, opts)\r\n          }\r\n        } else if (def.localKeys) {\r\n          // hasMany\r\n          task = def.Relation.findAll({\r\n            [def.Relation.idAttribute]: {\r\n              'in': utils.get(self, def.localKeys)\r\n            }\r\n          }, opts)\r\n        } else if (def.foreignKeys) {\r\n          // hasMany\r\n          task = def.Relation.findAll({\r\n            [def.Relation.idAttribute]: {\r\n              'contains': utils.get(self, Ctor.idAttribute)\r\n            }\r\n          }, opts)\r\n        }\r\n        if (task) {\r\n          task = task.then(function (data) {\r\n            if (opts.raw) {\r\n              data = data.data\r\n            }\r\n            utils.set(self, def.localField, def.type === 'hasOne' ? (data.length ? data[0] : undefined) : data)\r\n          })\r\n        }\r\n        return task\r\n      }))\r\n    }).then(function () {\r\n      // afterLoadRelations lifecycle hook\r\n      op = opts.op = 'afterLoadRelations'\r\n      return resolve(self[op](relations, opts)).then(function () {\r\n        return self\r\n      })\r\n    })\r\n  },\r\n  afterLoadRelations () {},\r\n\r\n  /**\r\n   * @param {Object} [opts] Configuration options. @see {@link Model.destroy}.\r\n   */\r\n  destroy (opts) {\r\n    // TODO: move actual destroy logic here\r\n    const Ctor = this.constructor\r\n    return Ctor.destroy(utils.get(this, Ctor.idAttribute), opts)\r\n  },\r\n\r\n  // TODO: move logic for single-item async operations onto the instance.\r\n\r\n  /**\r\n   * Return the value at the given path for this instance.\r\n   *\r\n   * @param {string} key - Path of value to retrieve.\r\n   * @return {*} Value at path.\r\n   */\r\n  get: function (key) {\r\n    return utils.get(this, key)\r\n  },\r\n\r\n  /**\r\n   * Set the value for a given key, or the values for the given keys if \"key\" is\r\n   * an object.\r\n   *\r\n   * @param {(string|Object)} key - Key to set or hash of key-value pairs to set.\r\n   * @param {*} [value] - Value to set for the given key.\r\n   * @param {Object} [opts] - Optional configuration.\r\n   * @param {boolean} [opts.silent=false] - Whether to trigger change events.\r\n   */\r\n  set: function (key, value, opts) {\r\n    const self = this\r\n    if (utils.isObject(key)) {\r\n      opts = value\r\n    }\r\n    opts || (opts = {})\r\n    if (opts.silent) {\r\n      self._set('silent', true)\r\n    }\r\n    utils.set(self, key, value)\r\n    if (!self._get('eventId')) {\r\n      self._unset('silent')\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Unset the value for a given key.\r\n   *\r\n   * @param {string} key - Key to unset.\r\n   * @param {Object} [opts] - Optional configuration.\r\n   * @param {boolean} [opts.silent=false] - Whether to trigger change events.\r\n   */\r\n  unset (key, opts) {\r\n    opts || (opts = {})\r\n    if (opts.silent) {\r\n      this._set('silent', true)\r\n    }\r\n    utils.unset(this, key)\r\n    if (!this._get('eventId')) {\r\n      this._unset('silent')\r\n    }\r\n  },\r\n\r\n  hashCode () {\r\n    return utils.get(this, this.constructor.idAttribute)\r\n  },\r\n\r\n  changes (key) {\r\n    if (key) {\r\n      return this._get(`changes.${key}`)\r\n    }\r\n    return this._get('changes')\r\n  },\r\n\r\n  hasChanges () {\r\n    return !!(this._get('changed') || []).length\r\n  },\r\n\r\n  commit () {\r\n    this._unset('changed')\r\n    this._set('changes', {})\r\n    this._set('previous', utils.copy(this))\r\n    return this\r\n  },\r\n\r\n  previous (key) {\r\n    if (key) {\r\n      return this._get(`previous.${key}`)\r\n    }\r\n    return this._get('previous')\r\n  },\r\n\r\n  revert (opts) {\r\n    const previous = this._get('previous') || {}\r\n    opts || (opts = {})\r\n    opts.preserve || (opts.preserve = [])\r\n    utils.forOwn(this, (value, key) => {\r\n      if (key !== this.constructor.idAttribute && !previous.hasOwnProperty(key) && this.hasOwnProperty(key) && opts.preserve.indexOf(key) === -1) {\r\n        delete this[key]\r\n      }\r\n    })\r\n    utils.forOwn(previous, (value, key) => {\r\n      if (opts.preserve.indexOf(key) === -1) {\r\n        this[key] = value\r\n      }\r\n    })\r\n    this.commit()\r\n    return this\r\n  },\r\n\r\n  toJSON (opts) {\r\n    return this.constructor.toJSON(this, opts)\r\n  }\r\n})\r\n\r\n/**\r\n * Static members\r\n */\r\nutils.fillIn(Model, {\r\n  /**\r\n   * Hash of registered adapters. Don't modify. Use {@link Model.registerAdapter}.\r\n   *\r\n   * @memberOf Model\r\n   * @private\r\n   */\r\n  _adapters: null,\r\n\r\n  /**\r\n   * @ignore\r\n   */\r\n  _adaptersOwner: null,\r\n\r\n  /**\r\n   * Hash of registered listeners. Don't modify. Use {@link Model.on} and\r\n   * {@link Model.off}.\r\n   *\r\n   * @memberOf Model\r\n   * @private\r\n   */\r\n  _listeners: null,\r\n\r\n  /**\r\n   * @ignore\r\n   */\r\n  _listenersOwner: null,\r\n\r\n  /**\r\n   * Whether to disallow the use of `new Function` in {@link Model.extend}.\r\n   *\r\n   * You may set this to `true` if you so desire, but the class (constructor\r\n   * function) produced by {@link Model.extend} will not be a named function,\r\n   * which makes for slightly less debuggability.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  csp: false,\r\n\r\n  /**\r\n   * The name of the registered adapter that should be used by default by any\r\n   * of the Model's static methods that use an adapter.\r\n   *\r\n   * @memberof Model\r\n   * @type {string}\r\n   * @default http\r\n   */\r\n  defaultAdapter: 'http',\r\n\r\n  /**\r\n   * Whether to enable debug-level logs.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  debug: false,\r\n\r\n  /**\r\n   * The field on instances of {@link Model} that should be used as the unique\r\n   * identifier for instances of the Model.\r\n   *\r\n   * @memberof Model\r\n   * @type {string}\r\n   * @default id\r\n   */\r\n  idAttribute: 'id',\r\n\r\n  /**\r\n   * Whether this Model should emit operational events.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default true\r\n   */\r\n  notify: true,\r\n\r\n  pojo: false,\r\n\r\n  /**\r\n   * Whether the relation property accessors should be enumerable. It's\r\n   * recommended that this stay false.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  relationsEnumerable: false,\r\n\r\n  /**\r\n   * Whether {@link Model.create}, {@link Model.createMany}, {@link Model.save},\r\n   * {@link Model.update}, {@link Model.updateAll}, {@link Model.updateMany},\r\n   * {@link Model.find}, {@link Model.findAll}, {@link Model.destroy}, and\r\n   * {@link Model.destroyAll} should return a raw result object that contains\r\n   * both the instance data returned by the adapter _and_ metadata about the\r\n   * operation.\r\n   *\r\n   * The default is to NOT return the result object, and instead return just the\r\n   * instance data.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default false\r\n   */\r\n  raw: false,\r\n\r\n  /**\r\n   * Whether {@link Model.create} and {@link Model.createMany} should instead\r\n   * call {@link Model.update} and {@link Model.updateMany} if the provided\r\n   * props/entities already contain a primary key.\r\n   *\r\n   * @memberof Model\r\n   * @type {boolean}\r\n   * @default true\r\n   */\r\n  upsert: true,\r\n\r\n  /**\r\n   * @memberOf Model\r\n   * @method\r\n   * @private\r\n   */\r\n  _events (value) {\r\n    if (value) {\r\n      this._listeners = value\r\n    } else if (this._listenersOwner !== this) {\r\n      this._listeners = {}\r\n      this._listenersOwner = this\r\n    }\r\n    return this._listeners\r\n  },\r\n\r\n  end (data, opts) {\r\n    const self = this\r\n    if (opts.raw) {\r\n      utils._(opts, data)\r\n    }\r\n    if (!opts.pojo) {\r\n      let _data = opts.raw ? data.data : data\r\n      if (utils.isArray(_data)) {\r\n        _data = _data.map(function (item) {\r\n          return self.createInstance(item)\r\n        })\r\n      } else {\r\n        _data = self.createInstance(_data)\r\n      }\r\n      if (opts.raw) {\r\n        data.data = _data\r\n      } else {\r\n        data = _data\r\n      }\r\n    }\r\n    if (opts.notify) {\r\n      setTimeout(function () {\r\n        self.emit(opts.op, data, opts)\r\n      })\r\n    }\r\n    return data\r\n  },\r\n\r\n  /**\r\n   * Return new instance of this Model from the given properties. Equivalent to\r\n   * `new Model([props][, opts])`. Returns `props` if `props` is already an\r\n   * instance of this Model.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} props - The initial properties of the new instance.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.noValidate=false] Whether to skip validation on the\r\n   * initial properties.\r\n   * @return {Model} The instance.\r\n   */\r\n  createInstance (props, opts) {\r\n    let Ctor = this\r\n    // Check to make sure \"props\" is not already an instance of this Model.\r\n    return props instanceof Ctor ? props : new Ctor(props, opts)\r\n  },\r\n\r\n  /**\r\n   * Return whether `instance` is an instance of this Model's instance class.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} instance - The instance to check.\r\n   * @return {boolean} Whether `instance` is an instance of this Model's\r\n   * instance class.\r\n   */\r\n  is (instance, modelOnly) {\r\n    const self = this\r\n    return self.instanceClass && !modelOnly ? instance instanceof self.instanceClass : instance instanceof self\r\n  },\r\n\r\n  /**\r\n   * Return a plain object representation of the given entity.\r\n   *\r\n   * @memberOf Model\r\n   * @method\r\n   * @param {Object} - Entity of which to return the plain\r\n   * representation.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {string[]} [opts.with] - Array of relation names or relation fields\r\n   * to include in the representation.\r\n   * @return {Object} Plain object representation of instance.\r\n   */\r\n  toJSON (data, opts) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    let json = data\r\n    if (self.is(data)) {\r\n      json = {}\r\n      for (var key in data) {\r\n        json[key] = data[key]\r\n      }\r\n      // The user wants to include relations in the resulting plain object\r\n      // representation\r\n      if (self && self.relationList && opts.with) {\r\n        if (utils.isString(opts.with)) {\r\n          opts.with = [opts.with]\r\n        }\r\n        self.relationList.forEach(def => {\r\n          let containedName\r\n          if (opts.with.indexOf(def.relation) !== -1) {\r\n            containedName = def.relation\r\n          } else if (opts.with.indexOf(def.localField) !== -1) {\r\n            containedName = def.localField\r\n          }\r\n          if (containedName) {\r\n            const optsCopy = { with: opts.with.slice() }\r\n\r\n            // Prepare to recurse into deeply nested relations\r\n            optsCopy.with.splice(optsCopy.with.indexOf(containedName), 1)\r\n            optsCopy.with.forEach((relation, i) => {\r\n              if (relation && relation.indexOf(containedName) === 0 && relation.length >= containedName.length && relation[containedName.length] === '.') {\r\n                optsCopy.with[i] = relation.substr(containedName.length + 1)\r\n              } else {\r\n                optsCopy.with[i] = ''\r\n              }\r\n            })\r\n            const relationData = utils.get(data, def.localField)\r\n\r\n            if (relationData) {\r\n              // The actual recursion\r\n              if (utils.isArray(relationData)) {\r\n                utils.set(json, def.localField, relationData.map(item => def.Relation.toJSON(item, optsCopy)))\r\n              } else {\r\n                utils.set(json, def.localField, def.Relation.toJSON(relationData, optsCopy))\r\n              }\r\n            }\r\n          }\r\n        })\r\n      }\r\n    }\r\n    return json\r\n  },\r\n\r\n  /**\r\n   * Return the registered adapter with the given name or the default adapter if\r\n   * no name is provided.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {string} [name]- The name of the adapter to retrieve.\r\n   * @return {Adapter} The adapter, if any.\r\n   */\r\n  getAdapter (name) {\r\n    this.dbg('getAdapter', 'name:', name)\r\n    const adapter = this.getAdapterName(name)\r\n    if (!adapter) {\r\n      throw new ReferenceError(`${adapter} not found!`)\r\n    }\r\n    return this.getAdapters()[adapter]\r\n  },\r\n\r\n  /**\r\n   * Return the name of a registered adapter based on the given name or options,\r\n   * or the name of the default adapter if no name provided.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(Object|string)} [opts] - The name of an adapter or options, if any.\r\n   * @return {string} The name of the adapter.\r\n   */\r\n  getAdapterName (opts) {\r\n    opts || (opts = {})\r\n    if (utils.isString(opts)) {\r\n      opts = { adapter: opts }\r\n    }\r\n    return opts.adapter || opts.defaultAdapter\r\n  },\r\n\r\n  getAdapters () {\r\n    if (this._adaptersOwner !== this) {\r\n      const prevAdapters = this._adapters\r\n      this._adapters = {}\r\n      if (prevAdapters) {\r\n        utils.fillIn(this._adapters, prevAdapters)\r\n      }\r\n      this._adaptersOwner = this\r\n    }\r\n    return this._adapters\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.create}. If this method\r\n   * returns a promise then {@link Model.create} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} props - The `props` argument passed to {@link Model.create}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.create}.\r\n   */\r\n  beforeCreate: notify,\r\n\r\n  checkUpsertCreate (props, opts) {\r\n    const self = this\r\n    return (opts.upsert || (opts.upsert === undefined && self.upsert)) &&\r\n          utils.get(props, self.idAttribute)\r\n  },\r\n\r\n  /**\r\n   * Using an adapter, create a new the entity from the provided `props`.\r\n   *\r\n   * {@link Model.beforeCreate} will be called before calling the adapter.\r\n   * {@link Model.afterCreate} will be called after calling the adapter.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} props - The properties from which to create the entity.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * created data. If `true` return a response object that includes the created\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to create in a cascading\r\n   * create if `props` contains nested relations. NOT performed in a transaction.\r\n   */\r\n  create (props, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    // Check whether we should do an upsert instead\r\n    if (self.checkUpsertCreate(props, opts)) {\r\n      return self.update(utils.get(props, self.idAttribute), props, opts)\r\n    }\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeCreate lifecycle hook\r\n    op = opts.op = 'beforeCreate'\r\n    return resolve(self[op](props, opts)).then(function (_props) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      props = _props || props\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'create'\r\n      const json = self.toJSON(props, opts)\r\n      self.dbg(op, json, opts)\r\n      return self.getAdapter(adapter)[op](self, json, opts)\r\n    }).then(function (data) {\r\n      // afterCreate lifecycle hook\r\n      op = opts.op = 'afterCreate'\r\n      return resolve(self[op](data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.create}. If this method\r\n   * returns a promise then {@link Model.create} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} data - The `data` return by the adapter.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.create}.\r\n   */\r\n  afterCreate: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.createMany}. If this method\r\n   * returns a promise then {@link Model.createMany} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - The `entities` argument passed to {@link Model.createMany}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.createMany}.\r\n   */\r\n  beforeCreateMany: notify,\r\n\r\n  checkUpsertCreateMany (entities, opts) {\r\n    const self = this\r\n    if (opts.upsert || (opts.upsert === undefined && self.upsert)) {\r\n      return entities.reduce(function (hasId, item) {\r\n        return hasId && utils.get(item, self.idAttribute)\r\n      }, true)\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Given an array of entities, batch create them via an adapter.\r\n   *\r\n   * {@link Model.beforeCreateMany} will be called before calling the adapter.\r\n   * {@link Model.afterCreateMany} will be called after calling the adapter.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - Array up entities to be created.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * updated data. If `true` return a response object that includes the updated\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to create in a cascading create\r\n   * if the entities to be created have linked/nested relations. NOT performed\r\n   * in a transaction.\r\n   */\r\n  createMany (entities, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    entities || (entities = [])\r\n    opts || (opts = {})\r\n\r\n    // Check whether we should do an upsert instead\r\n    if (self.checkUpsertCreateMany(entities, opts)) {\r\n      return self.updateMany(entities, opts)\r\n    }\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeCreateMany lifecycle hook\r\n    op = opts.op = 'beforeCreateMany'\r\n    return resolve(self[op](entities, opts))\r\n      .then(function (_entities) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        entities = _entities || entities\r\n        // Now delegate to the adapter\r\n        op = opts.op = 'createMany'\r\n        const json = entities.map(function (item) {\r\n          return self.toJSON(item, opts)\r\n        })\r\n        self.dbg(op, json, opts)\r\n        return self.getAdapter(adapter)[op](self, json, opts)\r\n      }).then(function (data) {\r\n        // afterCreateMany lifecycle hook\r\n        op = opts.op = 'afterCreateMany'\r\n        return resolve(self[op](data, opts)).then(function (_data) {\r\n          // Allow for re-assignment from lifecycle hook\r\n          data = _data || data\r\n          // Possibly inject result and/or formulate result object\r\n          return self.end(data, opts)\r\n        })\r\n      })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.createMany}. If this method\r\n   * returns a promise then {@link Model.createMany} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - The `entities` argument passed to {@link Model.createMany}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.createMany}.\r\n   */\r\n  afterCreateMany: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.find}. If this method\r\n   * returns a promise then {@link Model.find} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.find}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.find}.\r\n   */\r\n  beforeFind: notify,\r\n\r\n  /**\r\n   * Retrieve via an adapter the entity with the given primary key.\r\n   *\r\n   * {@link Model.beforeFind} will be called before calling the adapter.\r\n   * {@link Model.afterFind} will be called after calling the adapter.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The primary key of the entity to retrieve.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * updated data. If `true` return a response object that includes the updated\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to eager load in the request.\r\n   */\r\n  find (id, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeFind lifecycle hook\r\n    op = opts.op = 'beforeFind'\r\n    return resolve(self[op](id, opts)).then(function (_id) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      id = _id === undefined ? id : _id\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'find'\r\n      self.dbg(op, id, opts)\r\n      return self.getAdapter(adapter)[op](self, id, opts)\r\n    }).then(function (data) {\r\n      // afterFind lifecycle hook\r\n      op = opts.op = 'afterFind'\r\n      return resolve(self[op](data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly inject result and/or formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.find}. If this method\r\n   * returns a promise then {@link Model.find} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.find}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.find}.\r\n   */\r\n  afterFind: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.findAll}. If this method\r\n   * returns a promise then {@link Model.findAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} query - The `query` argument passed to {@link Model.findAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.findAll}.\r\n   */\r\n  beforeFindAll: notify,\r\n\r\n  /**\r\n   * Using the `query` argument, select entities to pull from an adapter.\r\n   * Expects back from the adapter the array of selected entities.\r\n   *\r\n   * {@link Model.beforeFindAll} will be called before calling the adapter.\r\n   * {@link Model.afterFindAll} will be called after calling the adapter.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} [query={}] - Selection query.\r\n   * @param {Object} [query.where] - Filtering criteria.\r\n   * @param {number} [query.skip] - Number to skip.\r\n   * @param {number} [query.limit] - Number to limit to.\r\n   * @param {Array} [query.orderBy] - Sorting criteria.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * resulting data. If `true` return a response object that includes the\r\n   * resulting data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to eager load in the request.\r\n   */\r\n  findAll (query, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    query || (query = {})\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeFindAll lifecycle hook\r\n    op = opts.op = 'beforeFindAll'\r\n    return resolve(self[op](query, opts)).then(function (_query) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      query = _query || query\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'findAll'\r\n      self.dbg(op, query, opts)\r\n      return self.getAdapter(adapter)[op](self, query, opts)\r\n    }).then(function (data) {\r\n      // afterFindAll lifecycle hook\r\n      op = opts.op = 'afterFindAll'\r\n      return resolve(self[op](data, query, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly inject result and/or formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.findAll}. If this method\r\n   * returns a promise then {@link Model.findAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} data - The `data` returned by the adapter.\r\n   * @param {Object} query - The `query` argument passed to {@link Model.findAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.findAll}.\r\n   */\r\n  afterFindAll: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.update}. If this method\r\n   * returns a promise then {@link Model.update} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.update}.\r\n   * @param {props} props - The `props` argument passed to {@link Model.update}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.update}.\r\n   */\r\n  beforeUpdate: notify,\r\n\r\n  /**\r\n   * Using an adapter, update the entity with the primary key specified by the\r\n   * `id` argument.\r\n   *\r\n   * {@link Model.beforeUpdate} will be called before updating the entity.\r\n   * {@link Model.afterUpdate} will be called after updating the entity.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The primary key of the entity to update.\r\n   * @param {Object} props - The update to apply to the entity.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * updated data. If `true` return a response object that includes the updated\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to update in a cascading\r\n   * update if `props` contains nested updates to relations. NOT performed in a\r\n   * transaction.\r\n   */\r\n  update (id, props, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeUpdate lifecycle hook\r\n    op = opts.op = 'beforeUpdate'\r\n    return resolve(self[op](id, props, opts)).then(function (_props) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      props = _props || props\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'update'\r\n      const json = self.toJSON(props, opts)\r\n      self.dbg(op, id, json, opts)\r\n      return self.getAdapter(adapter)[op](self, id, json, opts)\r\n    }).then(function (data) {\r\n      // afterUpdate lifecycle hook\r\n      op = opts.op = 'afterUpdate'\r\n      return resolve(self[op](id, data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly inject result and/or formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.update}. If this method\r\n   * returns a promise then {@link Model.update} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.update}.\r\n   * @param {props} props - The `props` argument passed to {@link Model.update}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.update}.\r\n   */\r\n  afterUpdate: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.updateMany}. If this method\r\n   * returns a promise then {@link Model.updateMany} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - The `entities` argument passed to {@link Model.updateMany}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.updateMany}.\r\n   */\r\n  beforeUpdateMany: notify,\r\n\r\n  /**\r\n   * Given an array of updates, perform each of the updates via an adapter. Each\r\n   * \"update\" is a hash of properties with which to update an entity. Each\r\n   * update must contain the primary key to be updated.\r\n   *\r\n   * {@link Model.beforeUpdateMany} will be called before making the update.\r\n   * {@link Model.afterUpdateMany} will be called after making the update.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - Array up entity updates.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * updated data. If `true` return a response object that includes the updated\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to update in a cascading\r\n   * update if each entity update contains nested updates for relations. NOT\r\n   * performed in a transaction.\r\n   */\r\n  updateMany (entities, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    entities || (entities = [])\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeUpdateMany lifecycle hook\r\n    op = opts.op = 'beforeUpdateMany'\r\n    return resolve(self[op](entities, opts)).then(function (_entities) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      entities = _entities || entities\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'updateMany'\r\n      const json = entities.map(function (item) {\r\n        return self.toJSON(item, opts)\r\n      })\r\n      self.dbg(op, json, opts)\r\n      return self.getAdapter(adapter)[op](self, json, opts)\r\n    }).then(function (data) {\r\n      // afterUpdateMany lifecycle hook\r\n      op = opts.op = 'afterUpdateMany'\r\n      return resolve(self[op](data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly inject result and/or formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.updateMany}. If this method\r\n   * returns a promise then {@link Model.updateMany} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Array} entities - The `entities` argument passed to {@link Model.updateMany}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.updateMany}.\r\n   */\r\n  afterUpdateMany: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.updateAll}. If this method\r\n   * returns a promise then {@link Model.updateAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} query - The `query` argument passed to {@link Model.updateAll}.\r\n   * @param {Object} props - The `props` argument passed to {@link Model.updateAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.updateAll}.\r\n   */\r\n  beforeUpdateAll: notify,\r\n\r\n  /**\r\n   * Using the `query` argument, perform the a single updated to the selected\r\n   * entities. Expects back from the adapter an array of the updated entities.\r\n   *\r\n   * {@link Model.beforeUpdateAll} will be called before making the update.\r\n   * {@link Model.afterUpdateAll} will be called after making the update.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} [query={}] - Selection query.\r\n   * @param {Object} [query.where] - Filtering criteria.\r\n   * @param {number} [query.skip] - Number to skip.\r\n   * @param {number} [query.limit] - Number to limit to.\r\n   * @param {Array} [query.orderBy] - Sorting criteria.\r\n   * @param {Object} props - Update to apply to selected entities.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * updated data. If `true` return a response object that includes the updated\r\n   * data and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to update in a cascading\r\n   * update if `props` contains nested updates to relations. NOT performed in a\r\n   * transaction.\r\n   */\r\n  updateAll (query, props, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    query || (query = {})\r\n    props || (props = {})\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeUpdateAll lifecycle hook\r\n    op = opts.op = 'beforeUpdateAll'\r\n    return resolve(self[op](query, props, opts)).then(function (_props) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      props = _props || props\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'updateAll'\r\n      const json = self.toJSON(props, opts)\r\n      self.dbg(op, query, json, opts)\r\n      return self.getAdapter(adapter)[op](self, query, json, opts)\r\n    }).then(function (data) {\r\n      // afterUpdateAll lifecycle hook\r\n      op = opts.op = 'afterUpdateAll'\r\n      return resolve(self[op](query, data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        // Possibly inject result and/or formulate result object\r\n        return self.end(data, opts)\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.updateAll}. If this method\r\n   * returns a promise then {@link Model.updateAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} query - The `query` argument passed to {@link Model.updateAll}.\r\n   * @param {Object} props - The `props` argument passed to {@link Model.updateAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.updateAll}.\r\n   */\r\n  afterUpdateAll: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.destroy}. If this method\r\n   * returns a promise then {@link Model.destroy} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.destroy}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.destroy}.\r\n   */\r\n  beforeDestroy: notify,\r\n\r\n  /**\r\n   * Using an adapter, destroy the entity with the primary key specified by the\r\n   * `id` argument.\r\n   *\r\n   * {@link Model.beforeDestroy} will be called before destroying the entity.\r\n   * {@link Model.afterDestroy} will be called after destroying the entity.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The primary key of the entity to destroy.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * ejected data (if any). If `true` return a response object that includes the\r\n   * ejected data (if any) and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to destroy in a cascading\r\n   * delete. NOT performed in a transaction.\r\n   */\r\n  destroy (id, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeDestroy lifecycle hook\r\n    op = opts.op = 'beforeDestroy'\r\n    return resolve(self[op](id, opts)).then(function (_id) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      id = _id === undefined ? id : _id\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'destroy'\r\n      self.dbg(op, id, opts)\r\n      return self.getAdapter(adapter)[op](self, id, opts)\r\n    }).then(function (data) {\r\n      // afterDestroy lifecycle hook\r\n      op = opts.op = 'afterDestroy'\r\n      return resolve(self[op](data, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        if (opts.raw) {\r\n          utils._(opts, data)\r\n          return data\r\n        }\r\n        return data\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.destroy}. If this method\r\n   * returns a promise then {@link Model.destroy} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {(string|number)} id - The `id` argument passed to {@link Model.destroy}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.destroy}.\r\n   */\r\n  afterDestroy: notify,\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.destroyAll}. If this method\r\n   * returns a promise then {@link Model.destroyAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {query} query - The `query` argument passed to {@link Model.destroyAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.destroyAll}.\r\n   */\r\n  beforeDestroyAll: notify,\r\n\r\n  /**\r\n   * Using the `query` argument, destroy the selected entities via an adapter.\r\n   * If no `query` is provided then all entities will be destroyed.\r\n   *\r\n   * {@link Model.beforeDestroyAll} will be called before destroying the entities.\r\n   * {@link Model.afterDestroyAll} will be called after destroying the entities.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {Object} [query={}] - Selection query.\r\n   * @param {Object} [query.where] - Filtering criteria.\r\n   * @param {number} [query.skip] - Number to skip.\r\n   * @param {number} [query.limit] - Number to limit to.\r\n   * @param {Array} [query.orderBy] - Sorting criteria.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.adapter={@link Model.defaultAdapter}] Name of the\r\n   * adapter to use.\r\n   * @param {boolean} [opts.notify={@link Model.notify}] Whether to emit\r\n   * lifecycle events.\r\n   * @param {boolean} [opts.raw={@link Model.raw}] If `false`, return the\r\n   * ejected data (if any). If `true` return a response object that includes the\r\n   * ejected data (if any) and metadata about the operation.\r\n   * @param {string[]} [opts.with=[]] Relations to destroy in a cascading\r\n   * delete. NOT performed in a transaction.\r\n   */\r\n  destroyAll (query, opts) {\r\n    let op, adapter\r\n    const self = this\r\n\r\n    // Default values for arguments\r\n    query || (query = {})\r\n    opts || (opts = {})\r\n\r\n    // Fill in \"opts\" with the Model's configuration\r\n    utils._(self, opts)\r\n    adapter = opts.adapter = self.getAdapterName(opts)\r\n\r\n    // beforeDestroyAll lifecycle hook\r\n    op = opts.op = 'beforeDestroyAll'\r\n    return resolve(self[op](query, opts)).then(function (_query) {\r\n      // Allow for re-assignment from lifecycle hook\r\n      query = _query || query\r\n      // Now delegate to the adapter\r\n      op = opts.op = 'destroyAll'\r\n      self.dbg(op, query, opts)\r\n      return self.getAdapter(adapter)[op](self, query, opts)\r\n    }).then(function (data) {\r\n      // afterDestroyAll lifecycle hook\r\n      op = opts.op = 'afterDestroyAll'\r\n      return resolve(self[op](data, query, opts)).then(function (_data) {\r\n        // Allow for re-assignment from lifecycle hook\r\n        data = _data || data\r\n        if (opts.raw) {\r\n          utils._(opts, data)\r\n          return data\r\n        }\r\n        return data\r\n      })\r\n    })\r\n  },\r\n\r\n  /**\r\n   * Model lifecycle hook called by {@link Model.destroyAll}. If this method\r\n   * returns a promise then {@link Model.destroyAll} will wait for the promise\r\n   * to resolve before continuing.\r\n   *\r\n   * @memberof Model\r\n   * @method\r\n   * @param {*} data - The `data` returned by the adapter.\r\n   * @param {query} query - The `query` argument passed to {@link Model.destroyAll}.\r\n   * @param {Object} opts - The `opts` argument passed to {@link Model.destroyAll}.\r\n   */\r\n  afterDestroyAll: notify,\r\n\r\n  log (level, ...args) {\r\n    if (level && !args.length) {\r\n      args.push(level)\r\n      level = 'debug'\r\n    }\r\n    if (level === 'debug' && !this.debug) {\r\n      return\r\n    }\r\n    const prefix = `${level.toUpperCase()}: (${this.name})`\r\n    if (console[level]) {\r\n      console[level](prefix, ...args)\r\n    } else {\r\n      console.log(prefix, ...args)\r\n    }\r\n  },\r\n\r\n  dbg (...args) {\r\n    this.log('debug', ...args)\r\n  },\r\n\r\n  /**\r\n   * Usage:\r\n   *\r\n   * Post.belongsTo(User, {\r\n   *   localKey: 'myUserId'\r\n   * })\r\n   *\r\n   * Comment.belongsTo(User)\r\n   * Comment.belongsTo(Post, {\r\n   *   localField: '_post'\r\n   * })\r\n   */\r\n  belongsTo (model, opts) {\r\n    return belongsTo(model, opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Usage:\r\n   *\r\n   * User.hasMany(Post, {\r\n   *   localField: 'my_posts'\r\n   * })\r\n   */\r\n  hasMany (model, opts) {\r\n    return hasMany(model, opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Usage:\r\n   *\r\n   * User.hasOne(Profile, {\r\n   *   localField: '_profile'\r\n   * })\r\n   */\r\n  hasOne (model, opts) {\r\n    return hasOne(model, opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Invoke the {@link module:js-data.exports.setSchema setSchema} decorator on\r\n   * this Model.\r\n   * @param {Object} opts - Property configurations.\r\n   * @return {Model} A reference to the Model for chaining.\r\n   */\r\n  setSchema (opts) {\r\n    return setSchema(opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Invoke the {@link module:js-data.exports.configure configure} decorator on\r\n   * this Model.\r\n   * @param {Object} opts - Configuration\r\n   * @return {Model} A reference to the Model for chaining.\r\n   */\r\n  configure (opts) {\r\n    return configure(opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Invoke the {@link module:js-data.exports.registerAdapter registerAdapter}\r\n   * decorator on this Model.\r\n   * @param {string} name - The name of the adapter to register.\r\n   * @param {Adapter} adapter - The adapter to register.\r\n   * @param {Object} [opts] - Configuration options.\r\n   * @param {boolean} [opts.default=false] - Whether to make the adapter the\r\n   * default for this Model.\r\n   * @return {Model} A reference to the Model for chaining.\r\n   */\r\n  registerAdapter (name, adapter, opts) {\r\n    return registerAdapter(name, adapter, opts)(this)\r\n  },\r\n\r\n  /**\r\n   * Extend this Model and return a new child Model. Static properties on this\r\n   * Model will be shallow copied to the child Model. The child Model's\r\n   * prototype will point to the parent Model.\r\n   *\r\n   * @example\r\n   * var User = JSData.Model.extend({}, { name: 'User' })\r\n   * @param {Object} props={} - Properties to add to the prototype of the class.\r\n   * @param {Function} [props.initialize] - Optional function to invoke during\r\n   * construction of instances of the class. Will receive any arguments passed\r\n   * to the constructor. \"this\" will refer to the instance being constructed.\r\n   * @param {Object} classProps - Static properties to add to the class.\r\n   * @param {string} classProps.name - Name of the class. Required.\r\n   * @param {string} [classProps.idAttribute='id'] - Field to use as the unique\r\n   * identifier for instances of the class.\r\n   * @param {Object} [classProps.schema] - Value to pass to the {@link Model.setSchema setSchema}\r\n   * method of the class after the class is created.\r\n   */\r\n  extend (props, classProps) {\r\n    const Parent = this\r\n    let Child\r\n\r\n    Parent.dbg('extend', 'props:', props, 'classProps:', classProps)\r\n\r\n    props || (props = {})\r\n    classProps || (classProps = {})\r\n\r\n    const initialize = props.initialize\r\n    delete props.initialize\r\n\r\n    if (props.hasOwnProperty('constructor')) {\r\n      Child = props.constructor\r\n      delete props.constructor\r\n    } else {\r\n      if (!classProps.name) {\r\n        throw new TypeError(`name: Expected string, found ${typeof classProps.name}!`)\r\n      }\r\n      if (classProps.csp) {\r\n        Child = function (...args) {\r\n          utils.classCallCheck(this, Child)\r\n          const _this = utils.possibleConstructorReturn(this, (Child.__super__ || Object.getPrototypeOf(Child)).apply(this, args))\r\n          if (initialize) {\r\n            initialize.apply(_this, args)\r\n          }\r\n          return _this\r\n        }\r\n      } else {\r\n        const name = utils.pascalCase(classProps.name)\r\n        const func = `return function ${name}() {\r\n                        classCallCheck(this, ${name})\r\n                        for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\r\n                          args[_key] = arguments[_key];\r\n                        }\r\n                        var _this = possibleConstructorReturn(this, (${name}.__super__ || Object.getPrototypeOf(${name})).apply(this, args));\r\n                        if (initialize) {\r\n                          initialize.apply(_this, arguments)\r\n                        }\r\n                        return _this\r\n                      }`\r\n        Child = new Function('classCallCheck', 'possibleConstructorReturn', 'Parent', 'initialize', func)(utils.classCallCheck, utils.possibleConstructorReturn, Parent, initialize) // eslint-disable-line\r\n      }\r\n    }\r\n\r\n    classProps.shortname = classProps.shortname || utils.camelCase(Child.name || classProps.name)\r\n    delete classProps.name\r\n\r\n    const _schema = classProps.schema\r\n    delete classProps.schema\r\n\r\n    Child.prototype = Object.create(Parent && Parent.prototype, {\r\n      constructor: {\r\n        value: Child,\r\n        enumerable: false,\r\n        writable: true,\r\n        configurable: true\r\n      }\r\n    })\r\n\r\n    if (Object.setPrototypeOf) {\r\n      Object.setPrototypeOf(Child, Parent)\r\n    } else if (classProps.strictEs6Class) {\r\n      Child.__proto__ = Parent // eslint-disable-line\r\n    } else {\r\n      utils.forOwn(Parent, function (value, key) {\r\n        Child[key] = value\r\n      })\r\n    }\r\n    Object.defineProperty(Child, '__super__', {\r\n      configurable: true,\r\n      value: Parent\r\n    })\r\n\r\n    configure(props)(Child.prototype)\r\n    configure(classProps)(Child)\r\n    if (_schema) {\r\n      setSchema(_schema)(Child)\r\n    }\r\n\r\n    return Child\r\n  }\r\n})\r\n\r\n/**\r\n * Register a new event listener on this Model.\r\n *\r\n * @name on\r\n * @memberOf! Model\r\n * @method\r\n */\r\n\r\n/**\r\n * Remove an event listener from this Model.\r\n *\r\n * @name off\r\n * @memberOf! Model\r\n * @method\r\n */\r\n\r\n/**\r\n * Trigger an event on this Model.\r\n *\r\n * @name emit\r\n * @memberOf! Model\r\n * @method\r\n */\r\n\r\n/**\r\n * Allow Models themselves emit events.\r\n *\r\n * A Model's registered listeners are stored on the Model's `__events` property.\r\n */\r\nutils.eventify(\r\n  Model,\r\n  function () {\r\n    return this._events()\r\n  },\r\n  function (value) {\r\n    this._events(value)\r\n  },\r\n  true\r\n)\r\n\r\n/**\r\n * Allow instancess to emit events.\r\n *\r\n * An instance's registered listeners are stored in the instance's private data\r\n * hash.\r\n */\r\nutils.eventify(\r\n  Model.prototype,\r\n  function () {\r\n    return this._get('events')\r\n  },\r\n  function (value) {\r\n    this._set('events', value)\r\n  }\r\n)\r\n","import {\r\n  addHiddenPropsToTarget,\r\n  classCallCheck,\r\n  fillIn,\r\n  forOwn,\r\n  isObject,\r\n  isString\r\n} from '../utils'\r\nimport {Collection} from '../collection/index'\r\nimport {Model} from '../model/index'\r\n\r\nexport function DS (opts) {\r\n  const self = this\r\n  classCallCheck(self, DS)\r\n\r\n  opts || (opts = {})\r\n  self.defaults = {}\r\n\r\n  for (var key in opts) {\r\n    self.defaults[key] = opts[key]\r\n  }\r\n  self.models = {}\r\n  self.collections = {}\r\n}\r\n\r\naddHiddenPropsToTarget(DS.prototype, {\r\n  defineModel (name, opts) {\r\n    const self = this\r\n\r\n    if (isObject(name)) {\r\n      opts = name\r\n      name = opts.name\r\n    }\r\n    opts || (opts = {})\r\n    opts.relations || (opts.relations = {})\r\n    fillIn(opts, self.defaults)\r\n\r\n    const methods = opts.methods || {}\r\n    delete opts.methods\r\n    const Parent = self.models[opts.extends]\r\n\r\n    const Child = (Parent || Model).extend(methods, opts)\r\n    self.models[name] = Child\r\n\r\n    Child.getModel = function (name) {\r\n      return self.models[name]\r\n    }\r\n\r\n    forOwn(opts.relations, function (group, type) {\r\n      forOwn(group, function (relations, name) {\r\n        if (isObject(relations)) {\r\n          relations = [relations]\r\n        }\r\n        relations.forEach(function (def) {\r\n          const Relation = self.models[name] || name\r\n          if (type === 'belongsTo') {\r\n            return Child.belongsTo(Relation, def)\r\n          }\r\n          if (type === 'hasOne') {\r\n            return Child.hasOne(Relation, def)\r\n          }\r\n          return Child.hasMany(Relation, def)\r\n        })\r\n      })\r\n    })\r\n\r\n    return Child\r\n  },\r\n\r\n  defineCollection (name, opts, Ctor) {\r\n    const self = this\r\n    opts || (opts = {})\r\n    if (isString(opts.model)) {\r\n      opts.model = self.models[name]\r\n    }\r\n    const collection = new (Ctor || Collection)([], opts)\r\n    self.collection[name] = collection\r\n    return collection\r\n  },\r\n\r\n  model (name) {\r\n    return this.models[name]\r\n  },\r\n\r\n  collection (name) {\r\n    return this.collections[name]\r\n  },\r\n\r\n  registerAdapter (...args) {\r\n    forOwn(this.models, function (Model) {\r\n      Model.registerAdapter(...args)\r\n    })\r\n  }\r\n})\r\n\r\nDS.prototype.defineResource = DS.prototype.defineModel\r\n","/**\r\n * Registered as `js-data` in NPM and Bower.\r\n * #### Script tag\r\n * ```js\r\n * window.JSData\r\n * ```\r\n * #### CommonJS\r\n * ```js\r\n * var JSData = require('js-data')\r\n * ```\r\n * #### ES6 Modules\r\n * ```js\r\n * import JSData from 'js-data'\r\n * ```\r\n * #### AMD\r\n * ```js\r\n * define('myApp', ['js-data'], function (JSData) { ... })\r\n * ```\r\n *\r\n * @module js-data\r\n * @property {Function} belongsTo - {@link module:js-data.exports.belongsTo belongsTo}\r\n * decorator function.\r\n * @property {Function} configure - {@link module:js-data.exports.configure configure}\r\n * decorator function.\r\n * @property {Function} Collection - {@link Collection} class.\r\n * @property {Function} DS - {@link DS} class.\r\n * @property {Function} hasMany - {@link module:js-data.exports.hasMany hasMany}\r\n * decorator function.\r\n * @property {Function} hasOne - {@link module:js-data.exports.hasOne hasOne}\r\n * decorator function.\r\n * @property {Function} initialize - {@link module:js-data.exports.initialize initialize}\r\n * decorator function.\r\n * @property {Function} Model - {@link Model} class.\r\n * @property {Function} registerAdapter - {@link registerAdapter} decorator\r\n * function.\r\n * @property {Function} setSchema - {@link setSchema} decorator function.\r\n * @property {Function} Query - {@link Query} class.\r\n * @property {Object} utils - Utility methods used by the `js-data` module. See\r\n * {@link module:js-data.module:utils utils}.\r\n * @property {Object} version - Details of the current version of the `js-data`\r\n * module.\r\n * @property {string} version.full - The full semver value.\r\n * @property {number} version.major - The major version number.\r\n * @property {number} version.minor - The minor version number.\r\n * @property {number} version.patch - The patch version number.\r\n * @property {(string|boolean)} version.alpha - The alpha version value,\r\n * otherwise `false` if the current version is not alpha.\r\n * @property {(string|boolean)} version.beta - The beta version value,\r\n * otherwise `false` if the current version is not beta.\r\n */\r\n\r\nexport * from './collection/index'\r\nexport * from './datastore/index'\r\n\r\nexport * from './decorators/index'\r\nexport * from './model/index'\r\nexport * from './validate/index'\r\nimport * as _utils from './utils'\r\nexport const utils = _utils\r\n\r\nexport const version = {\r\n  full: '<%= pkg.version %>',\r\n  major: parseInt('<%= major %>', 10),\r\n  minor: parseInt('<%= minor %>', 10),\r\n  patch: parseInt('<%= patch %>', 10),\r\n  alpha: '<%= alpha %>' !== 'false' ? '<%= alpha %>' : false,\r\n  beta: '<%= beta %>' !== 'false' ? '<%= beta %>' : false\r\n}\r\n"],"names":["set","resolve","op","utils.resolve","utils.classCallCheck","utils.get","utils.set","utils.unset","utils.fillIn","utils.copy","utils.addHiddenPropsToTarget","validate","utils.isString","_validate.validate","utils.forOwn","utils._","utils.isFunction","utils.isSorN","get","utils.isObject","unset","utils.isArray","belongsTo","_belongsTo","hasMany","_hasMany","hasOne","_hasOne","setSchema","_setSchema","configure","_configure","registerAdapter","_registerAdapter","utils.possibleConstructorReturn","utils.pascalCase","utils.camelCase","utils.eventify"],"mappings":"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"}